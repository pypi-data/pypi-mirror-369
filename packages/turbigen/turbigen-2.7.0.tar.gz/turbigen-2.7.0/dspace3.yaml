workdir: runs/*

inlet:
  Po: 16.0e5
  To: 1600.
  cp: 1100.
  gamma: 1.33

# Set viscosity by vane Reynolds number
Re_surf: 5e5

mean_line:
  type: axial_turbine
  # Duty
  mdot: 500.
  rrms: 1.0
  # Aerodynamics
  psi: 1.6
  phi2: 0.6
  Ma2: 0.7
  fac_Ma3_rel: 1.0
  zeta: [1.0, 1.0]
  # Guess of loss
  Ys: [0.05, 0.1]

annulus:
  type: smooth
  AR_gap: [2.0, 3.33, 2.0]
  AR_chord: [2.0, 2.0]
  smooth: false

mesh:
  type: h
  yplus: 40.0
  ni_TE: 3
  dm_TE: 0.0
  dspf_mid: 0.05
  AR_cusp: 1.2
  ni_cusp: 4
  ER_span: 1.3
  ER_stream: 1.3
  ER_pitch: 1.3
  dm_LE: 0.002


blades:
    - spf: [0.2, 0.5, 0.8]
      thick: [
        [0.04, 0.12, 0.35, 0.0, 0.02, 0.15],
        [0.04, 0.12, 0.35, 0.0, 0.02, 0.15],
        [0.04, 0.12, 0.35, 0.0, 0.02, 0.15],
      ]
      camber: [
        [0., 0., 0.0],
        [0., 0., 0.0],
        [0., 0., 0.0],
      ]
    - spf: [0.2, 0.5, 0.8]
      thick: [
        [0.04, 0.12, 0.35, 0.0, 0.02, 0.15],
        [0.04, 0.12, 0.35, 0.0, 0.02, 0.15],
        [0.04, 0.12, 0.35, 0.0, 0.02, 0.15],
      ]
      camber: [
        [0., 0., 0.0],
        [0., 0., 0.0],
        [0., 0., 0.0],
      ]
      tip: 0.01

nblade:
  - Co: 0.6
  - Co: 0.6


solver:
  type: ember
  n_step: 2500
  n_step_avg: 1500
  n_step_ramp: 1000
  xllim_pitch: 0.01
  K_mix: 0.1
  sf_mix: 0.5
  sf_Alpha: 1e-3

job:
  type: local

iterate:
  mean_line:
    tolerance:
      Ys: 0.0004
    relaxation_factor: 1.0
  deviation:
    tolerance: 0.5
  incidence:
    tolerance: 16.
    relaxation_factor: 0.05
    clip: 0.5
  repeat:
    dPo_max: 0.05
    dTo_max: 0.05
    dAlpha_max: 10.
    dBeta_max: 0.
    rtol: 0.005
    relaxation_factor: 0.5

post_process:
  - type: inlet_profiles
  - type: sections
  - type: contour
    coord: spf
    value: 0.5
    variable: Ma_rel
  - type: contour
    coord: m
    value: [0.01, 2.48, 2.52, 4.25]
    variable: Alpha
  - type: contour
    coord: m
    value: [0.01, 2.48, 2.52, 4.25]
    variable: Cho
  - type: contour
    coord: m
    value: [0.01, 2.48, 2.52, 4.25]
    variable: Ys

design_space:
  independent:
    mean_line:
      phi2: [0.4, 1.2]
      psi: [0.8, 2.4]
      # zeta[0]: [0.9, 1.0]
      # zeta[1]: [1.0, 1.1]
      # Ma2: [0.5, 0.9]
      # fac_Ma3_rel: [0.8, 1.2]
    tip:
      1: [0.005, 0.05]
  order_max: 3
  nsample_target: 16

fac_nstep_initial: 2.0

save_iteration_grids: false
