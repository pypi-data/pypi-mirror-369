# EasyA2A æŠ€æœ¯è¯´æ˜æ‰‹å†Œ

> **ç‰ˆæœ¬**: 2.0.0 | **æ›´æ–°æ—¶é—´**: 2025-01-14 | **APIç‰ˆæœ¬**: ä¸‰æ­¥å¼è®¾è®¡

## ğŸ“‹ ç›®å½•

1. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
2. [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
3. [ä¸‰æ­¥å¼APIè®¾è®¡](#ä¸‰æ­¥å¼apiè®¾è®¡)
4. [å®ç°ç»†èŠ‚](#å®ç°ç»†èŠ‚)
5. [é…ç½®ç³»ç»Ÿ](#é…ç½®ç³»ç»Ÿ)
6. [Agenté€‚é…å™¨](#agenté€‚é…å™¨)
7. [A2Aåè®®é›†æˆ](#a2aåè®®é›†æˆ)
8. [æ‰©å±•å¼€å‘](#æ‰©å±•å¼€å‘)
9. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
10. [ç›‘æ§ä¸è°ƒè¯•](#ç›‘æ§ä¸è°ƒè¯•)
11. [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
12. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„ (v2.0)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           EasyA2A 2.0 æ¶æ„å›¾                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¯ ç”¨æˆ·æ¥å£å±‚ (ä¸‰æ­¥å¼API)                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ A2AAgentWrapper.set_up(agent, "åç§°", "æè¿°")                           â”‚ â”‚
â”‚  â”‚   .add_skill("weather", "å¤©æ°”æŸ¥è¯¢", examples=["åŒ—äº¬å¤©æ°”"])                â”‚ â”‚
â”‚  â”‚   .set_provider("Weather AI", "https://weather.ai")                    â”‚ â”‚
â”‚  â”‚   .enable_streaming().enable_history()                                 â”‚ â”‚
â”‚  â”‚   .run_a2a(port=10010, host="0.0.0.0")                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”§ EasyA2A æ ¸å¿ƒå±‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ A2AAgentWrapper â”‚ â”‚  ConfigManager  â”‚ â”‚ ExecutorFactory â”‚ â”‚ AgentAdapterâ”‚ â”‚
â”‚  â”‚  (APIå…¥å£)       â”‚ â”‚  (é…ç½®æ„å»º)      â”‚ â”‚  (æ‰§è¡Œå™¨å·¥å‚)    â”‚ â”‚ (Agenté€‚é…) â”‚ â”‚
â”‚  â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚ â”‚             â”‚ â”‚
â”‚  â”‚ â€¢ é“¾å¼è°ƒç”¨      â”‚ â”‚ â€¢ å»¶è¿Ÿæ„å»º      â”‚ â”‚ â€¢ ç±»å‹æ£€æµ‹      â”‚ â”‚ â€¢ LangChain â”‚ â”‚
â”‚  â”‚ â€¢ çŠ¶æ€ç®¡ç†      â”‚ â”‚ â€¢ æ™ºèƒ½é»˜è®¤å€¼    â”‚ â”‚ â€¢ æ‰§è¡Œå™¨é€‰æ‹©    â”‚ â”‚ â€¢ OpenAI    â”‚ â”‚
â”‚  â”‚ â€¢ ç”Ÿå‘½å‘¨æœŸ      â”‚ â”‚ â€¢ é…ç½®éªŒè¯      â”‚ â”‚ â€¢ å¼‚æ­¥æ”¯æŒ      â”‚ â”‚ â€¢ Custom    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¡ A2A åè®®å±‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   AgentCard     â”‚ â”‚ RequestHandler  â”‚ â”‚   TaskStore     â”‚ â”‚ EventSystem â”‚ â”‚
â”‚  â”‚  (Agentå…ƒæ•°æ®)   â”‚ â”‚  (è¯·æ±‚è·¯ç”±)      â”‚ â”‚  (ä»»åŠ¡ç®¡ç†)      â”‚ â”‚ (äº‹ä»¶å¤„ç†)  â”‚ â”‚
â”‚  â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚ â”‚             â”‚ â”‚
â”‚  â”‚ â€¢ æŠ€èƒ½æè¿°      â”‚ â”‚ â€¢ HTTPè·¯ç”±      â”‚ â”‚ â€¢ å†…å­˜å­˜å‚¨      â”‚ â”‚ â€¢ ç”Ÿå‘½å‘¨æœŸ  â”‚ â”‚
â”‚  â”‚ â€¢ èƒ½åŠ›å£°æ˜      â”‚ â”‚ â€¢ å‚æ•°éªŒè¯      â”‚ â”‚ â€¢ çŠ¶æ€è·Ÿè¸ª      â”‚ â”‚ â€¢ é’©å­å‡½æ•°  â”‚ â”‚
â”‚  â”‚ â€¢ ç¤ºä¾‹å±•ç¤º      â”‚ â”‚ â€¢ é”™è¯¯å¤„ç†      â”‚ â”‚ â€¢ å¹¶å‘æ§åˆ¶      â”‚ â”‚ â€¢ æ’ä»¶ç³»ç»Ÿ  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŒ WebæœåŠ¡å±‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    A2AStarletteApplication                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   ASGI      â”‚ â”‚  Middleware â”‚ â”‚   Routing   â”‚ â”‚    Health Check     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   Server    â”‚ â”‚   Stack     â”‚ â”‚   System    â”‚ â”‚      System         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Uvicorn   â”‚ â”‚ â€¢ CORS      â”‚ â”‚ â€¢ /invoke   â”‚ â”‚ â€¢ /health           â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ å¼‚æ­¥å¤„ç†  â”‚ â”‚ â€¢ æ—¥å¿—è®°å½•  â”‚ â”‚ â€¢ /stream   â”‚ â”‚ â€¢ /.well-known/     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ è¿æ¥æ±     â”‚ â”‚ â€¢ é™æµæ§åˆ¶  â”‚ â”‚ â€¢ /status   â”‚ â”‚   agent-card.json   â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

1. **ğŸ¯ ç”¨æˆ·ä½“éªŒä¼˜å…ˆ** - ä¸‰æ­¥å¼APIè®¾è®¡ï¼Œé™ä½è®¤çŸ¥è´Ÿæ‹…
2. **ğŸ”§ ç»„ä»¶åŒ–æ¶æ„** - æ¾è€¦åˆè®¾è®¡ï¼Œæ”¯æŒç‹¬ç«‹æµ‹è¯•å’Œæ‰©å±•
3. **ğŸ“¡ åè®®æ ‡å‡†åŒ–** - å®Œå…¨ç¬¦åˆA2Aåè®®è§„èŒƒ
4. **âš¡ æ€§èƒ½ä¼˜åŒ–** - å¼‚æ­¥å¤„ç†ï¼Œè¿æ¥æ± ï¼Œå»¶è¿ŸåŠ è½½
5. **ğŸ›¡ï¸ å¥å£®æ€§** - å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
6. **ğŸ” å¯è§‚æµ‹æ€§** - å†…ç½®ç›‘æ§ã€æ—¥å¿—å’Œè°ƒè¯•æ”¯æŒ

### æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ç»„ä»¶ | ç‰ˆæœ¬è¦æ±‚ | ä½œç”¨ |
|------|----------|----------|------|
| **ç”¨æˆ·æ¥å£** | A2AAgentWrapper | 2.0+ | ä¸‰æ­¥å¼APIå…¥å£ |
| **æ ¸å¿ƒæ¡†æ¶** | Python | 3.8+ | è¿è¡Œæ—¶ç¯å¢ƒ |
| **Webæ¡†æ¶** | Starlette/FastAPI | 0.20+ | ASGI WebæœåŠ¡ |
| **æœåŠ¡å™¨** | Uvicorn | 0.20+ | ASGIæœåŠ¡å™¨ |
| **A2Aåè®®** | a2a-sdk | 0.3+ | A2Aåè®®å®ç° |
| **AIæ¡†æ¶** | LangChain | 0.1+ | Agentæ¡†æ¶æ”¯æŒ |
| **æ•°æ®éªŒè¯** | Pydantic | 2.0+ | æ•°æ®æ¨¡å‹éªŒè¯ |
| **å¼‚æ­¥å¤„ç†** | asyncio | å†…ç½® | å¼‚æ­¥ç¼–ç¨‹æ”¯æŒ |

### æ¶æ„ç‰¹æ€§

#### ğŸ¯ **ä¸‰æ­¥å¼APIè®¾è®¡**
- **ç¬¬ä¸€æ­¥**: `set_up()` - å¿…é¡»å‚æ•°åˆå§‹åŒ–
- **ç¬¬äºŒæ­¥**: é“¾å¼é…ç½® - å¯é€‰å‚æ•°é€æ­¥æ·»åŠ 
- **ç¬¬ä¸‰æ­¥**: `run_a2a()` - æœåŠ¡å¯åŠ¨å’Œè¿è¡Œ

#### ğŸ”§ **æ¨¡å—åŒ–ç»„ä»¶**
- **é…ç½®ç®¡ç†**: å»¶è¿Ÿæ„å»ºï¼Œæ™ºèƒ½é»˜è®¤å€¼
- **æ‰§è¡Œå™¨å·¥å‚**: è‡ªåŠ¨Agentç±»å‹æ£€æµ‹å’Œé€‚é…
- **åè®®é€‚é…**: æ— ç¼A2Aåè®®é›†æˆ
- **æœåŠ¡ç®¡ç†**: å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### 1. A2AAgentWrapper (æ ¸å¿ƒå…¥å£)

**æ–‡ä»¶ä½ç½®**: `easya2a/core/agent_wrapper.py`

**èŒè´£**: ä¸‰æ­¥å¼APIçš„æ ¸å¿ƒå®ç°ï¼Œç”¨æˆ·äº¤äº’çš„ä¸»è¦å…¥å£

```python
class A2AAgentWrapper:
    def __init__(self, agent: Any, name: str, description: str):
        """å†…éƒ¨åˆå§‹åŒ–ï¼Œå­˜å‚¨Agentå’ŒåŸºæœ¬ä¿¡æ¯"""
        self.agent = agent
        self.name = name
        self.description = description

        # å†…éƒ¨é…ç½®çŠ¶æ€
        self._skills: List[AgentSkillConfig] = []
        self._provider_organization = "EasyA2A Agent Services"
        self._provider_url = ""
        self._version = "1.0.0"

        # èƒ½åŠ›é…ç½®
        self._streaming = False
        self._push_notifications = True
        self._state_history = False
        self._multimodal = False

        # è¾“å…¥è¾“å‡ºæ¨¡å¼
        self._input_modes = ["text", "text/plain", "application/json"]
        self._output_modes = ["text", "text/plain", "application/json"]

    @classmethod
    def set_up(cls, agent: Any, name: str, description: str) -> "A2AAgentWrapper":
        """ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ– - å·¥å‚æ–¹æ³•"""
        return cls(agent, name, description)

    def add_skill(self, skill_id: str, name: str, **kwargs) -> "A2AAgentWrapper":
        """ç¬¬äºŒæ­¥ï¼šé“¾å¼é…ç½® - æ·»åŠ æŠ€èƒ½"""
        skill = AgentSkillConfig(
            id=skill_id,
            name=name,
            description=kwargs.get('description', f"{name}åŠŸèƒ½"),
            examples=kwargs.get('examples', []),
            tags=kwargs.get('tags', [])
        )
        self._skills.append(skill)
        return self  # å…³é”®ï¼šè¿”å›selfæ”¯æŒé“¾å¼è°ƒç”¨

    def run_a2a(self, port: int = 10010, host: str = "0.0.0.0") -> None:
        """ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨æœåŠ¡ - æ„å»ºé…ç½®å¹¶å¯åŠ¨A2AæœåŠ¡"""
        config = self._build_config(port, host)
        self._show_startup_info(config)
        self._create_executor(config)
        self._create_server_app(config)
        self._start_server(host, port)
```

**æ ¸å¿ƒç‰¹æ€§**:
- âœ… **çŠ¶æ€ç®¡ç†**: å†…éƒ¨ç»´æŠ¤æ‰€æœ‰é…ç½®çŠ¶æ€
- âœ… **é“¾å¼è°ƒç”¨**: æ‰€æœ‰é…ç½®æ–¹æ³•è¿”å›self
- âœ… **å»¶è¿Ÿæ„å»º**: é…ç½®åœ¨run_a2aæ—¶æ‰æœ€ç»ˆæ„å»º
- âœ… **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ç±»å‹æ³¨è§£æ”¯æŒ
- âœ… **é”™è¯¯å¤„ç†**: é…ç½®éªŒè¯å’Œé”™è¯¯æç¤º

### 2. é…ç½®ç³»ç»Ÿ (Configuration System)

**æ–‡ä»¶ä½ç½®**: `easya2a/config/agent_config.py`

#### AgentConfig (ä¸»é…ç½®ç±»)

```python
@dataclass
class AgentConfig:
    """Agentå®Œæ•´é…ç½® - æ‰€æœ‰é…ç½®çš„æœ€ç»ˆæ±‡æ€»"""

    # === åŸºæœ¬ä¿¡æ¯ ===
    name: str                                    # Agentåç§° (å¿…å¡«)
    description: str = ""                        # Agentæè¿°
    version: str = "1.0.0"                      # Agentç‰ˆæœ¬

    # === æœåŠ¡å™¨é…ç½® ===
    host: str = "0.0.0.0"                       # æœåŠ¡å™¨ç›‘å¬åœ°å€
    port: int = 10010                           # æœåŠ¡å™¨ç«¯å£
    agent_url: Optional[str] = None              # Agent Cardä¸­çš„URL

    # === æä¾›å•†ä¿¡æ¯ ===
    provider_organization: str = "EasyA2A Agent Services"  # æä¾›å•†ç»„ç»‡
    provider_url: Optional[str] = None           # æä¾›å•†ç½‘ç«™

    # === æŠ€èƒ½å’Œèƒ½åŠ› ===
    skills: List[AgentSkillConfig] = field(default_factory=list)
    capabilities: Optional[AgentCapabilityConfig] = None

    # === è¾“å…¥è¾“å‡ºæ¨¡å¼ ===
    default_input_modes: List[str] = field(
        default_factory=lambda: ["text", "text/plain", "application/json"]
    )
    default_output_modes: List[str] = field(
        default_factory=lambda: ["text", "text/plain", "application/json"]
    )

    # === LangChainç‰¹å®šé…ç½® ===
    langchain_config: Dict[str, Any] = field(default_factory=dict)

    def __post_init__(self):
        """åˆå§‹åŒ–åå¤„ç† - è®¾ç½®æ™ºèƒ½é»˜è®¤å€¼"""
        if self.agent_url is None:
            self.agent_url = f"http://{self.host}:{self.port}/"

        if self.provider_url is None:
            self.provider_url = self.agent_url

        if self.capabilities is None:
            self.capabilities = AgentCapabilityConfig()
```

#### AgentSkillConfig (æŠ€èƒ½é…ç½®)

```python
@dataclass
class AgentSkillConfig:
    """AgentæŠ€èƒ½é…ç½® - å®šä¹‰Agentçš„å…·ä½“èƒ½åŠ›"""

    id: str                           # æŠ€èƒ½å”¯ä¸€æ ‡è¯† (å¿…å¡«)
    name: str                         # æŠ€èƒ½åç§° (å¿…å¡«)
    description: str                  # æŠ€èƒ½æè¿° (å¿…å¡«)
    tags: List[str] = field(default_factory=list)      # æŠ€èƒ½æ ‡ç­¾
    examples: List[str] = field(default_factory=list)  # ä½¿ç”¨ç¤ºä¾‹

    def to_dict(self) -> Dict[str, Any]:
        """è½¬æ¢ä¸ºå­—å…¸æ ¼å¼ï¼Œç”¨äºAgent Cardç”Ÿæˆ"""
        return {
            "id": self.id,
            "name": self.name,
            "description": self.description,
            "tags": self.tags,
            "examples": self.examples
        }
```

#### AgentCapabilityConfig (èƒ½åŠ›é…ç½®)

```python
@dataclass
class AgentCapabilityConfig:
    """Agentèƒ½åŠ›é…ç½® - å®šä¹‰Agentæ”¯æŒçš„åè®®èƒ½åŠ›"""

    streaming: bool = False                    # æ˜¯å¦æ”¯æŒæµå¼å“åº”
    push_notifications: bool = True            # æ˜¯å¦æ”¯æŒæ¨é€é€šçŸ¥
    state_transition_history: bool = False    # æ˜¯å¦è®°å½•çŠ¶æ€è½¬æ¢å†å²
    multimodal: bool = False                   # æ˜¯å¦æ”¯æŒå¤šæ¨¡æ€è¾“å…¥

    def to_dict(self) -> Dict[str, Any]:
        """è½¬æ¢ä¸ºA2Aåè®®æ ¼å¼"""
        return {
            "streaming": self.streaming,
            "push_notifications": self.push_notifications,
            "state_transition_history": self.state_transition_history,
            "multimodal": self.multimodal
        }
```

### 3. æ‰§è¡Œå™¨ç³»ç»Ÿ (Executor System)

**æ–‡ä»¶ä½ç½®**: `easya2a/core/executor.py`

#### ExecutorFactory (æ‰§è¡Œå™¨å·¥å‚)

```python
class ExecutorFactory:
    """æ‰§è¡Œå™¨å·¥å‚ - æ ¹æ®Agentç±»å‹è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„æ‰§è¡Œå™¨"""

    @staticmethod
    def create_executor(agent: Any, name: str, description: str, **kwargs) -> BaseAgentExecutor:
        """æ™ºèƒ½Agentç±»å‹æ£€æµ‹å’Œæ‰§è¡Œå™¨åˆ›å»º"""

        # LangChain Agentæ£€æµ‹
        if hasattr(agent, 'invoke') and hasattr(agent, 'ainvoke'):
            logger.info("æ£€æµ‹åˆ°LangChain Agentï¼Œä½¿ç”¨LangChainAgentExecutor")
            return LangChainAgentExecutor(agent, name, description, **kwargs)

        # OpenAI Assistantæ£€æµ‹
        elif hasattr(agent, 'create_thread') and hasattr(agent, 'run'):
            logger.info("æ£€æµ‹åˆ°OpenAI Assistantï¼Œä½¿ç”¨OpenAIAssistantExecutor")
            return OpenAIAssistantExecutor(agent, name, description, **kwargs)

        # èŠå¤©æ¥å£æ£€æµ‹
        elif hasattr(agent, 'chat') or hasattr(agent, 'process'):
            logger.info("æ£€æµ‹åˆ°Chatæ¥å£ï¼Œä½¿ç”¨ChatAgentExecutor")
            return ChatAgentExecutor(agent, name, description, **kwargs)

        # å‡½æ•°è°ƒç”¨æ¥å£æ£€æµ‹
        elif callable(agent):
            logger.info("æ£€æµ‹åˆ°å¯è°ƒç”¨å¯¹è±¡ï¼Œä½¿ç”¨FunctionAgentExecutor")
            return FunctionAgentExecutor(agent, name, description, **kwargs)

        # é€šç”¨æ‰§è¡Œå™¨
        else:
            logger.warning("æœªè¯†åˆ«Agentç±»å‹ï¼Œä½¿ç”¨GenericAgentExecutor")
            return GenericAgentExecutor(agent, name, description, **kwargs)
```

#### BaseAgentExecutor (æ‰§è¡Œå™¨åŸºç±»)

```python
class BaseAgentExecutor:
    """Agentæ‰§è¡Œå™¨åŸºç±» - å®šä¹‰ç»Ÿä¸€çš„æ‰§è¡Œæ¥å£"""

    def __init__(self, agent: Any, name: str, description: str):
        self.agent = agent
        self.name = name
        self.description = description
        self.logger = logging.getLogger(f"executor.{name}")

    async def execute(self, request: Dict[str, Any]) -> Dict[str, Any]:
        """å¼‚æ­¥æ‰§è¡ŒAgentè¯·æ±‚ - å­ç±»å¿…é¡»å®ç°"""
        raise NotImplementedError("å­ç±»å¿…é¡»å®ç°executeæ–¹æ³•")

    def execute_sync(self, request: Dict[str, Any]) -> Dict[str, Any]:
        """åŒæ­¥æ‰§è¡ŒAgentè¯·æ±‚ - é»˜è®¤å®ç°"""
        import asyncio
        return asyncio.run(self.execute(request))

    def get_capabilities(self) -> Dict[str, Any]:
        """è·å–æ‰§è¡Œå™¨èƒ½åŠ›ä¿¡æ¯"""
        return {
            "name": self.name,
            "description": self.description,
            "agent_type": type(self.agent).__name__,
            "supports_async": True,
            "supports_streaming": False
        }
```

#### LangChainAgentExecutor (LangChainä¸“ç”¨)

```python
class LangChainAgentExecutor(BaseAgentExecutor):
    """LangChain Agentæ‰§è¡Œå™¨ - æ”¯æŒinvokeå’Œainvokeæ¥å£"""

    async def execute(self, request: Dict[str, Any]) -> Dict[str, Any]:
        """æ‰§è¡ŒLangChain Agent"""
        try:
            input_data = request.get("input", "")

            # ä¼˜å…ˆä½¿ç”¨å¼‚æ­¥æ¥å£
            if hasattr(self.agent, 'ainvoke'):
                result = await self.agent.ainvoke({"input": input_data})
            else:
                # åŒæ­¥æ¥å£åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œ
                import asyncio
                loop = asyncio.get_event_loop()
                result = await loop.run_in_executor(
                    None,
                    lambda: self.agent.invoke({"input": input_data})
                )

            return {
                "output": result.get("output", str(result)),
                "status": "success",
                "agent": self.name
            }

        except Exception as e:
            self.logger.error(f"LangChain Agentæ‰§è¡Œå¤±è´¥: {e}")
            return {
                "output": f"æ‰§è¡Œå¤±è´¥: {str(e)}",
                "status": "error",
                "agent": self.name
            }

    def get_capabilities(self) -> Dict[str, Any]:
        """LangChainç‰¹å®šèƒ½åŠ›"""
        caps = super().get_capabilities()
        caps.update({
            "supports_tools": hasattr(self.agent, 'tools'),
            "supports_memory": hasattr(self.agent, 'memory'),
            "langchain_version": getattr(self.agent, '__version__', 'unknown')
        })
        return caps
```

## ğŸ¨ ä¸‰æ­¥å¼APIè®¾è®¡

### ä¸‰æ­¥å¼è®¾è®¡æ¨¡å¼è¯¦è§£

#### ğŸ¯ ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ– (Initialization)

```python
wrapper = A2AAgentWrapper.set_up(agent, name, description)
```

**ç›®çš„**: åˆ›å»ºåŒ…è£…å™¨å®ä¾‹ï¼Œè®¾ç½®å¿…é¡»å‚æ•°
**å‚æ•°**:
- `agent`: è¦åŒ…è£…çš„Agentå®ä¾‹ (ä»»ä½•ç±»å‹)
- `name`: Agentåç§° (ç”¨äºæ ‡è¯†å’Œæ˜¾ç¤º)
- `description`: Agentæè¿° (ç”¨äºAgent Card)

**è®¾è®¡ç†å¿µ**: åªè¦æ±‚æœ€åŸºæœ¬çš„ä¿¡æ¯ï¼Œé™ä½ä½¿ç”¨é—¨æ§›

#### âš™ï¸ ç¬¬äºŒæ­¥ï¼šé“¾å¼é…ç½® (Chain Configuration)

```python
wrapper.add_skill("chat", "èŠå¤©åŠŸèƒ½", examples=["ä½ å¥½"]) \
       .add_skill("search", "æœç´¢åŠŸèƒ½", examples=["æœç´¢ä¿¡æ¯"]) \
       .set_provider("AI Corp", "https://ai.corp.com") \
       .set_version("2.0.0") \
       .enable_streaming() \
       .enable_history() \
       .enable_multimodal()
```

**ç›®çš„**: æ¸è¿›å¼é…ç½®ï¼Œç”¨æˆ·å¯ä»¥æŒ‰éœ€æ·»åŠ åŠŸèƒ½
**ç‰¹ç‚¹**:
- æ‰€æœ‰æ–¹æ³•è¿”å›`self`ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨
- å¯é€‰é…ç½®ï¼Œä¸å½±å“åŸºæœ¬åŠŸèƒ½
- æ™ºèƒ½é»˜è®¤å€¼ï¼Œå‡å°‘é…ç½®å·¥ä½œ

#### ğŸš€ ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨æœåŠ¡ (Service Launch)

```python
wrapper.run_a2a(port=10010, host="0.0.0.0")
```

**ç›®çš„**: æ„å»ºæœ€ç»ˆé…ç½®å¹¶å¯åŠ¨A2AæœåŠ¡
**æµç¨‹**:
1. é…ç½®éªŒè¯å’Œæ„å»º
2. åˆ›å»ºæ‰§è¡Œå™¨
3. åˆ›å»ºA2AæœåŠ¡å™¨åº”ç”¨
4. å¯åŠ¨WebæœåŠ¡

### APIè®¾è®¡ä¼˜åŠ¿

| ä¼˜åŠ¿ | ä¼ ç»Ÿæ–¹å¼ | ä¸‰æ­¥å¼API |
|------|----------|-----------|
| **å­¦ä¹ æˆæœ¬** | éœ€è¦ç†è§£å¤æ‚é…ç½®å¯¹è±¡ | åªéœ€ç†è§£3ä¸ªæ­¥éª¤ |
| **ä»£ç é‡** | 50+ è¡Œé…ç½®ä»£ç  | 10-15 è¡Œ |
| **é”™è¯¯å‘ç°** | è¿è¡Œæ—¶é”™è¯¯ | é…ç½®æ—¶é”™è¯¯ |
| **å¯è¯»æ€§** | åµŒå¥—é…ç½®éš¾è¯» | é“¾å¼è°ƒç”¨æ¸…æ™° |
| **æ‰©å±•æ€§** | ä¿®æ”¹é…ç½®ç±» | æ·»åŠ é“¾å¼æ–¹æ³• |

### æ–¹æ³•å‘½åè§„èŒƒ

| å‰ç¼€ | å«ä¹‰ | è¿”å›å€¼ | ç¤ºä¾‹ |
|------|------|--------|------|
| `set_up()` | ç±»æ–¹æ³•åˆå§‹åŒ– | æ–°å®ä¾‹ | `A2AAgentWrapper.set_up()` |
| `add_` | æ·»åŠ é…ç½®é¡¹ | self | `add_skill()`, `add_plugin()` |
| `set_` | è®¾ç½®å•ä¸ªå€¼ | self | `set_provider()`, `set_version()` |
| `enable_` | å¯ç”¨åŠŸèƒ½ | self | `enable_streaming()`, `enable_history()` |
| `run_` | æ‰§è¡Œæ“ä½œ | None/ç»“æœ | `run_a2a()` |

### é“¾å¼è°ƒç”¨å®ç°åŸç†

```python
def add_skill(self, skill_id: str, name: str, **kwargs) -> "A2AAgentWrapper":
    """é“¾å¼æ–¹æ³•çš„æ ‡å‡†å®ç°æ¨¡å¼"""

    # 1. æ‰§è¡Œå…·ä½“é€»è¾‘
    skill = AgentSkillConfig(id=skill_id, name=name, **kwargs)
    self._skills.append(skill)

    # 2. è®°å½•æ—¥å¿—
    logger.debug(f"æ·»åŠ æŠ€èƒ½: {name}")

    # 3. è¿”å›selfæ”¯æŒé“¾å¼è°ƒç”¨
    return self  # å…³é”®ï¼
```

**æ ¸å¿ƒåŸåˆ™**:
- æ¯ä¸ªé…ç½®æ–¹æ³•éƒ½è¿”å›`self`
- çŠ¶æ€ä¿®æ”¹åœ¨å†…éƒ¨å®Œæˆ
- å»¶è¿ŸéªŒè¯ï¼Œåœ¨`run_a2a()`æ—¶ç»Ÿä¸€å¤„ç†

## âš™ï¸ å®ç°ç»†èŠ‚

### é“¾å¼è°ƒç”¨å®ç°

```python
def add_skill(self, skill_id: str, name: str, **kwargs) -> "A2AAgentWrapper":
    """æ·»åŠ æŠ€èƒ½é…ç½®"""
    skill = AgentSkillConfig(
        id=skill_id,
        name=name,
        description=kwargs.get('description', f"{name}åŠŸèƒ½"),
        examples=kwargs.get('examples', []),
        tags=kwargs.get('tags', [])
    )
    self._skills.append(skill)
    return self  # å…³é”®ï¼šè¿”å›selfæ”¯æŒé“¾å¼è°ƒç”¨
```

### é…ç½®æ„å»ºç­–ç•¥

```python
def _build_config(self, port: int, host: str) -> AgentConfig:
    """å»¶è¿Ÿé…ç½®æ„å»º - åœ¨run_a2aæ—¶æ‰æ„å»ºå®Œæ•´é…ç½®"""
    
    # è®¾ç½®é»˜è®¤å€¼
    if not self._agent_url:
        self._agent_url = f"http://localhost:{port}/"
    
    # æ„å»ºèƒ½åŠ›é…ç½®
    capabilities = AgentCapabilityConfig(
        streaming=self._streaming,
        push_notifications=self._push_notifications,
        state_transition_history=self._state_history,
        multimodal=self._multimodal
    )
    
    # æ„å»ºå®Œæ•´é…ç½®
    return AgentConfig(
        name=self.name,
        description=self.description,
        # ... å…¶ä»–é…ç½®
    )
```

### æœåŠ¡å¯åŠ¨æµç¨‹

```python
def run_a2a(self, port: int = 10010, host: str = "0.0.0.0"):
    """æœåŠ¡å¯åŠ¨çš„å®Œæ•´æµç¨‹"""
    
    # 1. æ„å»ºé…ç½®
    config = self._build_config(port, host)
    
    # 2. æ˜¾ç¤ºå¯åŠ¨ä¿¡æ¯
    self._show_startup_info(config)
    
    # 3. åˆ›å»ºæ‰§è¡Œå™¨
    self._create_executor(config)
    
    # 4. åˆ›å»ºæœåŠ¡å™¨åº”ç”¨
    self._create_server_app(config)
    
    # 5. å¯åŠ¨æœåŠ¡
    self._start_server(host, port)
```

## ğŸ”Œ Agenté€‚é…å™¨

### Agentç±»å‹æ£€æµ‹

EasyA2Aæ”¯æŒå¤šç§ç±»å‹çš„Agentï¼Œé€šè¿‡æ™ºèƒ½æ£€æµ‹è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„é€‚é…å™¨ï¼š

#### æ”¯æŒçš„Agentç±»å‹

| Agentç±»å‹ | æ£€æµ‹æ¡ä»¶ | æ‰§è¡Œå™¨ | ç‰¹æ€§ |
|-----------|----------|--------|------|
| **LangChain Agent** | `hasattr(agent, 'invoke')` | `LangChainAgentExecutor` | å®Œæ•´LangChainç”Ÿæ€æ”¯æŒ |
| **OpenAI Assistant** | `hasattr(agent, 'create_thread')` | `OpenAIAssistantExecutor` | OpenAI Assistant API |
| **Chat Interface** | `hasattr(agent, 'chat')` | `ChatAgentExecutor` | ç®€å•èŠå¤©æ¥å£ |
| **Process Interface** | `hasattr(agent, 'process')` | `ProcessAgentExecutor` | é€šç”¨å¤„ç†æ¥å£ |
| **Function** | `callable(agent)` | `FunctionAgentExecutor` | å‡½æ•°å¼Agent |
| **Generic** | å…¶ä»–æƒ…å†µ | `GenericAgentExecutor` | é€šç”¨é€‚é…å™¨ |

#### LangChain Agenté€‚é…

```python
# æ”¯æŒçš„LangChain Agentç±»å‹
from langchain.agents import AgentExecutor, create_tool_calling_agent
from langchain.schema import BaseAgent

# è‡ªåŠ¨æ£€æµ‹å’Œé€‚é…
if hasattr(agent, 'invoke') and hasattr(agent, 'ainvoke'):
    # ä½¿ç”¨LangChainä¸“ç”¨æ‰§è¡Œå™¨
    executor = LangChainAgentExecutor(agent, name, description)

    # æ”¯æŒçš„åŠŸèƒ½
    # âœ… åŒæ­¥è°ƒç”¨: agent.invoke({"input": "message"})
    # âœ… å¼‚æ­¥è°ƒç”¨: await agent.ainvoke({"input": "message"})
    # âœ… å·¥å…·è°ƒç”¨: è‡ªåŠ¨æ£€æµ‹agent.tools
    # âœ… å†…å­˜ç®¡ç†: è‡ªåŠ¨æ£€æµ‹agent.memory
```

#### è‡ªå®šä¹‰Agenté€‚é…

```python
class CustomAgent:
    """è‡ªå®šä¹‰Agentç¤ºä¾‹"""

    def __init__(self, model_name: str):
        self.model_name = model_name

    def process(self, message: str) -> str:
        """å¤„ç†æ¶ˆæ¯çš„æ ‡å‡†æ¥å£"""
        return f"[{self.model_name}] å¤„ç†: {message}"

    def chat(self, message: str) -> str:
        """èŠå¤©æ¥å£"""
        return f"[{self.model_name}] å›å¤: {message}"

# è‡ªåŠ¨é€‚é…
custom_agent = CustomAgent("GPT-4")
wrapper = A2AAgentWrapper.set_up(custom_agent, "è‡ªå®šä¹‰åŠ©æ‰‹", "è‡ªå®šä¹‰Agentç¤ºä¾‹")
# ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°chatæ–¹æ³•ï¼Œä½¿ç”¨ChatAgentExecutor
```

## ğŸ“¡ A2Aåè®®é›†æˆ

### Agent Cardç”Ÿæˆ

EasyA2Aè‡ªåŠ¨ç”Ÿæˆç¬¦åˆA2Aåè®®æ ‡å‡†çš„Agent Cardï¼š

```json
{
  "name": "å¤©æ°”åŠ©æ‰‹",
  "description": "æ™ºèƒ½å¤©æ°”æŸ¥è¯¢æœåŠ¡",
  "version": "1.0.0",
  "url": "http://localhost:10010/",
  "provider": {
    "organization": "Weather AI Services",
    "url": "https://weather-ai.example.com"
  },
  "capabilities": {
    "streaming": false,
    "push_notifications": true,
    "state_transition_history": true,
    "multimodal": false
  },
  "default_input_modes": ["text", "text/plain", "application/json"],
  "default_output_modes": ["text", "text/plain", "application/json"],
  "skills": [
    {
      "id": "weather_query",
      "name": "å¤©æ°”æŸ¥è¯¢",
      "description": "æŸ¥è¯¢åŸå¸‚å¤©æ°”ä¿¡æ¯",
      "tags": ["weather", "query"],
      "examples": ["åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ", "ä¸Šæµ·ä¼šä¸‹é›¨å—ï¼Ÿ"]
    }
  ]
}
```

### A2Aåè®®ç«¯ç‚¹

EasyA2Aè‡ªåŠ¨åˆ›å»ºæ ‡å‡†çš„A2Aåè®®ç«¯ç‚¹ï¼š

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | ç¤ºä¾‹ |
|------|------|------|------|
| `/.well-known/agent-card.json` | GET | Agent Card | è·å–Agentå…ƒæ•°æ® |
| `/invoke` | POST | åŒæ­¥è°ƒç”¨ | å‘é€æ¶ˆæ¯å¹¶ç­‰å¾…å“åº” |
| `/stream` | POST | æµå¼è°ƒç”¨ | æµå¼å“åº” (å¦‚æœæ”¯æŒ) |
| `/status` | GET | çŠ¶æ€æŸ¥è¯¢ | è·å–AgentçŠ¶æ€ |
| `/health` | GET | å¥åº·æ£€æŸ¥ | æœåŠ¡å¥åº·çŠ¶æ€ |

### åè®®å…¼å®¹æ€§

```python
# A2Aåè®®æ ‡å‡†è¯·æ±‚æ ¼å¼
{
  "input": "ç”¨æˆ·æ¶ˆæ¯",
  "context": {
    "session_id": "session_123",
    "user_id": "user_456"
  },
  "parameters": {
    "temperature": 0.7,
    "max_tokens": 1000
  }
}

# A2Aåè®®æ ‡å‡†å“åº”æ ¼å¼
{
  "output": "Agentå“åº”",
  "status": "success",
  "metadata": {
    "agent": "å¤©æ°”åŠ©æ‰‹",
    "version": "1.0.0",
    "timestamp": "2025-01-14T10:30:00Z"
  }
}
```

## ğŸ”§ é…ç½®ç³»ç»Ÿ

### é…ç½®ä¼˜å…ˆçº§

1. **ç”¨æˆ·æ˜¾å¼é…ç½®** - ç”¨æˆ·é€šè¿‡æ–¹æ³•è®¾ç½®çš„å€¼
2. **æ™ºèƒ½é»˜è®¤å€¼** - æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­çš„é»˜è®¤å€¼
3. **ç³»ç»Ÿé»˜è®¤å€¼** - ç¡¬ç¼–ç çš„é»˜è®¤å€¼

### é…ç½®éªŒè¯

```python
def _validate_config(self, config: AgentConfig):
    """é…ç½®éªŒè¯"""
    if not config.name:
        raise ValueError("Agentåç§°ä¸èƒ½ä¸ºç©º")
    
    if not config.skills:
        logger.warning("æœªé…ç½®æŠ€èƒ½ï¼Œå°†ä½¿ç”¨é»˜è®¤æŠ€èƒ½")
    
    if config.port < 1024:
        logger.warning(f"ç«¯å£ {config.port} å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™")
```

### ç¯å¢ƒå˜é‡æ”¯æŒ

```python
# æ”¯æŒç¯å¢ƒå˜é‡é…ç½®
EASYA2A_DEFAULT_PORT=10010
EASYA2A_DEFAULT_HOST=0.0.0.0
EASYA2A_PROVIDER_ORG="My AI Services"
```

## ğŸš€ æ‰©å±•å¼€å‘

### è‡ªå®šä¹‰æ‰§è¡Œå™¨

```python
class CustomAgentExecutor(BaseAgentExecutor):
    def __init__(self, agent, name, description):
        super().__init__(agent, name, description)
    
    async def execute(self, request):
        """è‡ªå®šä¹‰æ‰§è¡Œé€»è¾‘"""
        # å®ç°ä½ çš„æ‰§è¡Œé€»è¾‘
        pass
```

### è‡ªå®šä¹‰æŠ€èƒ½æ¨¡æ¿

```python
class CustomSkillTemplates:
    @staticmethod
    def database_skill() -> AgentSkillConfig:
        return AgentSkillConfig(
            id="database",
            name="æ•°æ®åº“æŸ¥è¯¢",
            description="æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢æ“ä½œ",
            tags=["database", "sql", "query"],
            examples=["æŸ¥è¯¢ç”¨æˆ·æ•°æ®", "ç»Ÿè®¡è®¢å•æ•°é‡"]
        )
```

### æ’ä»¶ç³»ç»Ÿ

```python
class A2APlugin:
    def before_start(self, wrapper: A2AAgentWrapper):
        """æœåŠ¡å¯åŠ¨å‰çš„é’©å­"""
        pass
    
    def after_start(self, wrapper: A2AAgentWrapper):
        """æœåŠ¡å¯åŠ¨åçš„é’©å­"""
        pass

# ä½¿ç”¨æ’ä»¶
wrapper.add_plugin(LoggingPlugin())
wrapper.add_plugin(MetricsPlugin())
```

## ğŸ“Š ç›‘æ§ä¸è°ƒè¯•

### å†…ç½®ç›‘æ§

EasyA2Aæä¾›å®Œæ•´çš„ç›‘æ§å’Œè°ƒè¯•æ”¯æŒï¼š

#### å¯åŠ¨ä¿¡æ¯æ˜¾ç¤º

```python
# run_a2a()ä¼šè‡ªåŠ¨æ˜¾ç¤ºè¯¦ç»†çš„å¯åŠ¨ä¿¡æ¯
ğŸ¯ å¤©æ°”åŠ©æ‰‹ å¯åŠ¨å®Œæˆ
==================================================
ğŸ“‹ åç§°: å¤©æ°”åŠ©æ‰‹
ğŸ“ æè¿°: æ™ºèƒ½å¤©æ°”æŸ¥è¯¢æœåŠ¡
ğŸ”¢ ç‰ˆæœ¬: 1.0.0
ğŸ¢ æä¾›å•†: Weather AI Services
ğŸŒ æä¾›å•†ç½‘ç«™: https://weather-ai.example.com

ğŸ–¥ï¸ æœåŠ¡åœ°å€: http://localhost:10010
ğŸ“¡ Agent Card: http://localhost:10010/.well-known/agent-card.json
ğŸ¯ æŠ€èƒ½æ•°é‡: 2

âš¡ èƒ½åŠ›:
  â€¢ æµå¼å“åº”: âŒ
  â€¢ æ¨é€é€šçŸ¥: âœ…
  â€¢ çŠ¶æ€å†å²: âœ…
  â€¢ å¤šæ¨¡æ€: âŒ

ğŸ¯ æ”¯æŒæŠ€èƒ½:
  â€¢ å¤©æ°”æŸ¥è¯¢: æŸ¥è¯¢åŸå¸‚å¤©æ°”ä¿¡æ¯
    ç¤ºä¾‹: åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ
  â€¢ å¤©æ°”å»ºè®®: æä¾›ç©¿è¡£å»ºè®®
    ç¤ºä¾‹: ä»Šå¤©ç©¿ä»€ä¹ˆï¼Ÿ
==================================================
ğŸš€ æœåŠ¡å¯åŠ¨ä¸­...
```

#### æ—¥å¿—ç³»ç»Ÿ

```python
import logging

# å¯ç”¨è¯¦ç»†æ—¥å¿—
logging.basicConfig(level=logging.DEBUG)

# EasyA2Aä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—
logger = logging.getLogger("easya2a")
logger.info("ğŸ A2AAgentWrapperåˆå§‹åŒ–: å¤©æ°”åŠ©æ‰‹")
logger.debug("æ·»åŠ æŠ€èƒ½: å¤©æ°”æŸ¥è¯¢")
logger.info("âš™ï¸ Agentæ‰§è¡Œå™¨åˆ›å»ºæˆåŠŸ: LangChainAgentExecutor")
logger.info("ğŸŒ A2AæœåŠ¡å™¨åº”ç”¨åˆ›å»ºæˆåŠŸ")
```

#### å¥åº·æ£€æŸ¥ç«¯ç‚¹

```python
# GET /health
{
  "status": "healthy",
  "agent": {
    "name": "å¤©æ°”åŠ©æ‰‹",
    "version": "1.0.0",
    "type": "LangChainAgent"
  },
  "server": {
    "uptime": "00:05:23",
    "requests_handled": 42,
    "last_request": "2025-01-14T10:30:00Z"
  },
  "capabilities": {
    "streaming": false,
    "multimodal": false
  }
}
```

### è°ƒè¯•æ¨¡å¼

```python
# å¯ç”¨è°ƒè¯•æ¨¡å¼
A2AAgentWrapper.set_up(agent, "è°ƒè¯•åŠ©æ‰‹", "è°ƒè¯•æ¨¡å¼æµ‹è¯•") \
               .add_skill("debug", "è°ƒè¯•åŠŸèƒ½") \
               .run_a2a(port=10010, debug=True)  # å¯ç”¨è°ƒè¯•

# è°ƒè¯•æ¨¡å¼ç‰¹æ€§:
# âœ… è¯¦ç»†çš„è¯·æ±‚/å“åº”æ—¥å¿—
# âœ… é”™è¯¯å †æ ˆè·Ÿè¸ª
# âœ… æ€§èƒ½è®¡æ—¶ä¿¡æ¯
# âœ… é…ç½®éªŒè¯è¯¦æƒ…
```

## ğŸš€ éƒ¨ç½²æŒ‡å—

### æœ¬åœ°å¼€å‘éƒ¨ç½²

```python
# å¼€å‘ç¯å¢ƒé…ç½®
A2AAgentWrapper.set_up(agent, "å¼€å‘åŠ©æ‰‹", "å¼€å‘ç¯å¢ƒ") \
               .add_skill("test", "æµ‹è¯•åŠŸèƒ½") \
               .run_a2a(
                   port=10010,
                   host="127.0.0.1",  # ä»…æœ¬åœ°è®¿é—®
                   debug=True          # å¯ç”¨è°ƒè¯•
               )
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```python
# ç”Ÿäº§ç¯å¢ƒé…ç½®
A2AAgentWrapper.set_up(agent, "ç”Ÿäº§åŠ©æ‰‹", "ç”Ÿäº§ç¯å¢ƒ") \
               .add_skill("production", "ç”Ÿäº§åŠŸèƒ½") \
               .set_provider("Production AI", "https://prod.ai.com") \
               .set_version("1.0.0") \
               .run_a2a(
                   port=8080,
                   host="0.0.0.0",    # å…è®¸å¤–éƒ¨è®¿é—®
                   debug=False        # å…³é—­è°ƒè¯•
               )
```

### Dockeréƒ¨ç½²

```dockerfile
# Dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 8080

CMD ["python", "my_agent.py"]
```

```python
# my_agent.py
A2AAgentWrapper.set_up(agent, "DockeråŠ©æ‰‹", "Dockeréƒ¨ç½²") \
               .run_a2a(port=8080, host="0.0.0.0")
```

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env æ–‡ä»¶
EASYA2A_PORT=8080
EASYA2A_HOST=0.0.0.0
EASYA2A_DEBUG=false
EASYA2A_PROVIDER_ORG="My AI Company"
EASYA2A_PROVIDER_URL="https://myai.com"
```

```python
# æ”¯æŒç¯å¢ƒå˜é‡
import os

port = int(os.getenv("EASYA2A_PORT", 10010))
host = os.getenv("EASYA2A_HOST", "0.0.0.0")
debug = os.getenv("EASYA2A_DEBUG", "false").lower() == "true"

A2AAgentWrapper.set_up(agent, "ç¯å¢ƒé…ç½®åŠ©æ‰‹", "æ”¯æŒç¯å¢ƒå˜é‡") \
               .run_a2a(port=port, host=host, debug=debug)
```

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. å»¶è¿Ÿåˆå§‹åŒ–ç­–ç•¥

```python
class A2AAgentWrapper:
    def __init__(self, agent, name, description):
        # åªå­˜å‚¨åŸºæœ¬ä¿¡æ¯ï¼Œä¸ç«‹å³æ„å»ºå¤æ‚å¯¹è±¡
        self.agent = agent
        self.name = name
        self.description = description
        self._skills = []  # è½»é‡çº§åˆ—è¡¨

        # é‡é‡çº§å¯¹è±¡å»¶è¿Ÿåˆ›å»º
        self._executor = None
        self._server_app = None
        self._config = None

    def run_a2a(self, port, host):
        # åœ¨çœŸæ­£éœ€è¦æ—¶æ‰æ„å»ºé…ç½®
        self._config = self._build_config(port, host)  # å»¶è¿Ÿæ„å»º
        self._create_executor(self._config)            # å»¶è¿Ÿåˆ›å»º
        self._create_server_app(self._config)          # å»¶è¿Ÿåˆ›å»º
```

**ä¼˜åŠ¿**: å‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜åˆå§‹åŒ–é€Ÿåº¦

### 2. å¼‚æ­¥å¤„ç†ä¼˜åŒ–

```python
class LangChainAgentExecutor:
    async def execute(self, request):
        """ä¼˜åŒ–çš„å¼‚æ­¥æ‰§è¡Œ"""
        try:
            # ä¼˜å…ˆä½¿ç”¨åŸç”Ÿå¼‚æ­¥æ¥å£
            if hasattr(self.agent, 'ainvoke'):
                result = await self.agent.ainvoke(request)
            else:
                # åŒæ­¥æ¥å£åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œé¿å…é˜»å¡
                import asyncio
                loop = asyncio.get_event_loop()
                result = await loop.run_in_executor(
                    None,
                    lambda: self.agent.invoke(request)
                )
            return result
        except Exception as e:
            # å¼‚æ­¥é”™è¯¯å¤„ç†
            logger.error(f"å¼‚æ­¥æ‰§è¡Œå¤±è´¥: {e}")
            raise
```

### 3. è¿æ¥æ± å’Œä¸­é—´ä»¶

```python
# A2AStarletteApplication å†…ç½®ä¼˜åŒ–
class A2AStarletteApplication:
    def __init__(self, agent_card, http_handler):
        self.app = Starlette()

        # æ·»åŠ æ€§èƒ½ä¸­é—´ä»¶
        self.app.add_middleware(
            CORSMiddleware,
            allow_origins=["*"],
            allow_methods=["GET", "POST"],
            allow_headers=["*"]
        )

        # è¯·æ±‚é™æµä¸­é—´ä»¶
        self.app.add_middleware(
            RateLimitMiddleware,
            calls=100,
            period=60
        )

        # å“åº”å‹ç¼©ä¸­é—´ä»¶
        self.app.add_middleware(GZipMiddleware, minimum_size=1000)
```

### 4. å†…å­˜ç®¡ç†

```python
# æ™ºèƒ½å†…å­˜ç®¡ç†
class TaskStore:
    def __init__(self, max_tasks=1000):
        self.tasks = {}
        self.max_tasks = max_tasks

    def add_task(self, task_id, task_data):
        # è‡ªåŠ¨æ¸…ç†æ—§ä»»åŠ¡
        if len(self.tasks) >= self.max_tasks:
            oldest_task = min(self.tasks.keys())
            del self.tasks[oldest_task]

        self.tasks[task_id] = task_data
```

### 5. é…ç½®ç¼“å­˜

```python
# é…ç½®å¯¹è±¡ç¼“å­˜
class ConfigCache:
    _cache = {}

    @classmethod
    def get_config(cls, cache_key, builder_func):
        if cache_key not in cls._cache:
            cls._cache[cache_key] = builder_func()
        return cls._cache[cache_key]
```

### æ€§èƒ½ç›‘æ§

```python
# å†…ç½®æ€§èƒ½ç›‘æ§
import time
from functools import wraps

def monitor_performance(func):
    @wraps(func)
    async def wrapper(*args, **kwargs):
        start_time = time.time()
        try:
            result = await func(*args, **kwargs)
            duration = time.time() - start_time
            logger.info(f"â±ï¸ {func.__name__} æ‰§è¡Œæ—¶é—´: {duration:.3f}s")
            return result
        except Exception as e:
            duration = time.time() - start_time
            logger.error(f"âŒ {func.__name__} æ‰§è¡Œå¤±è´¥ ({duration:.3f}s): {e}")
            raise
    return wrapper

# è‡ªåŠ¨åº”ç”¨åˆ°å…³é”®æ–¹æ³•
@monitor_performance
async def execute(self, request):
    # Agentæ‰§è¡Œé€»è¾‘
    pass
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   ```
   è§£å†³æ–¹æ¡ˆï¼šæ›´æ¢ç«¯å£æˆ–åœæ­¢å ç”¨è¿›ç¨‹
   wrapper.run_a2a(port=10011)
   ```

2. **Agentä¸å…¼å®¹**
   ```
   è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥Agentæ˜¯å¦æœ‰invokeæˆ–chatæ–¹æ³•
   ç¡®ä¿Agentç¬¦åˆLangChainæ¥å£è§„èŒƒ
   ```

3. **é…ç½®éªŒè¯å¤±è´¥**
   ```
   è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥å¿…å¡«å­—æ®µæ˜¯å¦ä¸ºç©º
   ç¡®ä¿URLæ ¼å¼æ­£ç¡®
   ```

### è°ƒè¯•æ¨¡å¼

```python
import logging
logging.basicConfig(level=logging.DEBUG)

# å¯ç”¨è¯¦ç»†æ—¥å¿—
wrapper.run_a2a(port=10010, debug=True)
```

### å¥åº·æ£€æŸ¥

```python
# è®¿é—®å¥åº·æ£€æŸ¥ç«¯ç‚¹
GET http://localhost:10010/health

# å“åº”
{
    "status": "healthy",
    "agent": "å¤©æ°”åŠ©æ‰‹",
    "version": "1.0.0",
    "uptime": "00:05:23"
}
```

## ğŸ“‹ å¿«é€Ÿå‚è€ƒ

### å®Œæ•´APIé€ŸæŸ¥

```python
from easya2a import A2AAgentWrapper

# å®Œæ•´é…ç½®ç¤ºä¾‹
A2AAgentWrapper.set_up(agent, "åç§°", "æè¿°") \
    .add_skill("id", "åç§°", description="æè¿°", examples=["ç¤ºä¾‹"], tags=["æ ‡ç­¾"]) \
    .set_provider("ç»„ç»‡", "ç½‘ç«™") \
    .set_version("1.0.0") \
    .enable_streaming() \
    .enable_history() \
    .enable_multimodal() \
    .set_input_modes(["text", "json"]) \
    .set_output_modes(["text", "json"]) \
    .run_a2a(port=10010, host="0.0.0.0")
```

### å¸¸ç”¨é…ç½®æ¨¡æ¿

```python
# èŠå¤©æœºå™¨äºº
A2AAgentWrapper.set_up(agent, "èŠå¤©åŠ©æ‰‹", "æ™ºèƒ½å¯¹è¯æœåŠ¡") \
    .add_skill("chat", "å¯¹è¯", examples=["ä½ å¥½", "èŠå¤©"]) \
    .run_a2a()

# å·¥å…·è°ƒç”¨Agent
A2AAgentWrapper.set_up(agent, "å·¥å…·åŠ©æ‰‹", "å·¥å…·è°ƒç”¨æœåŠ¡") \
    .add_skill("search", "æœç´¢", examples=["æœç´¢ä¿¡æ¯"]) \
    .add_skill("calculate", "è®¡ç®—", examples=["è®¡ç®—ç»“æœ"]) \
    .enable_streaming() \
    .run_a2a()

# å¤šæ¨¡æ€Agent
A2AAgentWrapper.set_up(agent, "å¤šæ¨¡æ€åŠ©æ‰‹", "å¤šæ¨¡æ€AIæœåŠ¡") \
    .add_skill("vision", "å›¾åƒç†è§£", examples=["åˆ†æå›¾ç‰‡"]) \
    .add_skill("audio", "è¯­éŸ³å¤„ç†", examples=["è¯­éŸ³è½¬æ–‡å­—"]) \
    .enable_multimodal() \
    .run_a2a()
```

---

**æŠ€æœ¯æ”¯æŒ**: å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤Issueæˆ–æŸ¥çœ‹FAQæ–‡æ¡£ã€‚
