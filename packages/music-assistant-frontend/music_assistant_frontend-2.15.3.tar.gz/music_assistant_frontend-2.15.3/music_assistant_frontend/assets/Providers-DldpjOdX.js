import{U as R,x as Y,c as D,a6 as i,aW as X,b as z,w as F,a0 as g,a1 as M,a2 as s,ca as f,I as V,X as r,bG as G,F as d,W as c,ab as v,Y as a,at as O,a9 as W,Z as j,ac as h,G as Z,as as _,ad as m,aa as l,E as b,ar as y,cb as q,a5 as H}from"./index-BGgfaO08.js";import{B as k}from"./Button-D4MtJJYV.js";import{L as J}from"./ListItem-BJnG7rcc.js";import{C as K}from"./Container-DbIstGeW.js";import{a as Q}from"./VBtn-Bp792jbq.js";import{V as T}from"./VToolbar-BRuOCCCG.js";import{V as w}from"./VAlert-DWZhUScf.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VContainer-DLfYWZki.js";/* empty css              */const ne={class:"line-clamp-1"},te={class:"line-clamp-1"},ie=R({__name:"Providers",setup(ae){const C=G(),p=Y([]),x=D(()=>Object.values(i.providerManifests).filter(n=>n.multi_instance||!p.value.find(e=>e.domain==n.domain)).sort((n,e)=>(n.name||i.providerManifests[n.domain].name).toUpperCase()>(e.name||i.providerManifests[e.domain].name).toUpperCase()?1:-1)),A=i.subscribe(X.PROVIDERS_UPDATED,()=>{$()});z(A);const $=async function(){p.value=await i.getProviderConfigs()},B=function(n){i.removeProviderConfig(n),p.value=p.value.filter(e=>e.instance_id!=n)},I=function(n){C.push(`/settings/editprovider/${n}`)},N=function(n){if(n.depends_on&&!i.getProvider(n.depends_on)){const e=i.getProviderName(n.depends_on);confirm(l("settings.provider_depends_on_confirm",[n.name,e]))&&C.push(`/settings/addprovider/${n.depends_on}`);return}C.push(`/settings/addprovider/${n.domain}`)},E=function(n){n.enabled=!n.enabled,i.saveProviderConfig(n.domain,{enabled:n.enabled},n.instance_id)},U=function(n){i.sendCommand("config/providers/reload",{instance_id:n}).catch(e=>alert(e))},L=function(n,e){var t;const o=[{label:"settings.configure",labelArgs:[],action:()=>{I(e.instance_id)},icon:"mdi-cog"},{label:e.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{E(e)},icon:"mdi-cancel",disabled:!i.providerManifests[e.domain].allow_disable},{label:"settings.documentation",labelArgs:[],action:()=>{q(i.providerManifests[e.domain].documentation)},icon:"mdi-bookshelf",disabled:!i.providerManifests[e.domain].documentation},{label:"settings.sync",labelArgs:[],action:()=>{i.startSync(void 0,[e.instance_id])},icon:"mdi-sync",hide:!((t=i.providers[e.instance_id])!=null&&t.available)||e.type!=f.MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{B(e.instance_id)},icon:"mdi-delete",hide:i.providerManifests[e.domain].builtin},{label:"settings.reload",labelArgs:[],action:()=>{U(e.instance_id)},icon:"mdi-refresh"}];H.emit("contextmenu",{items:o,posX:n.clientX,posY:n.clientY})};F(()=>i.providers,n=>{n&&$()},{immediate:!0});const P=function(n){const e=i.providerManifests[n.domain].name;if(n.name)return`${e} [${n.name}]`;const o=i.getProvider(n.instance_id);return o&&o.instance_name_postfix?`${e} [${o.instance_name_postfix}]`:e};return(n,e)=>(r(!0),g(V,null,M(s(f),o=>(r(),g("div",{key:o,style:{"margin-bottom":"10px"}},[d(T,{color:"transparent",density:"compact",class:"titlebar"},{title:a(()=>[_(m(s(l)(`settings.${o}providers`)),1)]),append:a(()=>[x.value.filter(t=>t.type==o).length?(r(),c(O,{key:0,scrim:""},{activator:a(({props:t})=>[d(Q,Z({ref_for:!0},t,{color:"accent",variant:"outlined"}),{default:a(()=>[_(m(s(l)("settings.add_new_provider_button",[o])),1)]),_:2},1040)]),default:a(()=>[d(W,{density:"compact"},{default:a(()=>[(r(!0),g(V,null,M(x.value.filter(t=>t.type==o),t=>(r(),c(j,{key:t.domain,style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:t.name,onClick:u=>N(t)},{prepend:a(()=>[d(h,{domain:t.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:2},1024)]),_:2},1024)):v("",!0)]),_:2},1024),o==s(f).MUSIC&&p.value.filter(t=>t.type==s(f).MUSIC&&t.domain in s(i).providerManifests&&t.domain!=="builtin").length==0?(r(),c(w,{key:0,border:"top","border-color":"warning",style:{margin:"20px"},icon:"mdi-alert-box-outline"},{default:a(()=>[b("b",null,m(s(l)("settings.no_music_providers_detail")),1),e[0]||(e[0]=b("br",null,null,-1)),_(" "+m(s(l)("settings.no_music_providers_detail")),1)]),_:1,__:[0]})):v("",!0),o==s(f).PLAYER&&p.value.filter(t=>t.type==s(f).PLAYER&&t.domain in s(i).providerManifests).length==0?(r(),c(w,{key:1,border:"top","border-color":"warning",style:{margin:"20px"},icon:"mdi-alert-box-outline"},{default:a(()=>[b("b",null,m(s(l)("settings.no_player_providers_detail")),1),e[1]||(e[1]=b("br",null,null,-1)),_(" "+m(s(l)("settings.no_player_providers_detail")),1)]),_:1,__:[1]})):v("",!0),d(K,null,{default:a(()=>[(r(!0),g(V,null,M(p.value.filter(t=>t.type==o).sort((t,u)=>P(t).localeCompare(P(u))),t=>(r(),c(J,{key:t.instance_id,"show-menu-btn":"",link:"",onMenu:u=>L(u,t),onClick:u=>I(t.instance_id)},{prepend:a(()=>[d(h,{domain:t.domain,size:50,class:"listitem-media-thumb",style:{"margin-top":"5px","margin-bottom":"5px"}},null,8,["domain"])]),title:a(()=>[b("div",ne,m(P(t)),1)]),subtitle:a(()=>[b("div",te,m(s(i).providerManifests[t.domain].description),1)]),append:a(()=>{var u;return[s(i).syncTasks.value.filter(S=>S.provider_instance==t.instance_id).length>0?(r(),c(k,{key:0,icon:"",title:s(l)("settings.sync_running")},{default:a(()=>[d(y,{color:"grey"},{default:a(()=>e[2]||(e[2]=[_(" mdi-sync ",-1)])),_:1,__:[2]})]),_:1},8,["title"])):v("",!0),t.enabled?t.last_error?(r(),c(k,{key:2,icon:"",title:t.last_error},{default:a(()=>[d(y,{color:"red"},{default:a(()=>e[4]||(e[4]=[_(" mdi-alert-circle ",-1)])),_:1,__:[4]})]),_:2},1032,["title"])):(u=s(i).providers[t.instance_id])!=null&&u.available?v("",!0):(r(),c(k,{key:3,icon:"",title:s(l)("settings.not_loaded")},{default:a(()=>[d(y,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(r(),c(k,{key:1,icon:"",title:s(l)("settings.provider_disabled")},{default:a(()=>[d(y,{color:"grey"},{default:a(()=>e[3]||(e[3]=[_(" mdi-cancel ",-1)])),_:1,__:[3]})]),_:1},8,["title"]))]}),_:2},1032,["onMenu","onClick"]))),128))]),_:2},1024)]))),128))}}),fe=ee(ie,[["__scopeId","data-v-918eff0b"]]);export{fe as default};
