import{C as xe}from"./Container-DbIstGeW.js";import{T as et}from"./Toolbar-uC2RZ0mv.js";import{g as _e,p as tt,i as at,an as it,F as b,ag as Ae,ah as D,J as lt,K as ot,ao as st,P as nt,aR as rt,aM as ut,U as J,W as c,X as n,G as ue,a2 as v,aY as R,a6 as se,bs as $e,x as C,c as U,bL as N,Y as d,ab as p,a0 as w,V as mt,bK as Ce,bD as ne,as as I,ad as f,aq as j,ac as dt,a7 as T,ar as L,E as K,au as ct,b7 as W,bM as pt,b8 as ft,bN as Te,bE as Fe,bH as Ve,bO as me,bP as Pe,bt as vt,aJ as yt,a9 as ht,bh as bt,bv as kt,bw as X,Z as wt,a4 as _,bz as gt,e as It,b as le,w as H,o as St,R as be,bQ as Bt,aW as z,$ as _t,aw as At,bo as $t,I as ke,a1 as we,br as oe,bG as Ct,bq as ge}from"./index-BGgfaO08.js";import{M as De}from"./MediaItemThumb-Cbujilda.js";import{L as Tt}from"./ListItem-BJnG7rcc.js";import{B as Oe}from"./Button-D4MtJJYV.js";import{_ as re,V as Le}from"./VCheckbox-BMJoWdIx.js";import{a as q}from"./VBtn-Bp792jbq.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Ft,P as Vt}from"./PanelviewItemCompact-C4tWqPtC.js";import{V as Pt}from"./VSpacer-VZkyPce_.js";import{V as Dt}from"./VTextField-i_8qeZX7.js";import{a as Ot,V as Lt}from"./VInfiniteScroll-CZmdCzlf.js";import{V as Ie,a as Se}from"./VRow-Ba2PPdC8.js";import{V as Mt}from"./VVirtualScroll-Cck1W7XL.js";import{V as Be}from"./VAlert-DWZhUScf.js";const Me=Symbol.for("vuetify:v-item-group"),Et=tt({...nt(),...st({selectedClass:"v-item--selected"}),...ot(),...lt()},"VItemGroup"),Ee=_e()({name:"VItemGroup",props:Et(),emits:{"update:modelValue":A=>!0},setup(A,i){let{slots:h}=i;const{themeClasses:g}=at(A),{isSelected:o,select:k,next:$,prev:F,selected:a}=it(A,Me);return()=>b(A.tag,{class:D(["v-item-group",g.value,A.class]),style:Ae(A.style)},{default:()=>{var B;return[(B=h.default)==null?void 0:B.call(h,{isSelected:o,select:k,next:$,prev:F,selected:a.value})]}})}}),M=_e()({name:"VItem",props:rt(),emits:{"group:selected":A=>!0},setup(A,i){let{slots:h}=i;const{isSelected:g,select:o,toggle:k,selectedClass:$,value:F,disabled:a}=ut(A,Me);return()=>{var B;return(B=h.default)==null?void 0:B.call(h,{isSelected:g.value,selectedClass:$.value,select:o,toggle:k,value:F.value,disabled:a.value})}}}),Re=J({__name:"FavoriteButton",props:{item:{}},setup(A){const i=A;return(h,g)=>{var o;return n(),c(Oe,ue(i,{variant:"list",icon:(o=h.item)!=null&&o.favorite?"mdi-heart":"mdi-heart-outline",title:h.$t("tooltip.favorite"),onClick:[g[0]||(g[0]=k=>v(se).toggleFavorite(h.item)),g[1]||(g[1]=R(()=>{},["prevent"])),g[2]||(g[2]=R(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),Rt={key:0,class:"media-thumb listitem-media-thumb"},Kt={key:1,class:"media-thumb listitem-media-thumb"},Nt={key:0},Yt={key:0},Xt={key:0,class:"line-clamp-1"},zt={key:1},Gt={key:0},Ht={key:1},Ut={key:2},jt={key:3},Wt={key:4},qt={key:5},Jt={key:6},Qt={key:7},Zt={key:5},xt={key:6},ea={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},ta=J({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(A,{emit:i}){const{t:h}=$e(),g=C(!1),o=A,k=U(()=>{if(!("provider_mappings"in o.item))return"";for(const t of o.item.provider_mappings)if(t.audio_format&&t.audio_format.content_type!=null&&[N.DSF,N.FLAC,N.AIFF,N.WAV].includes(t.audio_format.content_type)&&(t.audio_format.sample_rate>48e3||t.audio_format.bit_depth>16))return`${t.audio_format.sample_rate/1e3}kHz ${t.audio_format.bit_depth} bits`;return""}),$=i,F=function(t){const y="clientX"in t?t.clientX:t.touches[0].clientX,S="clientY"in t?t.clientY:t.touches[0].clientY;me(o.item,y,S,o.parentItem)},a=function(t){o.showCheckboxes||Pe(o.item,t.clientX,t.clientY,o.parentItem)},B=function(t){o.showCheckboxes||Ve(o.item,t.clientX,t.clientY,o.parentItem)};return(t,y)=>(n(),c(Tt,{link:"","show-menu-btn":t.showMenu,class:D({unavailable:!t.isAvailable}),onClick:R(a,["stop"]),onMenu:R(F,["stop"])},{prepend:d(()=>[t.showCheckboxes?(n(),w("div",Rt,[b(Le,{"model-value":t.isSelected,onClick:y[0]||(y[0]=R(()=>{},["stop"])),"onUpdate:modelValue":y[1]||(y[1]=S=>{S!=null&&$("select",t.item,S)})},null,8,["model-value"])])):(n(),w("div",Kt,[b(De,{size:"50",item:t.isAvailable?t.item:void 0,class:D({dimmed:g.value})},null,8,["item","class"])])),!t.showCheckboxes&&t.item.is_playable?(n(),c(q,{key:2,class:D({hidden:!g.value}),icon:"mdi-play",color:"primary",fab:"",size:"small",style:{position:"absolute",left:"12px",bottom:"12px"},onClick:R(B,["stop"]),onMouseenter:y[2]||(y[2]=S=>g.value=!0),onMouseleave:y[3]||(y[3]=S=>g.value=!1)},null,8,["class"])):p("",!0)]),title:d(()=>[t.item.media_type==v(T).FOLDER?(n(),w("span",Nt,[K("span",null,f(v(Te)(t.item,v(h))),1)])):(n(),w("span",{key:1,class:D({"is-playing":t.isPlaying})},[I(f(t.item.name)+" ",1),"version"in t.item&&t.item.version?(n(),w("span",Yt,"("+f(t.item.version)+")",1)):p("",!0)],2)),t.item&&t.item.metadata?(n(),c(v(ne),{key:2,location:"bottom"},{activator:d(({props:S})=>[v(Fe)(t.item.metadata.explicit||!1)?(n(),c(L,ue({key:0},S,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):p("",!0)]),default:d(()=>[K("span",null,f(t.$t("tooltip.explicit")),1)]),_:1})):p("",!0)]),subtitle:d(()=>{var S;return[t.item.media_type==v(T).TRACK&&"provider_mappings"in t.item?(n(),w("div",Xt,[b(Ee,null,{default:d(()=>["artists"in t.item?(n(),c(M,{key:0},{default:d(()=>[I(f(v(W)(t.item.artists,2)),1)]),_:1})):p("",!0),t.showAlbum&&"album"in t.item&&t.item.album?(n(),c(M,{key:1},{default:d(()=>[I(" • "+f(t.item.album.name),1)]),_:1})):p("",!0),t.showDiscNumber&&"disc_number"in t.item&&t.item.disc_number?(n(),c(M,{key:2},{default:d(()=>[b(L,{style:{"margin-left":"5px"},icon:"md:album"}),I(" "+f(t.item.disc_number),1)]),_:1})):p("",!0),t.showTrackNumber&&"track_number"in t.item&&t.item.track_number?(n(),c(M,{key:3},{default:d(()=>[b(L,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),I(" "+f(t.item.track_number),1)]),_:1})):t.showPosition&&"position"in t.item&&t.item.position?(n(),c(M,{key:4},{default:d(()=>[b(L,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),I(" "+f(t.item.position),1)]),_:1})):p("",!0)]),_:1})])):t.item.media_type==v(T).ALBUM&&"year"in t.item?(n(),w("div",zt,[t.item.album_type!=v(pt).UNKNOWN?(n(),w("span",Gt,f(t.$t("album_type."+t.item.album_type))+" • ",1)):p("",!0),K("span",null,f(v(W)(t.item.artists)),1),t.item.year?(n(),w("span",Ht," • "+f(t.item.year),1)):p("",!0)])):"artists"in t.item&&t.item.artists?(n(),w("div",Ut,f(v(W)(t.item.artists)),1)):"owner"in t.item&&t.item.owner?(n(),w("div",jt,f(t.item.owner),1)):"authors"in t.item&&t.item.authors?(n(),w("div",Wt,f(t.item.authors.join(" / ")),1)):"publisher"in t.item&&t.item.publisher?(n(),w("div",qt,f(t.item.publisher),1)):"metadata"in t.item&&((S=t.item.metadata)!=null&&S.description)&&[v(T).RADIO,v(T).PLAYLIST,v(T).FOLDER].includes(t.item.media_type)?(n(),w("div",Jt,f(v(ft)(t.item.metadata.description,150)),1)):"media_type"in t.item&&!t.item.provider_mappings?(n(),w("div",Qt,f(t.$t(t.item.media_type)),1)):p("",!0)]}),append:d(()=>[t.isPlaying?(n(),c(re,{key:0})):p("",!0),k.value?(n(),c(mt,{key:1,src:v(Ce),width:"30",class:D(t.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:d(()=>[b(v(ne),{activator:"parent",location:"bottom"},{default:d(()=>[I(f(k.value),1)]),_:1})]),_:1},8,["src","class"])):p("",!0),v(j)("bp2")&&t.showProvider?(n(),c(dt,{key:2,domain:t.item.media_type==v(T).PLAYLIST?t.item.provider_mappings[0].provider_domain:t.item.provider,size:24},null,8,["domain"])):p("",!0),"fully_played"in t.item&&t.item.fully_played?(n(),c(L,{key:3,title:t.$t("item_fully_played")},{default:d(()=>y[4]||(y[4]=[I("mdi-check",-1)])),_:1,__:[4]},8,["title"])):"resume_position_ms"in t.item&&t.item.resume_position_ms?(n(),c(L,{key:4,title:t.$t("item_in_progress")},{default:d(()=>y[5]||(y[5]=[I("mdi-clock-fast",-1)])),_:1,__:[5]},8,["title"])):p("",!0),v(j)("bp3")&&"favorite"in t.item&&t.showFavorite&&!t.$vuetify.display.mobile?(n(),w("div",Zt,[b(Re,{item:t.item},null,8,["item"])])):p("",!0),t.showDuration&&"duration"in t.item&&t.item.duration&&v(j)("bp0")?(n(),w("div",xt,[K("div",null,[K("span",ea,f(v(ct)(t.item.duration)),1)])])):p("",!0)]),_:1},8,["show-menu-btn","class"]))}}),aa=de(ta,[["__scopeId","data-v-0c612c6b"]]),ia={key:0},la=["src"],oa={key:0},sa=J({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},showTrackNumber:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(A,{emit:i}){const h=A,g=U(()=>{for(const a of h.item.provider_mappings)if(a.audio_format&&a.audio_format.content_type!=null&&[N.DSF,N.FLAC,N.AIFF,N.WAV].includes(a.audio_format.content_type)&&(a.audio_format.sample_rate>48e3||a.audio_format.bit_depth>16))return`${a.audio_format.sample_rate/1e3}kHz ${a.audio_format.bit_depth} bits`;return""}),o=i,k=function(a){if(h.showCheckboxes)return;const B="clientX"in a?a.clientX:a.touches[0].clientX,t="clientY"in a?a.clientY:a.touches[0].clientY;me(h.item,B,t,h.parentItem)},$=function(a){if(h.showCheckboxes){o("select",h.item,!h.isSelected);return}Pe(h.item,a.clientX,a.clientY,h.parentItem)},F=function(a){h.showCheckboxes||Ve(h.item,a.clientX,a.clientY,h.parentItem)};return(a,B)=>{const t=vt("hold");return n(),c(Ft,null,{default:d(({isHovering:y,props:S})=>[yt((n(),c(ht,ue(S,{tile:"",hover:"",class:["panel-item",{unavailable:!a.isAvailable}],onClick:$,onContextmenu:R(k,["right","prevent"])}),{default:d(()=>[a.showCheckboxes?(n(),c(bt,{key:0,"model-value":a.showCheckboxes,contained:"",scrim:a.isSelected?a.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:d(()=>[b(Le,{class:"panel-item-checkbox",ripple:!1,"model-value":a.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):p("",!0),b(De,{item:a.isAvailable?a.item:void 0,style:{height:"auto"}},null,8,["item"]),b(wt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:d(()=>[b(kt,null,{default:d(()=>[a.item.media_type==v(T).FOLDER?(n(),w("span",ia,[K("span",null,f(v(Te)(a.item,a.$t)),1)])):(n(),w("span",{key:1,class:D({"is-playing":a.isPlaying})},f(a.item.name),3)),"version"in a.item&&a.item.version?(n(),w("span",{key:2,class:D({"is-playing":a.isPlaying})}," - "+f(a.item.version),3)):p("",!0)]),_:1}),"artists"in a.item&&a.item.artists?(n(),c(X,{key:0,class:"line-clamp-1"},{default:d(()=>[I(f(v(W)(a.item.artists,1)),1)]),_:1})):p("",!0),"authors"in a.item&&a.item.authors?(n(),c(X,{key:1,class:"line-clamp-1"},{default:d(()=>[I(f(a.item.authors.join(" / ")),1)]),_:1})):"publisher"in a.item&&a.item.publisher?(n(),c(X,{key:2,class:"line-clamp-1"},{default:d(()=>[I(f(a.item.publisher),1)]),_:1})):"owner"in a.item&&a.item.owner?(n(),c(X,{key:3,class:"line-clamp-1"},{default:d(()=>[I(f(a.item.owner),1)]),_:1})):a.showMediaType?(n(),c(X,{key:4,class:"line-clamp-1"},{default:d(()=>[I(f(a.$t(a.item.media_type)),1)]),_:1})):(n(),c(X,{key:5,class:"line-clamp-1"}))]),_:1}),a.isPlaying&&!a.showActions?(n(),c(re,{key:1,"icon-style":"position: absolute; right: 5px; bottom: 5px","show-badge":!1})):p("",!0),(y||v(_).isTouchscreen)&&a.isAvailable&&a.item.is_playable?(n(),c(q,{key:2,icon:"mdi-play",color:"primary",fab:"",style:Ae(`position: absolute; right: 15px; bottom: ${a.showActions?90:35}px; opacity: 0.8`),onClick:R(F,["stop"])},null,8,["style"])):p("",!0),a.showActions?(n(),c(gt,{key:3,class:"panel-item-actions"},{default:d(()=>[b(Ee,{style:{padding:"0"}},{default:d(()=>[v(Fe)(a.item.metadata.explicit||!1)?(n(),c(M,{key:0},{default:d(()=>[b(L,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):p("",!0),g.value?(n(),c(M,{key:1},{default:d(()=>[b(L,{class:D(a.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:d(()=>[K("img",{src:v(Ce),width:"30"},null,8,la),b(ne,{activator:"parent",location:"bottom"},{default:d(()=>[I(f(g.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):p("",!0),a.showTrackNumber&&"track_number"in a.item&&a.item.track_number?(n(),c(M,{key:2},{default:d(()=>[b(L,{size:"small",icon:"mdi-music-circle-outline"}),a.item.disc_number?(n(),w("span",oa,f(a.item.disc_number)+"/",1)):p("",!0),I(f(a.item.track_number),1)]),_:1})):"position"in a.item&&a.item.position?(n(),c(M,{key:3},{default:d(()=>[b(L,{size:"small",icon:"mdi-music-circle-outline"}),I(" "+f(a.item.position),1)]),_:1})):p("",!0),v(j)("bp3")?(n(),c(M,{key:4},{default:d(()=>[b(Re,{item:a.item},null,8,["item"])]),_:1})):p("",!0)]),_:1}),a.isPlaying?(n(),c(re,{key:0,"show-badge":!1})):p("",!0),b(Pt),y||a.$vuetify.display.mobile?(n(),c(Oe,{key:1,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:R(k,["stop"])})):p("",!0)]),_:2},1024)):p("",!0)]),_:2},1040,["class"])),[[t,k]])]),_:1})}}}),na=de(sa,[["__scopeId","data-v-1af48cf7"]]),ra={key:0},ua={key:2},ma=J({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(se.providers).length>1},showAlbum:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1},onTitleClick:{type:Function,default:void 0}},setup(A){const i=A,h=Ct(),{t:g}=$e(),o=C({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),k=C("list"),$=C(!1),F=C(!1),a=C([]),B=C([]),t=C(!1),y=C([]),S=C(!1),O=C(!1),Y=C(!0),E=C(!1),G=C(!1),Q=C(!1),ce=function(){o.value.search="",$.value=!1},Z=function(){be(()=>{var e;(e=document.getElementById("searchInput"))==null||e.focus()})},Ke=function(){$.value?ce():($.value=!0,Z())},x=function(){if(i.onTitleClick){i.onTitleClick();return}Y.value=!Y.value;const e=`${i.path}.${i.itemtype}`;localStorage.setItem(`expand.${e}`,Y.value.toString())},ee=function(e){k.value=e;const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`viewMode.${s}`,e)},Ne=function(){o.value.favoritesOnly=!o.value.favoritesOnly;const e=o.value.favoritesOnly?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`favoriteFilter.${s}`,e),P(void 0,void 0,!0)},Ye=function(){o.value.libraryOnly=!o.value.libraryOnly;const e=o.value.libraryOnly?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`libraryFilter.${s}`,e),P(!0,void 0,!0)},Xe=function(){o.value.albumArtistsFilter=!o.value.albumArtistsFilter;const e=o.value.albumArtistsFilter?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`albumArtistsFilter.${s}`,e),P(void 0,void 0,!0)},te=function(e){return y.value.includes(e)},ae=function(e,s){var u;const l=(u=_.curQueueItem)==null?void 0:u.media_item;if(!l)return!1;switch(s){case"tracks":return e.item_id===l.item_id;case"albums":return e.item_id===l.album.item_id;case"artists":return Array.isArray(l.artists)&&l.artists.some(r=>r.item_id===e.item_id);default:return!1}},ie=function(e,s){if(s)y.value.includes(e)||y.value.push(e);else for(let l=0;l<y.value.length;l++)y.value[l]===e&&y.value.splice(l,1)},ze=function(){O.value&&(y.value=[]),O.value=!O.value},Ge=function(){P(!0,!0)},He=function(){o.value.search="",$.value=!1,P(void 0,void 0,!0)},Ue=function(e){e!==void 0&&(o.value.sortBy=e);const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`sortBy.${s}`,o.value.sortBy),P(void 0,void 0,!0)},je=function(e){var l,u;(l=o.value.albumType)!=null&&l.includes(e)?o.value.albumType=(u=o.value.albumType)==null?void 0:u.filter(r=>r!==e):(o.value.albumType=o.value.albumType||[],o.value.albumType.push(e));const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`albumType.${s}`,o.value.albumType.join(",")),P(void 0,void 0,!0)},We=function(){_.globalSearchTerm=o.value.search,i.itemtype=="artists"?_.globalSearchType=T.ARTIST:i.itemtype=="albums"?_.globalSearchType=T.ALBUM:i.itemtype=="tracks"?_.globalSearchType=T.TRACK:i.itemtype=="playlists"?_.globalSearchType=T.PLAYLIST:i.itemtype=="audiobooks"?_.globalSearchType=T.AUDIOBOOK:i.itemtype=="podcasts"?_.globalSearchType=T.PODCAST:i.itemtype=="radios"&&(_.globalSearchType=T.RADIO),h.push({name:"search"})},pe=async function({done:e}){if(E.value){e("empty");return}await P(void 0,void 0,void 0,o.value.offset+i.limit),e("ok")},qe=async function(){for(;!E.value;)await pe({done:function(){}})},fe=U(()=>{var e=!1;return o.value.search&&o.value.search.length!==0&&(e=!0),e}),ve=U(()=>$.value&&Y.value);It(()=>{ve.value||(F.value=!1)});const Je=U(()=>{var s,l;if(i.allowCollapse===!0&&!Y.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:x,overflowAllowed:!1}];const e=[];return i.showSelectButton!==!1&&(O.value&&e.push({label:"tooltip.select_all",icon:"mdi-select-all",action:he}),e.push({label:"tooltip.select_items",icon:O.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:ze,active:O.value})),i.showLibraryOnlyFilter===!0&&e.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Ye,active:o.value.libraryOnly}),i.showFavoritesOnlyFilter===!0&&e.push({label:"tooltip.filter_favorites",icon:o.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:Ne,active:o.value.favoritesOnly}),i.showAlbumArtistsOnlyFilter===!0&&e.push({label:"tooltip.album_artist_filter",icon:o.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:Xe,active:o.value.albumArtistsFilter}),i.showAlbumTypeFilter&&e.push({label:"tooltip.album_type",icon:"mdi-album",disabled:t.value,subItems:["album","single","ep","compilation","unknown"].map(u=>{var r;return{label:`album_type.${u}`,selected:(r=o.value.albumType)==null?void 0:r.includes(u),action:()=>{je(u)}}})}),(i.showRefreshButton!==!1||S.value)&&e.push({label:S.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Ge,active:S.value,disabled:t.value}),(s=i.sortKeys)!=null&&s.length&&e.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:i.sortKeys.length<=1||t.value,subItems:i.sortKeys.map(u=>({label:`sort.${u}`,selected:o.value.sortBy==u,action:()=>{Ue(u)}}))}),i.showSearchButton!==!1&&e.push({label:fe.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Ke,active:fe.value,disabled:t.value}),e.push({label:"tooltip.toggle_view_mode",icon:k.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:k.value=="list",action:()=>{ee("list")}},{label:"view.panel",icon:"mdi-grid",selected:k.value=="panel",action:()=>{ee("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:k.value=="panel_compact",action:()=>{ee("panel_compact")}}]}),(l=i.extraMenuItems)!=null&&l.length&&e.push(...i.extraMenuItems),i.allowCollapse===!0&&e.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:x}),e}),P=async function(e=!1,s=!1,l=!1,u=0){if(!t.value){if(t.value=!0,l&&i.loadPagedData!=null&&(e=!0),(e||s)&&(u=0,E.value&&(Q.value=!0),E.value=!1,G.value=!1,S.value=!1),o.value.offset=u,o.value.limit=i.limit,o.value.refresh=s,i.loadPagedData!=null){const r=await i.loadPagedData(o.value);o.value.offset?a.value.push(...r):a.value=r,Math.abs(r.length-i.limit)>10&&(E.value=!0)}else if(i.loadItems!=null){(!G.value||s)&&(B.value=await i.loadItems(o.value),G.value=!0);const r=Ze(B.value,o.value);o.value.offset?a.value.push(...r):a.value=r,E.value=r.length<i.limit}o.value.refresh=!1,t.value=!1,Q.value=!1}},Qe=async function(){const e=`${i.path}.${i.itemtype}`,s=localStorage.getItem(`viewMode.${e}`);s&&s!=="null"?k.value=s:i.itemtype=="artists"||i.itemtype=="albums"?k.value="panel":k.value="list";const l=localStorage.getItem(`sortBy.${e}`);if(l&&l!=="null"&&i.sortKeys.includes(l)?o.value.sortBy=l:o.value.sortBy=i.sortKeys[0],i.showFavoritesOnlyFilter!==!1){const u=localStorage.getItem(`favoriteFilter.${e}`);u&&u=="true"&&(o.value.favoritesOnly=!0)}if(i.showLibraryOnlyFilter!==!1){const u=localStorage.getItem(`libraryFilter.${e}`);u&&u=="true"&&(o.value.libraryOnly=!0)}if(i.showAlbumArtistsOnlyFilter!==!1){const u=localStorage.getItem(`albumArtistsFilter.${e}`);u&&(o.value.albumArtistsFilter=u=="true")}if(i.allowCollapse!==!1){const u=localStorage.getItem(`expand.${e}`);u&&(Y.value=u=="true")}if(i.showAlbumTypeFilter===!0){const u=localStorage.getItem(`albumType.${e}`);u&&(o.value.albumType=u.split(","))}if(i.restoreState){let u=`search.${e}`;i.parentItem&&(u+=i.parentItem.item_id);const r=localStorage.getItem(u);r&&r!=="null"&&(o.value.search=r)}},ye=function(e){_.dialogActive||t.value||(e.key==="Escape"&&ce(),!F.value&&(e.key==="a"&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),he()):!F.value&&e.key=="Backspace"?Z():!F.value&&e.key.length==1&&($.value=!0,Z())))};i.allowKeyHooks&&(document.addEventListener("keydown",ye),le(()=>{document.removeEventListener("keydown",ye)})),i.restoreState&&le(()=>{const e=i.path||i.itemtype,s=document.querySelector("#cont");_.prevState={path:e,scrollPos:(s==null?void 0:s.scrollTop)||0,pagedItems:a.value,allItems:B.value,allItemsReceived:E.value,initialDataReceived:G.value,params:o.value}}),H(()=>o.value.search,e=>{e&&($.value=!0),P(void 0,void 0,!0);let s=`search.${i.path}.${i.itemtype}`;i.parentItem&&(s+=i.parentItem.item_id),localStorage.setItem(s,o.value.search)}),H(()=>i.path,e=>{t.value!=!0&&(a.value=[],B.value=[],P(!0))}),H(()=>i.parentItem,()=>{t.value!=!0&&(B.value=[],S.value=!0)},{deep:!0}),H(()=>i.limit,e=>{o.value.limit=e}),H(()=>i.updateAvailable,e=>{t.value||(S.value=e)},{immediate:!0}),St(async()=>{var l;Qe();const e=i.path||i.itemtype;i.restoreState&&((l=_.prevState)==null?void 0:l.path)==e?(o.value=_.prevState.params,a.value=_.prevState.pagedItems,B.value=_.prevState.allItems,E.value=_.prevState.allItemsReceived,G.value=_.prevState.initialDataReceived,be(()=>{const u=document.getElementById("cont");u&&Bt(u,_.prevState.scrollPos,50)}),t.value=!1):P(!0);const s=se.subscribe_multi([z.MEDIA_ITEM_UPDATED,z.MEDIA_ITEM_DELETED,z.MEDIA_ITEM_PLAYED],u=>{if(u.event==z.MEDIA_ITEM_DELETED)a.value=a.value.filter(r=>r.uri!=u.object_id);else if(u.event==z.MEDIA_ITEM_UPDATED){const r=a.value.findIndex(m=>m.uri==u.object_id);r>=0&&(a.value[r]=u.data)}else if(u.event==z.MEDIA_ITEM_PLAYED){const r=a.value.findIndex(m=>m.uri==u.object_id);r>=0&&("fully_played"in a.value[r]&&(a.value[r].fully_played=u.data.fully_played),"resume_position_ms"in a.value[r]&&(a.value[r].resume_position_ms=u.data.seconds_played*1e3))}});le(s)});const V=function(e,s=!1){return e?"translation_key"in e&&e.translation_key&&e.name?g(e.translation_key,[e.name]):"translation_key"in e&&e.translation_key?g(e.translation_key):s&&"sort_name"in e&&e.sort_name?e.sort_name:e.name:""},Ze=function(e,s){var u;let l=[];if(s.search){const r=s.search.toLowerCase();for(const m of e)(m.name.toLowerCase().includes(r)||"album"in m&&((u=m.album)!=null&&u.name.toLowerCase().includes(r))||"artists"in m&&m.artists&&m.artists.length&&m.artists[0].name.toLowerCase().includes(r))&&l.push(m)}else l=[...e];return s.sortBy=="name"&&l.sort((r,m)=>V(r).localeCompare(V(m),void 0,{numeric:!0})),s.sortBy=="sort_name"&&l.sort((r,m)=>V(r,!0).localeCompare(V(m,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&l.sort((r,m)=>V(m).localeCompare(V(r),void 0,{numeric:!0})),s.sortBy=="sort_name_desc"&&l.sort((r,m)=>V(m,!0).localeCompare(V(r,!0),void 0,{numeric:!0})),s.sortBy=="album"&&l.sort((r,m)=>V(r.album).localeCompare(V(m.album),void 0,{numeric:!0})),s.sortBy=="artist"&&l.sort((r,m)=>V(r.artists[0]).localeCompare(V(m.artists[0]))),s.sortBy=="track_number"&&(l.sort((r,m)=>(r.track_number||0)-(m.track_number||0)),l.sort((r,m)=>(r.disc_number||0)-(m.disc_number||0))),s.sortBy=="position"&&l.sort((r,m)=>(r.position||0)-(m.position||0)),s.sortBy=="position_desc"&&l.sort((r,m)=>(m.position||0)-(r.position||0)),s.sortBy=="year"&&l.sort((r,m)=>(r.year||0)-(m.year||0)),s.sortBy=="year_desc"&&l.sort((r,m)=>(m.year||0)-(r.year||0)),s.sortBy=="recent"&&l.sort((r,m)=>(m.timestamp_added||0)-(r.timestamp_added||0)),s.sortBy=="duration"&&l.sort((r,m)=>(r.duration||0)-(m.duration||0)),s.sortBy=="duration_desc"&&l.sort((r,m)=>(m.duration||0)-(r.duration||0)),s.sortBy=="provider"&&l.sort((r,m)=>r.provider.localeCompare(m.provider)),s.favoritesOnly&&(l=l.filter(r=>r.favorite)),s.albumType&&s.albumType.length>0&&(l=l.filter(r=>{var m;return(m=s.albumType)==null?void 0:m.includes(r.album_type)})),l.slice(s.offset,s.offset+s.limit)},he=async function(){let e=!0;(i.total||B.value.length)>250&&(e=await new Promise(l=>{confirm(g("select_all_confirmation"))?l(!0):l(!1)})),e&&(await qe(),y.value=a.value,O.value=!0)};return(e,s)=>e.hideOnEmpty&&a.value.length==0?p("",!0):(n(),w("section",ra,[b(et,{icon:e.icon,title:e.title,count:o.value.search?a.value.length:e.total||B.value.length,color:"transparent","menu-items":Je.value,onTitleClicked:x},{title:d(()=>[At(e.$slots,"title",{},()=>[I(f(e.title),1)],!0)]),_:3},8,["icon","title","count","menu-items"]),b(_t),ve.value?(n(),c(Dt,{key:0,id:"searchInput",modelValue:o.value.search,"onUpdate:modelValue":s[0]||(s[0]=l=>o.value.search=l),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=l=>F.value=!0),onBlur:s[2]||(s[2]=l=>F.value=!1),"onClick:clear":He},null,8,["modelValue","label"])):p("",!0),Y.value?(n(),c(xe,{key:1,variant:k.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:d(()=>[t.value?(n(),c($t,{key:0,color:"accent",height:"4",indeterminate:"",rounded:""})):p("",!0),!Q.value&&!(a.value.length==0&&E.value)?(n(),c(Ot,{key:1,onLoad:pe,mode:e.infiniteScroll?"intersect":"manual","load-more-text":e.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:d(()=>[k.value=="panel"?(n(),c(Ie,{key:0},{default:d(()=>[(n(!0),w(ke,null,we(a.value,l=>(n(),c(Se,{key:l.uri,cols:"12",class:D(`col-${v(ge)(e.$vuetify.display.width)}`)},{default:d(()=>[b(na,{item:l,"is-selected":te(l),"show-checkboxes":O.value,"show-actions":["tracks","albums","albumtracks"].includes(e.itemtype),"show-track-number":e.showTrackNumber,"is-available":v(oe)(l),"is-playing":ae(l,e.itemtype),"parent-item":e.parentItem,onSelect:ie},null,8,["item","is-selected","show-checkboxes","show-actions","show-track-number","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),k.value=="panel_compact"?(n(),c(Ie,{key:1},{default:d(()=>[(n(!0),w(ke,null,we(a.value,l=>(n(),c(Se,{key:l.uri,cols:"12",class:D(`col-${v(ge)(e.$vuetify.display.width)}`)},{default:d(()=>[b(Vt,{item:l,"is-selected":te(l),"show-checkboxes":O.value,"is-available":v(oe)(l),"is-playing":ae(l,e.itemtype),"parent-item":e.parentItem,onSelect:ie},null,8,["item","is-selected","show-checkboxes","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),k.value=="list"?(n(),c(Mt,{key:2,"item-height":70,height:"100%",items:a.value,style:{height:"100%",overflow:"hidden"}},{default:d(({item:l})=>[b(aa,{item:l,"show-track-number":e.showTrackNumber,"show-disc-number":e.showTrackNumber,"show-duration":e.showDuration,"show-favorite":e.showFavoritesOnlyFilter,"show-menu":l.is_playable,"show-provider":e.showProvider,"show-album":e.showAlbum,"show-checkboxes":O.value,"is-selected":te(l),"is-available":v(oe)(l),"is-playing":ae(l,e.itemtype),"show-details":e.itemtype.includes("versions"),"parent-item":e.parentItem,onSelect:ie},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","is-playing","show-details","parent-item"])]),_:1},8,["items"])):p("",!0)]),_:1},8,["mode","load-more-text"])):p("",!0),!t.value&&a.value.length==0?(n(),w("div",ua,[!t.value&&a.value.length==0&&(o.value.search||o.value.favoritesOnly)?(n(),c(Be,{key:0,title:e.$t("no_content_filter")},{default:d(()=>[o.value.search?(n(),c(q,{key:0,style:{"margin-top":"15px"},onClick:We},{default:d(()=>[I(f(e.$t("try_global_search")),1)]),_:1})):p("",!0)]),_:1},8,["title"])):!t.value&&a.value.length==0?(n(),c(Be,{key:1},{default:d(()=>[I(f(e.$t("no_content")),1)]),_:1})):p("",!0)])):p("",!0),b(Lt,{"model-value":y.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:d(()=>[b(q,{color:"primary",variant:"text",onClick:s[3]||(s[3]=l=>v(me)(y.value,l.clientX,l.clientY,e.parentItem))},{default:d(()=>[I(f(e.$t("actions")),1)]),_:1})]),default:d(()=>[K("span",null,f(e.$t("items_selected",[y.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):p("",!0)]))}}),$a=de(ma,[["__scopeId","data-v-21377084"]]);export{$a as I};
