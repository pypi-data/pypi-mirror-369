{
    "connection": {
        "type": {
            "displayName": "IBM Security Verify",
            "group": "verify",
            "type": "connectorType"
        },
        "host": {
            "type": "text",
            "regex": "^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9_:/\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9_:/\\-]*[A-Za-z0-9])$"
        },
        "port": {
            "type": "number",
            "default": 443,
            "min": 1,
            "max": 65535
        },
        "help": {
            "type": "link",
            "default": "data-sources.html"
        },
        "selfSignedCert": {
            "type": "password",
            "optional": true
        },
        "options": {
            "type": "fields",
            "async_call": {
                "type": "text",
                "hidden": true,
                "optional": true
            },
            "result_limit": {
                "default": 10000,
                "min": 1,
                "max": 10000000,
                "type": "number",
                "previous": "connection.resultSizeLimit"
            },
            "batch_size": {
                "default": 2000,
                "min": 1,
                "max": 10000,
                "type": "number",
                "optional": true,
                "hidden": true
            },
            "time_range": {
                "default": 5,
                "min": 1,
                "max": 10000,
                "type": "number",
                "previous": "connection.timerange",
                "nullable": true
            },
            "timeout": {
                "default": 30,
                "min": 1,
                "max": 3600,
                "hidden": true,
                "type": "number",
                "previous": "connection.timeoutLimit"
            },
            "dialects": {
                "type": "array",
                "hidden": true,
                "optional": true
            },
            "language": {
                "type": "string",
                "default": "stix",
                "optional": true,
                "hidden": true
            },
            "validate_pattern": {
                "type": "boolean",
                "optional": true,
                "hidden": true,
                "previous": "connection.validate_pattern"
            },
            "stix_validator": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true,
                "previous": "connection.stix_validator"
            },
            "mapping": {
                "type": "json",
                "optional": true,
                "previous": "connection.mapping",
                "default": {
                    "from_stix_map": {
                        "user-account": {
                            "fields": {
                                "user_id": [
                                    "data.userid"
                                ],
                                "account_login": [
                                    "data.username"
                                ],
                                "account_type": [
                                    "data.sourcetype"
                                ]
                            }
                        },
                        "ipv4-addr": {
                            "fields": {
                                "value": [
                                    "data.origin"
                                ]
                            }
                        },
                        "domain-name": {
                            "fields": {
                                "type": [
                                    "domain-name"
                                ],
                                "value": [
                                    "tenantname"
                                ]
                            }
                        },
                        "x-oca-event": {
                            "fields": {
                                "action": [
                                    "data.action"
                                ],
                                "category": [
                                    "event_type"
                                ],
                                "module": [
                                    "servicename"
                                ],
                                "outcome": [
                                    "data.result"
                                ],
                                "agent": [
                                    "data.sourcetype"
                                ],
                                "ip_refs[*].value": [
                                    "ip"
                                ],
                                "domain_ref.value": [
                                    "tenantname"
                                ],
                                "user_ref": [
                                    "username"
                                ],
                                "provider": "'IBM Security Verify Event'",
                                "extensions.'x-iam-ext'.subcategory": [
                                    "data.subtype"
                                ],
                                "extensions.'x-iam-ext'.realm": [
                                    "data.realm"
                                ],
                                "extensions.'x-iam-ext'.browser_agent": [
                                    "data.devicetype"
                                ],
                                "extensions.'x-iam-ext'.provider_id": [
                                    "data.providerid"
                                ],
                                "extensions.'x-iam-ext'.application_id": [
                                    "data.applicationid"
                                ],
                                "extensions.'x-iam-ext'.application_type": [
                                    "data.applicationtype"
                                ],
                                "extensions.'x-iam-ext'.application_name": [
                                    "data.applicationname"
                                ],
                                "extensions.'x-iam-ext'.cause": [
                                    "data.cause"
                                ],
                                "extensions.'x-iam-ext'.target": [
                                    "data.target"
                                ],
                                "extensions.'x-iam-ext'.performedby_clientname": [
                                    "data.performedby_clientname"
                                ],
                                "extensions.'x-iam-ext'.performedby_realm": [
                                    "data.performedby_realm"
                                ],
                                "extensions.'x-iam-ext'.performedby_username": [
                                    "data.performedby_username"
                                ],
                                "extensions.'x-iam-ext'.targetid": [
                                    "data.targetid"
                                ],
                                "extensions.'x-iam-ext'.targetid_realm": [
                                    "data.targetid_realm"
                                ],
                                "extensions.'x-iam-ext'.targetid_username": [
                                    "data.targetid_username"
                                ],
                                "extensions.'x-iam-ext'.continent_name": [
                                    "geoip.continent_name"
                                ],
                                "extensions.'x-iam-ext'.country_iso_code": [
                                    "geoip.country_iso_code"
                                ],
                                "extensions.'x-iam-ext'.country_name": [
                                    "geoip.country_name"
                                ],
                                "extensions.'x-iam-ext'.city_name": [
                                    "geoip.city_name"
                                ],
                                "extensions.'x-iam-ext'.policy_action": [
                                    "data.policy_action"
                                ],
                                "extensions.'x-iam-ext'.policy_name": [
                                    "data.policy_name"
                                ],
                                "extensions.'x-iam-ext'.rule_name": [
                                    "data.rule_name"
                                ],
                                "extensions.'x-iam-ext'.decision_reason": [
                                    "data.decision_reason"
                                ],
                                "extensions.'x-iam-ext'.risk_level": [
                                    "data.risk_level"
                                ],
                                "extensions.'x-iam-ext'.risk_score": [
                                    "data.risk_score"
                                ],
                                "extensions.'x-iam-ext'.deviceid": [
                                    "data.deviceid"
                                ],
                                "extensions.'x-iam-ext'.is_device_compliant": [
                                    "data.mdmiscompliant"
                                ],
                                "extensions.'x-iam-ext'.is_device_managed": [
                                    "data.mdmismanaged"
                                ],
                                "extensions.'x-iam-ext'.mdm_customerid": [
                                    "data.billingid"
                                ]
                            }
                        }
                    },
                    "operators": {
                        "ComparisonExpressionOperators.And": "&",
                        "ComparisonComparators.Equal": "=",
                        "ObservationOperators.And": "=",
                        "ComparisonComparators.In": "="
                    },
                    "to_stix_map": {
                        "username": [
                            {
                                "key": "user-account.account_login",
                                "object": "useraccount"
                            },
                            {
                                "key": "x-oca-event.user_ref",
                                "object": "ocaevent",
                                "references": "useraccount"
                            }
                        ],
                        "userid": [
                            {
                                "key": "user-account.user_id",
                                "object": "useraccount"
                            }
                        ],
                        "sourcetype": [
                            {
                                "key": "x-oca-event.agent",
                                "object": "ocaevent"
                            },
                            {
                                "key": "user-account.account_type",
                                "object": "useraccount"
                            }
                        ],
                        "servicename": {
                            "key": "x-oca-event.module",
                            "object": "ocaevent"
                        },
                        "ip": [
                            {
                                "key": "ipv4-addr.value",
                                "object": "ipdata"
                            },
                            {
                                "key": "x-oca-event.ip_refs",
                                "object": "ocaevent",
                                "references": [
                                    "ipdata"
                                ],
                                "group": true
                            }
                        ],
                        "tenantname": [
                            {
                                "key": "domain-name.value",
                                "object": "domaindata",
                                "transformer": "ToDomainName"
                            },
                            {
                                "key": "x-oca-event.domain_ref",
                                "object": "ocaevent",
                                "references": "domaindata"
                            }
                        ],
                        "result": [
                            {
                                "object": "ocaevent",
                                "key": "x-oca-event.outcome"
                            }
                        ],
                        "subtype": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.subcategory"
                        },
                        "cause": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.cause"
                        },
                        "action": [
                            {
                                "key": "x-oca-event.action",
                                "object": "ocaevent"
                            }
                        ],
                        "realm": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.realm"
                        },
                        "devicetype": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.browser_agent"
                        },
                        "applicationid": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.application_id"
                        },
                        "applicationtype": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.application_type"
                        },
                        "applicationname": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.applicationname"
                        },
                        "target": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.target"
                        },
                        "event_type": [
                            {
                                "key": "x-oca-event.category",
                                "object": "ocaevent"
                            },
                            {
                                "key": "x-oca-event.provider",
                                "object": "ocaevent",
                                "transformer": "VerifyStaticTransformer"
                            }
                        ],
                        "time": [
                            {
                                "key": "x-oca-event.created",
                                "transformer": "EpochToTimestamp",
                                "object": "ocaevent"
                            },
                            {
                                "key": "first_observed",
                                "transformer": "EpochToTimestamp"
                            },
                            {
                                "key": "last_observed",
                                "transformer": "EpochToTimestamp"
                            }
                        ],
                        "performedby_username": {
                            "key": "x-oca-event.extensions.x-iam-ext.performedby_username",
                            "object": "ocaevent"
                        },
                        "deleted": {
                            "key": "x-oca-event.extensions.x-iam-ext.deleted",
                            "object": "ocaevent"
                        },
                        "performedby_clientname": {
                            "key": "x-oca-event.extensions.x-iam-ext.performedby_clientname",
                            "object": "ocaevent"
                        },
                        "performedby_realm": {
                            "key": "x-oca-event.extensions.x-iam-ext.performedby_realm",
                            "object": "ocaevent"
                        },
                        "targetid": {
                            "key": "x-oca-event.extensions.x-iam-ext.targetid",
                            "object": "ocaevent"
                        },
                        "targetid_realm": {
                            "key": "x-oca-event.extensions.x-iam-ext.targetid_realm",
                            "object": "ocaevent"
                        },
                        "targetid_username": {
                            "key": "x-oca-event.extensions.x-iam-ext.taregetid_username",
                            "object": "ocaevent"
                        },
                        "continent_name": {
                            "key": "x-oca-event.extensions.x-iam-ext.continent_name",
                            "object": "ocaevent"
                        },
                        "city_name": {
                            "key": "x-oca-event.extensions.x-iam-ext.city_name",
                            "object": "ocaevent"
                        },
                        "country_iso_code": {
                            "key": "x-oca-event.extensions.x-iam-ext.country_iso_code",
                            "object": "ocaevent"
                        },
                        "country_name": {
                            "key": "x-oca-event.extensions.x-iam-ext.country_name",
                            "object": "ocaevent"
                        },
                        "providerid": {
                            "key": "x-oca-event.extensions.x-iam-ext.provider_id",
                            "object": "ocaevent"
                        },
                        "rule_name": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.rule_name"
                        },
                        "policy_name": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.policy_name"
                        },
                        "decision_reason": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.decision_reason"
                        },
                        "policy_action": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.policy_action"
                        },
                        "risk_level": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.risk_level"
                        },
                        "risk_score": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.risk_score"
                        },
                        "deviceid": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.deviceid"
                        },
                        "mdmiscompliant": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.is_device_compliant"
                        },
                        "mdmismanaged": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.is_device_managed"
                        },
                        "billingid": {
                            "object": "ocaevent",
                            "key": "x-oca-event.extensions.x-iam-ext.mdm_customerid"
                        },
                        "lat": {
                            "key": "x-oca-event.extensions.x-iam-ext.location_lat",
                            "object": "ocaevent"
                        },
                        "lon": {
                            "key": "x-oca-event.extensions.x-iam-ext.location_lon",
                            "object": "ocaevent"
                        },
                        "add": {
                            "key": "x-oca-event.extensions.x-iam-ext.add",
                            "object": "ocaevent"
                        }
                    }
                }
            },
            "unmapped_fallback": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true
            },
            "stix_2.1": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true
            }
        }
    },
    "configuration": {
        "auth": {
            "type": "fields",
            "clientId": {
                "type": "password"
            },
            "clientSecret": {
                "type": "password"
            }
        }
    }
}