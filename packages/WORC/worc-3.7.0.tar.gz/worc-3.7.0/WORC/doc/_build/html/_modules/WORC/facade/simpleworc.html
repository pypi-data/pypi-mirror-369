<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />
        <link rel="prefetch" href="../../../_static/WORC_Logo.svg" as="image" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>WORC.facade.simpleworc - WORC 3.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/extra.css?v=a591123b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">WORC 3.7.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../_static/WORC_Logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">WORC 3.7.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../static/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/quick_start.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/user_manual.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/features.html">Radiomics Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/additionalfunctionality.html">Additional functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/developerdocumentation.html">Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/developerdocumentation.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../static/changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../autogen/WORC.html">WORC Package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of WORC Package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.IOparser.html">IOparser Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.classification.html">classification Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.detectors.html">detectors Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.exampledata.html">exampledata Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.export.html">export Package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../autogen/WORC.facade.html">facade Package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of facade Package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../autogen/WORC.facade.helpers.html">helpers Package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.fastrconfig.html">fastrconfig Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.featureprocessing.html">featureprocessing Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.plotting.html">plotting Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.processing.html">processing Package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../autogen/WORC.resources.html">resources Package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of resources Package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../autogen/WORC.resources.fastr_tests.html">fastr_tests Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autogen/WORC.resources.fastr_tools.html">fastr_tools Package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.statistics.html">statistics Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.tests.html">tests Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.tools.html">tools Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autogen/WORC.validators.html">validators Package</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for WORC.facade.simpleworc</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># Copyright 2016-2023 Biomedical Imaging Group Rotterdam, Departments of</span>
<span class="c1"># Medical Informatics and Radiology, Erasmus MC, Rotterdam, The Netherlands</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">fastr.exceptions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">WORC</span><span class="w"> </span><span class="kn">import</span> <span class="n">WORC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.helpers.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_radiomix_features</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.helpers.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">PathNotFoundException</span><span class="p">,</span> <span class="n">NoImagesFoundException</span><span class="p">,</span> \
    <span class="n">NoSegmentationsFoundException</span><span class="p">,</span> <span class="n">InvalidCsvFileException</span><span class="p">,</span> \
    <span class="n">NoFeaturesFoundException</span><span class="p">,</span> <span class="n">NoMasksFoundException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">WORC.addexceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">WORCKeyError</span><span class="p">,</span> <span class="n">WORCValueError</span><span class="p">,</span> <span class="n">WORCAssertionError</span><span class="p">,</span> \
    <span class="n">WORCIOError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.helpers.configbuilder</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConfigBuilder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">WORC.detectors.detectors</span><span class="w"> </span><span class="kn">import</span> <span class="n">CsvDetector</span><span class="p">,</span> <span class="n">BigrClusterDetector</span><span class="p">,</span> \
    <span class="n">SnelliusClusterDetector</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">WORC.validators.preflightcheck</span><span class="w"> </span><span class="kn">import</span> <span class="n">ValidatorsFactory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">WORC.tools.fingerprinting</span><span class="w"> </span><span class="kn">import</span> <span class="n">quantitative_modalities</span><span class="p">,</span> <span class="n">qualitative_modalities</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_for_all_methods</span><span class="p">(</span><span class="n">decorator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Methods to attach an object to all methods.&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">decorate</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>  <span class="c1"># there&#39;s propably a better way to do this</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">attr</span><span class="p">)):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">decorator</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">attr</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">cls</span>

    <span class="k">return</span> <span class="n">decorate</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_error_bulldozer</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether raised errors are known or should never occur.&quot;&quot;&quot;</span>
    <span class="n">_valid_exceptions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">PathNotFoundException</span><span class="p">,</span> <span class="n">NoImagesFoundException</span><span class="p">,</span>
        <span class="n">NoSegmentationsFoundException</span><span class="p">,</span> <span class="n">InvalidCsvFileException</span><span class="p">,</span>
        <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="ne">NotImplementedError</span><span class="p">,</span> <span class="n">WORCKeyError</span><span class="p">,</span>
        <span class="n">WORCIOError</span><span class="p">,</span>
        <span class="n">WORCValueError</span><span class="p">,</span> <span class="n">WORCAssertionError</span><span class="p">,</span> <span class="n">NoMasksFoundException</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">_valid_exceptions</span> <span class="o">+=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">fastr</span><span class="o">.</span><span class="n">exceptions</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">)]</span>

    <span class="n">unexpected_exception_exception</span> <span class="o">=</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;An unexpected error has occured, which we have not catched in WORC. Double check your code or make an issue on the WORC github so that we can fix this issue. Please report the actual error raised in your report.&#39;</span><span class="p">)</span>

    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dec</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_valid_exceptions</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">unexpected_exception_exception</span>
            <span class="k">raise</span> <span class="n">e</span>
    <span class="k">return</span> <span class="n">dec</span>


<div class="viewcode-block" id="SimpleWORC">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC">[docs]</a>
<span class="nd">@_for_all_methods</span><span class="p">(</span><span class="n">_error_bulldozer</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SimpleWORC</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Facade around the main WORC object for simple interaction.</span>

<span class="sd">    Please also see the `WORCTutorial Github &lt;https://github.com/MStarmans91/WORCTutorial/&gt;`_.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SimpleWORC.__init__">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;WORC&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize SimpleWORC object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        name: string, default WORC</span>
<span class="sd">            String to identify name of experiments. Will be used in the temporary files and outputs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set some config values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span> <span class="o">=</span> <span class="n">WORC</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_images_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_images_test</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_features_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_features_test</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_segmentations_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_segmentations_test</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_masks_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_masks_test</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elastix_parameter_file</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantics_file_train</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantics_file_test</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radiomix_feature_file</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_labels_file_train</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels_file_test</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_image_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fixed_splits</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trained_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_files</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_config_builder</span> <span class="o">=</span> <span class="n">ConfigBuilder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_evaluation</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buildtype</span> <span class="o">=</span> <span class="s1">&#39;training&#39;</span>

        <span class="c1"># Detect wether we are on a cluster</span>
        <span class="k">if</span> <span class="n">BigrClusterDetector</span><span class="p">()</span><span class="o">.</span><span class="n">do_detection</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">fastr_plugin</span> <span class="o">=</span> <span class="s1">&#39;DRMAAExecution&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_config_overrides</span><span class="p">({</span><span class="s1">&#39;Classification&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fastr_plugin&#39;</span><span class="p">:</span> <span class="s1">&#39;DRMAAExecution&#39;</span><span class="p">}})</span>
        <span class="k">elif</span> <span class="n">SnelliusClusterDetector</span><span class="p">()</span><span class="o">.</span><span class="n">do_detection</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">fastr_plugin</span> <span class="o">=</span> <span class="s1">&#39;ProcessPoolExecution&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_config_overrides</span><span class="p">({</span><span class="s1">&#39;Classification&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fastr_plugin&#39;</span><span class="p">:</span> <span class="s1">&#39;ProcessPoolExecution&#39;</span><span class="p">}})</span></div>


<div class="viewcode-block" id="SimpleWORC.set_fixed_splits">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.set_fixed_splits">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_fixed_splits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fixed_splits_csv</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Provide CSV with fixed splits for cross-validation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fixed_splits_csv: string</span>
<span class="sd">            Path of CSV file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">fixed_splits_csv</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">fixed_splits_csv</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fixed_splits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARN: set_fixed_splits already set. Please check your script to make sure this is ok!&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fixed_splits</span> <span class="o">=</span> <span class="n">fixed_splits_csv</span></div>


<div class="viewcode-block" id="SimpleWORC.set_image_types">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.set_image_types">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_image_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_types</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the type of images to be processed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_types: list of strings</span>
<span class="sd">            Names of types of images that are provided to WORC.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_valid_modalities</span> <span class="o">=</span> <span class="n">quantitative_modalities</span> <span class="o">+</span> <span class="n">qualitative_modalities</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">imt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_valid_modalities</span> <span class="k">for</span> <span class="n">imt</span> <span class="ow">in</span> <span class="n">image_types</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;One of your image types </span><span class="si">{</span><span class="n">image_types</span><span class="si">}</span><span class="s1"> is not one of the valid image types </span><span class="si">{</span><span class="n">quantitative_modalities</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">qualitative_modalities</span><span class="si">}</span><span class="s1">. This is mandatory to set when performing fingerprinting, see the WORC Documentation (https://worc.readthedocs.io/en/latest/static/configuration.html#imagefeatures).&#39;</span>
            <span class="k">raise</span> <span class="n">WORCValueError</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_image_types</span> <span class="o">=</span> <span class="n">image_types</span></div>


<div class="viewcode-block" id="SimpleWORC.features_from_this_directory">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.features_from_this_directory">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">features_from_this_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span>
                                     <span class="n">feature_file_name</span><span class="o">=</span><span class="s1">&#39;features.hdf5&#39;</span><span class="p">,</span>
                                     <span class="n">glob</span><span class="o">=</span><span class="s1">&#39;*/&#39;</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use features from a directory as sources in WORC.</span>

<span class="sd">        SimpleWORC uses a directory glob to look for files meeting</span>
<span class="sd">        the requirements to include, based on the input parameters.</span>

<span class="sd">        Example:</span>
<span class="sd">        When using &quot;directory = C:\\Users\\MyName\\FeatureFolder&quot;,</span>
<span class="sd">        features_from_this_directory will include all features.hdf5 files from all subfolders in the directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        directory: string</span>
<span class="sd">            Identifies the root directory in which to search for feature files.</span>
<span class="sd">        feature_file_name: string, default features.hdf5</span>
<span class="sd">            Name of the files which will be included. Can include wildcards (*).</span>
<span class="sd">        glob: string, default */</span>
<span class="sd">            Identify the search string to be used in the glob. Can include wildcards (*).</span>
<span class="sd">        is_training: Boolean, default True</span>
<span class="sd">            Identify whether these features should be used in the training or test dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

        <span class="n">features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">directory</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">glob</span><span class="si">}{</span><span class="n">feature_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoFeaturesFoundException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">directory</span><span class="si">}{</span><span class="n">glob</span><span class="si">}{</span><span class="n">feature_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">features_per_subject</span> <span class="o">=</span> <span class="p">{</span><span class="n">feature</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">feature</span><span class="o">.</span><span class="n">as_uri</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">is_training</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_features_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">features_per_subject</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_features_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">features_per_subject</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.images_from_this_directory">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.images_from_this_directory">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">images_from_this_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">image_file_name</span><span class="o">=</span><span class="s1">&#39;image.nii.gz&#39;</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="s1">&#39;*/&#39;</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use images from a directory as sources in WORC.</span>

<span class="sd">        SimpleWORC uses a directory glob to look for files meeting</span>
<span class="sd">        the requirements to include, based on the input parameters.</span>

<span class="sd">        Example:</span>
<span class="sd">        When using &quot;directory = C:\\Users\\MyName\\ImageFolder&quot;,</span>
<span class="sd">        images_from_this_directory will include all image.nii.gz files from all subfolders in the directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        directory: string</span>
<span class="sd">            Identifies the root directory in which to search for image files.</span>
<span class="sd">        image_file_name: string, default image.nii.gz</span>
<span class="sd">            Name of the files which will be included. Can include wildcards (*).</span>
<span class="sd">        glob: string, default */</span>
<span class="sd">            Identify the search string to be used in the glob. Can include wildcards (*).</span>
<span class="sd">        is_training: Boolean, default True</span>
<span class="sd">            Identify whether these images should be used in the training or test dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

        <span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">directory</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">glob</span><span class="si">}{</span><span class="n">image_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoImagesFoundException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">directory</span><span class="si">}{</span><span class="n">glob</span><span class="si">}{</span><span class="n">image_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">images_per_subject</span> <span class="o">=</span> <span class="p">{</span><span class="n">image</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">as_uri</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">is_training</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_images_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">images_per_subject</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_images_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">images_per_subject</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.segmentations_from_this_directory">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.segmentations_from_this_directory">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">segmentations_from_this_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">segmentation_file_name</span><span class="o">=</span><span class="s1">&#39;segmentation.nii.gz&#39;</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="s1">&#39;*/&#39;</span><span class="p">,</span>
                                          <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use segmentations from a directory as sources in WORC.</span>

<span class="sd">        Segmentations define the region of interest from which the features</span>
<span class="sd">        are extracted.</span>

<span class="sd">         SimpleWORC uses a directory glob to look for files meeting</span>
<span class="sd">         the requirements to include, based on the input parameters.</span>

<span class="sd">         Example:</span>
<span class="sd">         When using &quot;directory = C:\\Users\\MyName\\SegmentationFolder&quot;,</span>
<span class="sd">         segmentations_from_this_directory will include all segmentation.nii.gz files from all subfolders in the directory.</span>

<span class="sd">         Parameters</span>
<span class="sd">         ----------</span>
<span class="sd">         directory: string</span>
<span class="sd">             Identifies the root directory in which to search for segmentation files.</span>
<span class="sd">         segmentation_file_name: string, default segmentation.nii.gz</span>
<span class="sd">             Name of the files which will be included. Can include wildcards (*).</span>
<span class="sd">         glob: string, default */</span>
<span class="sd">             Identify the search string to be used in the glob. Can include wildcards (*).</span>
<span class="sd">         is_training: Boolean, default True</span>
<span class="sd">             Identify whether these segmentations should be used in the training or test dataset.</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

        <span class="n">segmentations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">directory</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">glob</span><span class="si">}{</span><span class="n">segmentation_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segmentations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoSegmentationsFoundException</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span>

        <span class="n">segmentations_per_subject</span> <span class="o">=</span> <span class="p">{</span><span class="n">segmentation</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">segmentation</span><span class="o">.</span><span class="n">as_uri</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">segmentation</span> <span class="ow">in</span> <span class="n">segmentations</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">is_training</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_segmentations_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segmentations_per_subject</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_segmentations_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segmentations_per_subject</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.masks_from_this_directory">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.masks_from_this_directory">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">masks_from_this_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span>
                                  <span class="n">mask_file_name</span><span class="o">=</span><span class="s1">&#39;mask.nii.gz&#39;</span><span class="p">,</span> <span class="n">glob</span><span class="o">=</span><span class="s1">&#39;*/&#39;</span><span class="p">,</span>
                                  <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use masks from a directory as sources in WORC.</span>

<span class="sd">        Masks are used in a variety of tools to ``mask&#39;&#39; certain parts</span>
<span class="sd">        of the image, e.g. in the normalization. Masks are fully</span>
<span class="sd">        optional.</span>

<span class="sd">        SimpleWORC uses a directory glob to look for files meeting</span>
<span class="sd">        the requirements to include, based on the input parameters.</span>

<span class="sd">        Example:</span>
<span class="sd">        When using &quot;directory = C:\\Users\\MyName\\MaskFolder&quot;,</span>
<span class="sd">        masks_from_this_directory will include all mask.nii.gz files from all subfolders in the directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        directory: string</span>
<span class="sd">             Identifies the root directory in which to search for mask files.</span>
<span class="sd">        mask_file_name: string, default mask.nii.gz</span>
<span class="sd">             Name of the files which will be included. Can include wildcards (*).</span>
<span class="sd">        glob: string, default */</span>
<span class="sd">             Identify the search string to be used in the glob. Can include wildcards (*).</span>
<span class="sd">        is_training: Boolean, default True</span>
<span class="sd">             Identify whether these masks should be used in the training or test dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

        <span class="n">masks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">directory</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">glob</span><span class="si">}{</span><span class="n">mask_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoMasksFoundException</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span>

        <span class="n">masks_per_subject</span> <span class="o">=</span> <span class="p">{</span><span class="n">mask</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">mask</span><span class="o">.</span><span class="n">as_uri</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">mask</span> <span class="ow">in</span> <span class="n">masks</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">is_training</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_masks_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">masks_per_subject</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_masks_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">masks_per_subject</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.labels_from_this_file">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.labels_from_this_file">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">labels_from_this_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Define which file should be used by WORC to extract the object labels.</span>

<span class="sd">        Should be a .csv or .txt file: see</span>
<span class="sd">        :ref:`the WORC user manual &lt;usermanual-chapter:&gt;` for more details on</span>
<span class="sd">        the formatting of this file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_path: basestring</span>
<span class="sd">            Location of the file to be used as label file. Can be a .csv or .txt file.</span>
<span class="sd">        is_training: Boolean, default True</span>
<span class="sd">            Identify whether this label file should be used in the training or test dataset.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labels_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">labels_file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">CsvDetector</span><span class="p">(</span><span class="n">labels_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="n">InvalidCsvFileException</span><span class="p">(</span><span class="n">labels_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">is_training</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels_file_train</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">labels_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels_file_test</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">labels_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.semantics_from_this_file">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.semantics_from_this_file">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">semantics_from_this_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Define which file should be used by WORC to extract the semantic features.</span>

<span class="sd">        The values in these file can be used as semantic, i.e. non-computational,</span>
<span class="sd">        features in WORC. Should be a .csv file: see</span>
<span class="sd">        :ref:`the WORC user manual &lt;usermanual-chapter:&gt;` for more details on</span>
<span class="sd">        the formatting of this file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_path: basestring</span>
<span class="sd">            Location of the file to be used as semantics file. Can be a .csv or .txt file.</span>
<span class="sd">        is_training: Boolean, default True</span>
<span class="sd">            Identify whether this semantics  file should be used in the training or test dataset.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">semantics_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">semantics_file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">CsvDetector</span><span class="p">(</span><span class="n">semantics_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="n">InvalidCsvFileException</span><span class="p">(</span><span class="n">semantics_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>

        <span class="c1"># TODO: implement sanity check semantics file e.g. is it a semantics file and are there semantics available</span>
        <span class="k">if</span> <span class="n">is_training</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_semantics_file_train</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">semantics_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_semantics_file_test</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">semantics_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)]</span></div>


<div class="viewcode-block" id="SimpleWORC.set_registration_parameterfile">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.set_registration_parameterfile">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_registration_parameterfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Define which elastix parameter file(s) should be used by WORC to perform the registration.</span>
<span class="sd">        </span>
<span class="sd">        More information can be found in the elastix documentation on the format and settings:</span>
<span class="sd">        https://github.com/SuperElastix/elastix/wiki. Examples of parameter files can be found in</span>
<span class="sd">        the elastix model zoo github repo:</span>
<span class="sd">        https://github.com/SuperElastix/ElastixModelZoo/tree/master/models/default.</span>
<span class="sd">        </span>
<span class="sd">        If you want to use multiple parameter files sequentially in the registration,</span>
<span class="sd">        simply use this function multiple times.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_path: basestring</span>
<span class="sd">            Location of the file to be used, should be a .txt file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">elastix_parameter_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">elastix_parameter_file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">CsvDetector</span><span class="p">(</span><span class="n">elastix_parameter_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="n">InvalidCsvFileException</span><span class="p">(</span><span class="n">elastix_parameter_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_elastix_parameter_file</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">elastix_parameter_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">))</span></div>



<div class="viewcode-block" id="SimpleWORC.run_inference">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.run_inference">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">run_inference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trained_model</span><span class="p">,</span> <span class="n">config_files</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run inference on a dataset using a previously trained WORC model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        trained_model: basestring</span>
<span class="sd">            Location of the HDF5 file of the trained model from WORC, commonly named &quot;estimator_all_0.hdf5&quot;.</span>
<span class="sd">         config_files: basestring</span>
<span class="sd">            List of location of the .ini file of the configurations of the trained model from WORC, commonly named like &quot;config_CT_0_all_0.ini&quot;.</span>
<span class="sd">            Note: these are the config files for the feature extraction, not the model training itself, which is embedded in the trained model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trained_model</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">trained_model</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">trained_model</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">trained_model</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_trained_model</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">trained_model</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">config_file</span> <span class="ow">in</span> <span class="n">config_files</span><span class="p">:</span>
            <span class="n">config_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">config_file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">PathNotFoundException</span><span class="p">(</span><span class="n">trained_model</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_config_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">config_file</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%20&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">))</span>
        
        <span class="c1"># Change build type for making the fastr network</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buildtype</span> <span class="o">=</span> <span class="s1">&#39;inference&#39;</span></div>


<div class="viewcode-block" id="SimpleWORC.predict_labels">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.predict_labels">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine which label(s) to predict in your experiments.</span>

<span class="sd">        The labels(s) you want to predict should be given in strings and</span>
<span class="sd">        should be included in the header of your labels_from_this_file csv.</span>
<span class="sd">        Note that you therefore first need to use that function to determine</span>
<span class="sd">        which label file to use, and afterwards use this function</span>
<span class="sd">        to select one of the headers / columns containing the actual label.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        label_names: list</span>
<span class="sd">            List of strings containing the label name(s) to predict. For each</span>
<span class="sd">            label, a separate (classification) model will be created, or,</span>
<span class="sd">            if a multilabel experiment is run, a singel multiclass / multilabel</span>
<span class="sd">            classification model</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels_file_train</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_file_train</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trained_model</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No labels file set! You can do this through labels_from_this_file&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label_names</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;label_names is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">label_names</span><span class="p">)</span><span class="si">}</span><span class="s1"> while list is expected&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">label_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;label </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="si">}</span><span class="s1"> while str is expected&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid label, length = 0&#39;</span><span class="p">)</span>

        <span class="c1"># TODO: check if labels is in labels file</span>

        <span class="c1"># self._worc.label_names = &#39;, &#39;.join(label_names)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label_names</span> <span class="o">=</span> <span class="n">label_names</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_set_and_validate_estimators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimators</span><span class="p">,</span> <span class="n">scoring_method</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">coarse</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether the given estimators in the config are valid for the experiment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        estimators: list</span>
<span class="sd">            String(s) of the estimators to be used. See the</span>
<span class="sd">            :ref:`WORC Config chapter &lt;config-chapter&gt;` for allowed options.</span>
<span class="sd">        scoring_method: string</span>
<span class="sd">            Name of metric to be used for ranking the workflows.</span>
<span class="sd">        method: string</span>
<span class="sd">            Currently supported: classification or regression</span>
<span class="sd">        coarse: boolean</span>
<span class="sd">            Determine whether to do a coarse or full experiment.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># validate</span>
        <span class="k">if</span> <span class="s1">&#39;classification&#39;</span> <span class="ow">in</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">valid_estimators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SVM&#39;</span><span class="p">,</span> <span class="s1">&#39;RF&#39;</span><span class="p">,</span> <span class="s1">&#39;SGD&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s1">&#39;LDA&#39;</span><span class="p">,</span> <span class="s1">&#39;QDA&#39;</span><span class="p">,</span> <span class="s1">&#39;GaussianNB&#39;</span><span class="p">,</span> <span class="s1">&#39;ComplementNB&#39;</span><span class="p">,</span> <span class="s1">&#39;AdaBoostClassifier&#39;</span><span class="p">,</span> <span class="s1">&#39;XGBClassifier&#39;</span><span class="p">,</span> <span class="s1">&#39;LightGBMClassifier&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;regression&#39;</span><span class="p">:</span>
            <span class="n">valid_estimators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SVR&#39;</span><span class="p">,</span> <span class="s1">&#39;RFR&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticNet&#39;</span><span class="p">,</span> <span class="s1">&#39;Lasso&#39;</span><span class="p">,</span> <span class="s1">&#39;SGDR&#39;</span><span class="p">,</span> <span class="s1">&#39;XGBRegressor&#39;</span><span class="p">,</span> <span class="s1">&#39;AdaBoostRegressor&#39;</span><span class="p">,</span> <span class="s1">&#39;LinR&#39;</span><span class="p">,</span> <span class="s1">&#39;Ridge&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valid_estimators</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">estimator</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_estimators</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Invalid estimator </span><span class="si">{</span><span class="n">estimator</span><span class="si">}</span><span class="s1"> for </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1">; must be one of </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_estimators</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># TODO: sanity check scoring method per estimator</span>

        <span class="c1"># set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_builder</span><span class="o">.</span><span class="n">estimator_scoring_overrides</span><span class="p">(</span><span class="n">estimators</span><span class="p">,</span> <span class="n">scoring_method</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">coarse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config_builder</span><span class="o">.</span><span class="n">coarse_overrides</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">method</span>

<div class="viewcode-block" id="SimpleWORC.count_num_subjects">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.count_num_subjects">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count_num_subjects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Count the number of subjects in the experiment.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trained_model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Only count test subjects</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radiomix_feature_file</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_radiomix_feature_file</span><span class="p">)</span>
                <span class="n">pids</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="n">pids</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images_test</span><span class="p">:</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_test</span><span class="p">:</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">images_test</span><span class="p">:</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">images_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">features_test</span><span class="p">:</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">features_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;No test features or images given, cannot count number &#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39; of subjects. Make sure you input at least one of these &#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;as source.&#39;</span>
                <span class="k">raise</span> <span class="n">WORCValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radiomix_feature_file</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_radiomix_feature_file</span><span class="p">)</span>
                <span class="n">pids</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="n">pids</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images_train</span><span class="p">:</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_train</span><span class="p">:</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">images_train</span><span class="p">:</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">images_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">features_train</span><span class="p">:</span>
                <span class="n">tocount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">features_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;No train features or images given, cannot count number &#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39; of subjects. Make sure you input at least one of these &#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;as source.&#39;</span>
                <span class="k">raise</span> <span class="n">WORCValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">tocount</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">():</span>
            <span class="n">num_subjects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tocount</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_subjects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tocount</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_subjects</span> <span class="o">=</span> <span class="n">num_subjects</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run various validators to validate the experiment.&quot;&quot;&quot;</span>
        <span class="n">validators</span> <span class="o">=</span> <span class="n">ValidatorsFactory</span><span class="o">.</span><span class="n">factor_validators</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count_num_subjects</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">validator</span> <span class="ow">in</span> <span class="n">validators</span><span class="p">:</span>
            <span class="n">validator</span><span class="o">.</span><span class="n">do_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="SimpleWORC.binary_classification">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.binary_classification">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">binary_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">scoring_method</span><span class="o">=</span><span class="s1">&#39;f1_weighted&#39;</span><span class="p">,</span>
                              <span class="n">coarse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tell WORC do to a binary classification experiment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        estimators: list</span>
<span class="sd">            List of strings with names of valid estimators. See the</span>
<span class="sd">            :ref:`WORC Config chapter &lt;config-chapter&gt;` for allowed options.</span>

<span class="sd">            If coarse, only an SVM will be used. If not, the default full</span>
<span class="sd">            config will be used.</span>
<span class="sd">        scoring_method: string, default f1</span>
<span class="sd">            Name of the scoring method used to rank the workflows. See the</span>
<span class="sd">            :ref:`WORC Config chapter &lt;config-chapter&gt;` for allowed options.</span>
<span class="sd">        coarse: boolean, default True</span>
<span class="sd">            Determine whether to do a coarse or full experiment.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">coarse</span> <span class="ow">and</span> <span class="n">estimators</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">estimators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SVM&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">estimators</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">estimators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SVM&#39;</span><span class="p">,</span> <span class="s1">&#39;RF&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s1">&#39;LDA&#39;</span><span class="p">,</span> <span class="s1">&#39;QDA&#39;</span><span class="p">,</span> <span class="s1">&#39;GaussianNB&#39;</span><span class="p">,</span> <span class="s1">&#39;AdaBoostClassifier&#39;</span><span class="p">,</span> <span class="s1">&#39;XGBClassifier&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_and_validate_estimators</span><span class="p">(</span><span class="n">estimators</span><span class="p">,</span> <span class="n">scoring_method</span><span class="p">,</span> <span class="s1">&#39;binary_classification&#39;</span><span class="p">,</span> <span class="n">coarse</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.multiclass_classification">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.multiclass_classification">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">multiclass_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">scoring_method</span><span class="o">=</span><span class="s1">&#39;f1_weighted&#39;</span><span class="p">,</span>
                                  <span class="n">coarse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tell WORC do to a multiclass classification experiment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        estimators: list</span>
<span class="sd">            List of strings with names of valid estimators. See the</span>
<span class="sd">            :ref:`WORC Config chapter &lt;config-chapter&gt;` for allowed options.</span>

<span class="sd">            If coarse, only an SVM will be used. If not, the default full</span>
<span class="sd">            config will be used.</span>
<span class="sd">        scoring_method: string, default f1</span>
<span class="sd">            Name of the scoring method used to rank the workflows. See the</span>
<span class="sd">            :ref:`WORC Config chapter &lt;config-chapter&gt;` for allowed options.</span>
<span class="sd">        coarse: boolean, default True</span>
<span class="sd">            Determine whether to do a coarse or full experiment.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">coarse</span> <span class="ow">and</span> <span class="n">estimators</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">estimators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SVM&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">estimators</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">estimators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SVM&#39;</span><span class="p">,</span> <span class="s1">&#39;RF&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s1">&#39;LDA&#39;</span><span class="p">,</span> <span class="s1">&#39;QDA&#39;</span><span class="p">,</span> <span class="s1">&#39;GaussianNB&#39;</span><span class="p">,</span> <span class="s1">&#39;AdaBoostClassifier&#39;</span><span class="p">,</span> <span class="s1">&#39;XGBClassifier&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_and_validate_estimators</span><span class="p">(</span><span class="n">estimators</span><span class="p">,</span> <span class="n">scoring_method</span><span class="p">,</span> <span class="s1">&#39;multiclass_classification&#39;</span><span class="p">,</span> <span class="n">coarse</span><span class="p">)</span>

        <span class="n">overrides</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Labels&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;modus&#39;</span><span class="p">:</span> <span class="s1">&#39;multilabel&#39;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s1">&#39;Featsel&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="c1"># Other estimators do not support multiclass</span>
                <span class="s1">&#39;SelectFromModel_estimator&#39;</span><span class="p">:</span> <span class="s1">&#39;RF&#39;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_config_overrides</span><span class="p">(</span><span class="n">overrides</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.regression">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.regression">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">regression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scoring_method</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">coarse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tell WORC do to a regression experiment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        estimators: list</span>
<span class="sd">            List of strings with names of valid estimators. See the</span>
<span class="sd">            :ref:`WORC Config chapter &lt;config-chapter&gt;` for allowed options.</span>

<span class="sd">            If coarse, only SVR will be used. If not, the default full</span>
<span class="sd">            config will be used.</span>
<span class="sd">        scoring_method: string, default r2</span>
<span class="sd">            Name of the scoring method used to rank the workflows. See the</span>
<span class="sd">            :ref:`WORC Config chapter &lt;config-chapter&gt;` for allowed options.</span>
<span class="sd">        coarse: boolean, default True</span>
<span class="sd">            Determine whether to do a coarse or full experiment.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if coarse and estimators is None:</span>
        <span class="c1">#     estimators = [&#39;SVR&#39;]</span>
        <span class="c1"># elif estimators is None:</span>
        <span class="n">estimators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SVR&#39;</span><span class="p">,</span> <span class="s1">&#39;RFR&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticNet&#39;</span><span class="p">,</span> <span class="s1">&#39;Lasso&#39;</span><span class="p">,</span> <span class="s1">&#39;AdaBoostRegressor&#39;</span><span class="p">,</span> <span class="s1">&#39;XGBRegressor&#39;</span><span class="p">,</span> <span class="s1">&#39;LinR&#39;</span><span class="p">,</span> <span class="s1">&#39;Ridge&#39;</span><span class="p">]</span>

        <span class="c1"># regression-specific override</span>
        <span class="n">overrides</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Featsel&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;SelectFromModel&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;StatisticalTestUse&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;ReliefUse&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_config_overrides</span><span class="p">(</span><span class="n">overrides</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_and_validate_estimators</span><span class="p">(</span><span class="n">estimators</span><span class="p">,</span> <span class="n">scoring_method</span><span class="p">,</span> <span class="s1">&#39;regression&#39;</span><span class="p">,</span> <span class="n">coarse</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.survival">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.survival">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">survival</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimators</span><span class="p">,</span> <span class="n">scoring_method</span><span class="p">,</span> <span class="n">coarse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tell WORC do to a regression experiment. Not implemented yet.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


<div class="viewcode-block" id="SimpleWORC.add_config_overrides">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.add_config_overrides">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_config_overrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add manual overrides for the WORC configuration.</span>

<span class="sd">        For a full list of options, see the</span>
<span class="sd">        :ref:`WORC Config chapter &lt;config-chapter&gt;` for allowed options.</span>

<span class="sd">        Example usage:</span>

<span class="sd">        overrides = {</span>
<span class="sd">            &#39;Classification&#39;: {</span>
<span class="sd">                &#39;classifiers&#39;: &#39;SVM&#39;,</span>
<span class="sd">            },</span>
<span class="sd">            &#39;Featsel&#39;: {</span>
<span class="sd">                # Other estimators do not support multiclass</span>
<span class="sd">                &#39;SelectFromModel_estimator&#39;: &#39;RF&#39;</span>
<span class="sd">            }</span>
<span class="sd">        }</span>
<span class="sd">        self.add_config_overrides(overrides)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config: dictionary</span>
<span class="sd">            Determine which options to override with which values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_builder</span><span class="o">.</span><span class="n">custom_config_overrides</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWORC.add_evaluation">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.add_evaluation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_label</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the evaluation workflow to the standard WORC workflow.</span>

<span class="sd">        Adds several evaluation measures, including:</span>

<span class="sd">        - Computation of 95% confidence intervals for performance</span>
<span class="sd">        - Univariate testing of features</span>
<span class="sd">        - ROC curve with confidence bands construction</span>
<span class="sd">        - Ranking of patients based on percentage / posterior</span>
<span class="sd">        - Decompositions (e.g. PCA, t-SNE)</span>

<span class="sd">        See the :ref:`WORC documentation &lt;additonalfunctionality-chapter&gt;` for additional info.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        selected_label: integer, default 0</span>
<span class="sd">            Determine for which of the labels to be predicted the evaluate workflow</span>
<span class="sd">            should be executed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_evaluation</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selected_label</span> <span class="o">=</span> <span class="n">selected_label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">modus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span></div>


<div class="viewcode-block" id="SimpleWORC.set_tmpdir">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.set_tmpdir">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_tmpdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmpdir</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a directory for storing temporary files from the experiment.</span>

<span class="sd">        If not specified, the default fastr tmpdir is used, see ``fastr.config.mounts[&#39;tmp&#39;]`` .</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">fastr_tmpdir</span> <span class="o">=</span> <span class="n">tmpdir</span></div>


<div class="viewcode-block" id="SimpleWORC.set_multicore_execution">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.set_multicore_execution">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_multicore_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&quot;Execute experiment in multicore mode.</span>

<span class="sd">        By default, SimpleWORC executes experiments in LinearExecution mode, meaning that</span>
<span class="sd">        only a single core will be used and jobs are executed in series. When multicore mode</span>
<span class="sd">        is enabled, jobs are parallellized over all available cores, which majorly speeds</span>
<span class="sd">        up the computation.</span>

<span class="sd">        Note: SimpleWORC has an automatic detector for the BIGR and Snellius cluster. Hence,</span>
<span class="sd">        on those clusters, do not use the multicore execution, as this will overwrite</span>
<span class="sd">        the changes applied by the detectors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">fastr_plugin</span> <span class="o">=</span> <span class="s1">&#39;ProcessPoolExecution&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_config_overrides</span><span class="p">({</span><span class="s1">&#39;Classification&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fastr_plugin&#39;</span><span class="p">:</span> <span class="s1">&#39;ProcessPoolExecution&#39;</span><span class="p">}})</span></div>


<div class="viewcode-block" id="SimpleWORC.features_from_radiomix_xlsx">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.features_from_radiomix_xlsx">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">features_from_radiomix_xlsx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use a feature file which is generated by the OncoRadiomics Radiomix tool.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radiomix_feature_file</span> <span class="o">=</span> <span class="n">feature_file</span></div>

        
    <span class="k">def</span><span class="w"> </span><span class="nf">_check_traintest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether experiment purely has a training set, or training and testing&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">images_test</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">features_test</span><span class="p">:</span>
            <span class="c1"># Testing workflow, use bootstrapping</span>
            <span class="n">overrides</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Bootstrap&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Use&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">}</span>
                        <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_config_overrides</span><span class="p">(</span><span class="n">overrides</span><span class="p">)</span>

<div class="viewcode-block" id="SimpleWORC.execute">
<a class="viewcode-back" href="../../../autogen/WORC.facade.html#WORC.facade.simpleworc.SimpleWORC.execute">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the experiment.</span>

<span class="sd">        Before executing the actual experiment, this function will first run several validators</span>
<span class="sd">        and check the provided setup to make sure some of the most common</span>
<span class="sd">        made error are caught before running the experiment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Do some final sanity checking before we execute the experiment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fixed_splits</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">fixedsplits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fixed_splits</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radiomix_feature_file</span><span class="p">:</span>
            <span class="c1"># Convert radiomix features and use those as inputs</span>
            <span class="n">output_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fastr</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">mounts</span><span class="p">[</span><span class="s1">&#39;tmp&#39;</span><span class="p">],</span>
                                         <span class="s1">&#39;Radiomix_features&#39;</span><span class="p">)</span>

            <span class="c1"># Check if output folder exists: otherwise create</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_folder</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">output_folder</span><span class="p">)</span>

            <span class="c1"># convert the features</span>
            <span class="n">convert_radiomix_features</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_radiomix_feature_file</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>

            <span class="c1"># Set the newly created feature files as the WORC input</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">features_from_this_directory</span><span class="p">(</span><span class="n">output_folder</span><span class="p">)</span>

        <span class="c1"># Give set sources to the WORC object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">images_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">features_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">segmentations_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_segmentations_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">masks_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_masks_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">labels_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels_file_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">Elastix_Para</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elastix_parameter_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">semantics_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantics_file_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">trained_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trained_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">configs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_files</span>

        <span class="c1"># If a specific train-test setup is provided, add test sources</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">images_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images_test</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">features_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_test</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_segmentations_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">segmentations_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_segmentations_test</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_masks_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">masks_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_masks_test</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels_file_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">labels_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels_file_test</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantics_file_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">semantics_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantics_file_test</span>

        <span class="c1"># Set the labels to predict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">label_names</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_label_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Labels&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_builder</span><span class="o">.</span><span class="n">_custom_overrides</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config_builder</span><span class="o">.</span><span class="n">_custom_overrides</span><span class="p">[</span><span class="s1">&#39;Labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_config_builder</span><span class="o">.</span><span class="n">_custom_overrides</span><span class="p">[</span><span class="s1">&#39;Labels&#39;</span><span class="p">][</span><span class="s1">&#39;label_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">label_names</span>

        <span class="c1"># Find out how many configs we need to make</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">images_train</span><span class="p">:</span>
            <span class="n">nmod</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">images_train</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nmod</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">features_train</span><span class="p">)</span>
            
        <span class="c1"># Check whether user has provided a separate train and test set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_traintest</span><span class="p">()</span>

        <span class="c1"># Create configuration files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">configs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_builder</span><span class="o">.</span><span class="n">build_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">defaultconfig</span><span class="p">())]</span> <span class="o">*</span> <span class="n">nmod</span>
        <span class="k">for</span> <span class="n">cnum</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">configs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">configs</span><span class="p">[</span><span class="n">cnum</span><span class="p">][</span><span class="s1">&#39;ImageFeatures&#39;</span><span class="p">][</span><span class="s1">&#39;image_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image_types</span><span class="p">[</span><span class="n">cnum</span><span class="p">]</span>

        <span class="c1"># Build the fastr network</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">buildtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_buildtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_evaluation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span><span class="n">label_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_label_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_label</span><span class="p">],</span>
                                      <span class="n">modus</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">)</span>

        <span class="c1"># Set the sources and sinks and execute the experiment.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_worc</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span></div>
</div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2016 -- 2025, Biomedical Imaging Group Rotterdam, Department of Radiology and Nuclear Medicine, Erasmus University Medical Center, Rotterdam, The Netherlands
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=229cbe3b"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>