#!/usr/bin/env python3
"""
ä¼ªé€ æ•°æ®è„šæœ¬
ç”Ÿæˆä¸‰ä¸ªç”¨æˆ·çš„æ¨¡æ‹ŸèŠå¤©å¯¹è¯æ•°æ®ï¼Œå¹¶è°ƒç”¨LindormMemobase.add_blob_to_bufferå†™å…¥bufferä¸­
æ¯ä¸ªç”¨æˆ·ç”Ÿæˆ10æ¡å¯¹è¯è®°å½•
"""

import asyncio
import os
import sys
from datetime import datetime
from typing import List

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°è·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from lindormmemobase import LindormMemobase
from lindormmemobase.models.blob import ChatBlob, BlobType, OpenAICompatibleMessage


class FakeDataGenerator:
    """ä¼ªé€ æ•°æ®ç”Ÿæˆå™¨"""
    
    def __init__(self, config_path: str = "./config.yaml"):
        """åˆå§‹åŒ–æ•°æ®ç”Ÿæˆå™¨"""
        self.config_path = config_path
        self.memobase = None
        
        # å®šä¹‰ä¸‰ä¸ªæµ‹è¯•ç”¨æˆ·
        self.users = {
            "user_001": {
                "name": "å¼ ä¸‰",
                "description": "è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œå–œæ¬¢æŠ€æœ¯è®¨è®ºå’Œç¼–ç¨‹",
                "personality": "æŠ€æœ¯å¯¼å‘ï¼Œé€»è¾‘æ€§å¼º"
            },
            "user_002": {
                "name": "æå››", 
                "description": "äº§å“ç»ç†ï¼Œå…³æ³¨ç”¨æˆ·ä½“éªŒå’Œå•†ä¸šä»·å€¼",
                "personality": "å•†ä¸šæ•æ„Ÿï¼Œæ³¨é‡ç”¨æˆ·éœ€æ±‚"
            },
            "user_003": {
                "name": "ç‹äº”",
                "description": "æ•°æ®åˆ†æå¸ˆï¼Œçƒ­çˆ±æ•°æ®æŒ–æ˜å’Œæœºå™¨å­¦ä¹ ", 
                "personality": "æ•°æ®é©±åŠ¨ï¼Œå–œæ¬¢æ·±åº¦æ€è€ƒ"
            }
        }
        
        # é¢„å®šä¹‰å¯¹è¯æ¨¡æ¿
        self.conversation_templates = self._generate_conversation_templates()
    
    def _generate_conversation_templates(self) -> dict:
        """ç”Ÿæˆå¯¹è¯æ¨¡æ¿"""
        return {
            "user_001": [
                {
                    "user": "ä½ å¥½ï¼Œæˆ‘æœ€è¿‘åœ¨å­¦ä¹ Pythonå¼‚æ­¥ç¼–ç¨‹ï¼Œæœ‰ä»€ä¹ˆå¥½çš„å­¦ä¹ èµ„æºæ¨èå—ï¼Ÿ",
                    "assistant": "æˆ‘æ¨èä½ çœ‹çœ‹ã€ŠPythonå¼‚æ­¥ç¼–ç¨‹ã€‹è¿™æœ¬ä¹¦ï¼Œè¿˜æœ‰å®˜æ–¹çš„asyncioæ–‡æ¡£ã€‚ä½ å¯ä»¥ä»ç®€å•çš„async/awaitè¯­æ³•å¼€å§‹ï¼Œç„¶åé€æ­¥å­¦ä¹ äº‹ä»¶å¾ªç¯ã€åç¨‹ç­‰æ¦‚å¿µã€‚"
                },
                {
                    "user": "æˆ‘åœ¨ä½¿ç”¨asyncioæ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•æ­£ç¡®å¤„ç†å¼‚å¸¸ï¼Ÿ",
                    "assistant": "åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œå¼‚å¸¸å¤„ç†å¾ˆé‡è¦ã€‚ä½ å¯ä»¥ä½¿ç”¨try-exceptåŒ…å›´awaitè¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨asyncio.gather()çš„return_exceptionså‚æ•°æ¥æ”¶é›†å¼‚å¸¸ã€‚è®°å¾—åœ¨Taskä¸­ä¹Ÿè¦å¤„ç†å¼‚å¸¸ã€‚"
                },
                {
                    "user": "èƒ½å¦è§£é‡Šä¸€ä¸‹Pythonçš„GILå¯¹å¤šçº¿ç¨‹æ€§èƒ½çš„å½±å“ï¼Ÿ",
                    "assistant": "GILï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰ç¡®å®ä¼šé™åˆ¶Pythonå¤šçº¿ç¨‹çš„CPUå¯†é›†å‹ä»»åŠ¡æ€§èƒ½ã€‚å¯¹äºCPUå¯†é›†å‹ä»»åŠ¡ï¼Œå»ºè®®ä½¿ç”¨multiprocessingï¼›å¯¹äºI/Oå¯†é›†å‹ä»»åŠ¡ï¼Œasyncioé€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚"
                },
                {
                    "user": "æˆ‘æ­£åœ¨åšä¸€ä¸ªWebçˆ¬è™«é¡¹ç›®ï¼Œç”¨ä»€ä¹ˆæ¡†æ¶æ¯”è¾ƒå¥½ï¼Ÿ",
                    "assistant": "æ¨èä½¿ç”¨scrapyæ¡†æ¶ï¼Œå®ƒä¸“ä¸ºçˆ¬è™«è®¾è®¡ï¼Œå†…ç½®äº†å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ã€‚å¦‚æœæ˜¯ç®€å•é¡¹ç›®ï¼Œrequests + BeautifulSoupä¹Ÿå¤Ÿç”¨ã€‚è®°å¾—éµå®ˆrobots.txtå’Œåˆç†æ§åˆ¶è¯·æ±‚é¢‘ç‡ã€‚"
                },
                {
                    "user": "Dockerå®¹å™¨åŒ–éƒ¨ç½²æœ‰ä»€ä¹ˆæœ€ä½³å®è·µï¼Ÿ",
                    "assistant": "Dockeræœ€ä½³å®è·µåŒ…æ‹¬ï¼šä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°é•œåƒå¤§å°ã€ä¸è¦åœ¨å®¹å™¨ä¸­è¿è¡Œå¤šä¸ªè¿›ç¨‹ã€ä½¿ç”¨.dockerignoreã€è®¾ç½®åˆé€‚çš„å¥åº·æ£€æŸ¥ã€ä½¿ç”¨érootç”¨æˆ·è¿è¡Œç­‰ã€‚"
                },
                {
                    "user": "æˆ‘æƒ³äº†è§£ä¸€ä¸‹å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹",
                    "assistant": "å¾®æœåŠ¡ä¼˜ç‚¹åŒ…æ‹¬æŠ€æœ¯å¤šæ ·æ€§ã€ç‹¬ç«‹éƒ¨ç½²ã€å®¹é”™æ€§å¥½ã€‚ç¼ºç‚¹æ˜¯å¢åŠ äº†ç³»ç»Ÿå¤æ‚æ€§ã€ç½‘ç»œå»¶è¿Ÿã€æ•°æ®ä¸€è‡´æ€§ç­‰æŒ‘æˆ˜ã€‚éœ€è¦æ ¹æ®å›¢é˜Ÿè§„æ¨¡å’Œä¸šåŠ¡å¤æ‚åº¦æƒè¡¡ã€‚"
                },
                {
                    "user": "åœ¨è®¾è®¡APIæ—¶ï¼ŒRESTfulå’ŒGraphQLè¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿ",
                    "assistant": "RESTé€‚åˆèµ„æºå¯¼å‘çš„ç®€å•åœºæ™¯ï¼ŒGraphQLé€‚åˆå¤æ‚çš„æ•°æ®æŸ¥è¯¢éœ€æ±‚ã€‚GraphQLå¯ä»¥å‡å°‘è¿‡åº¦è·å–æ•°æ®ï¼Œä½†å­¦ä¹ æˆæœ¬æ›´é«˜ã€‚å»ºè®®å…ˆè¯„ä¼°å›¢é˜ŸæŠ€æœ¯æ ˆå’Œå…·ä½“éœ€æ±‚ã€‚"
                },
                {
                    "user": "å¦‚ä½•è¿›è¡Œæœ‰æ•ˆçš„ä»£ç å®¡æŸ¥ï¼ˆCode Reviewï¼‰ï¼Ÿ",
                    "assistant": "æœ‰æ•ˆçš„ä»£ç å®¡æŸ¥åº”è¯¥å…³æ³¨ï¼šä»£ç é€»è¾‘æ­£ç¡®æ€§ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨é—®é¢˜ã€ç¼–ç è§„èŒƒã€å¯ç»´æŠ¤æ€§ã€‚å»ºè®®ä½¿ç”¨å·¥å…·è¾…åŠ©ï¼Œä¿æŒå‹å–„çš„æ²Ÿé€šæ€åº¦ï¼Œæ—¢è¦æŒ‡å‡ºé—®é¢˜ä¹Ÿè¦è§£é‡ŠåŸå› ã€‚"
                },
                {
                    "user": "æˆ‘åœ¨å­¦ä¹ ç®—æ³•ï¼ŒåŠ¨æ€è§„åˆ’æ€»æ˜¯ç†è§£ä¸é€å½»",
                    "assistant": "åŠ¨æ€è§„åˆ’çš„æ ¸å¿ƒæ˜¯æ‰¾åˆ°çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚å»ºè®®ä»ç»å…¸é—®é¢˜å¼€å§‹ï¼ˆå¦‚æ–æ³¢é‚£å¥‘ã€èƒŒåŒ…é—®é¢˜ï¼‰ï¼Œå…ˆç”»å‡ºçŠ¶æ€è½¬ç§»å›¾ï¼Œç†è§£å­é—®é¢˜å¦‚ä½•ç»„åˆæˆåŸé—®é¢˜ï¼Œå¤šç»ƒä¹ å°±èƒ½æŒæ¡ã€‚"
                },
                {
                    "user": "ç°åœ¨AIå‘å±•è¿™ä¹ˆå¿«ï¼Œç¨‹åºå‘˜ä¼šè¢«æ›¿ä»£å—ï¼Ÿ",
                    "assistant": "AIå·¥å…·ç¡®å®æé«˜äº†å¼€å‘æ•ˆç‡ï¼Œä½†ç¨‹åºå‘˜çš„ä»·å€¼åœ¨äºè§£å†³å¤æ‚é—®é¢˜ã€ç³»ç»Ÿè®¾è®¡ã€ä¸šåŠ¡ç†è§£ç­‰ã€‚å»ºè®®æ‹¥æŠ±AIå·¥å…·ï¼Œå°†å®ƒä»¬ä½œä¸ºæå‡ç”Ÿäº§åŠ›çš„åŠ©æ‰‹ï¼ŒåŒæ—¶æŒç»­å­¦ä¹ æ–°æŠ€æœ¯ã€‚"
                }
            ],
            "user_002": [
                {
                    "user": "æˆ‘ä»¬æ­£åœ¨è§„åˆ’ä¸€ä¸ªæ–°äº§å“ï¼Œå¦‚ä½•è¿›è¡Œæœ‰æ•ˆçš„ç”¨æˆ·è°ƒç ”ï¼Ÿ",
                    "assistant": "ç”¨æˆ·è°ƒç ”åº”è¯¥åŒ…æ‹¬å®šæ€§å’Œå®šé‡æ–¹æ³•ã€‚å¯ä»¥é€šè¿‡ç”¨æˆ·è®¿è°ˆäº†è§£æ·±å±‚éœ€æ±‚ï¼Œé€šè¿‡é—®å·è°ƒæŸ¥è·å–å¤§é‡æ•°æ®ï¼Œè¿˜å¯ä»¥è¿›è¡Œå¯ç”¨æ€§æµ‹è¯•ã€‚å…³é”®æ˜¯è¦å®šä¹‰æ¸…æ¥šè°ƒç ”ç›®æ ‡å’Œç”¨æˆ·ç”»åƒã€‚"
                },
                {
                    "user": "äº§å“è¿­ä»£ä¸­ï¼Œå¦‚ä½•å¹³è¡¡æ–°åŠŸèƒ½å¼€å‘å’ŒæŠ€æœ¯å€ºåŠ¡å¤„ç†ï¼Ÿ",
                    "assistant": "è¿™éœ€è¦åœ¨ä¸šåŠ¡ä»·å€¼å’ŒæŠ€æœ¯å¥åº·ä¹‹é—´æ‰¾å¹³è¡¡ã€‚å»ºè®®é‡‡ç”¨70-20-10æ³•åˆ™ï¼š70%ç²¾åŠ›ç”¨äºæ ¸å¿ƒåŠŸèƒ½ï¼Œ20%ç”¨äºæ”¹è¿›ä¼˜åŒ–ï¼Œ10%ç”¨äºæŠ€æœ¯å€ºåŠ¡ã€‚å®šæœŸæŠ€æœ¯å€ºåŠ¡è¯„ä¼°ä¹Ÿå¾ˆé‡è¦ã€‚"
                },
                {
                    "user": "æ€æ ·è®¾è®¡ä¸€ä¸ªæœ‰æ•ˆçš„äº§å“è·¯çº¿å›¾ï¼Ÿ",
                    "assistant": "äº§å“è·¯çº¿å›¾åº”è¯¥åŸºäºç”¨æˆ·ä»·å€¼ã€å•†ä¸šç›®æ ‡å’ŒæŠ€æœ¯å¯è¡Œæ€§ã€‚å»ºè®®ä½¿ç”¨OKRæ–¹æ³•è®¾å®šç›®æ ‡ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§æ’åˆ—åŠŸèƒ½ï¼Œä¿æŒçµæ´»æ€§ä»¥åº”å¯¹å˜åŒ–ï¼Œå¹¶å®šæœŸä¸å›¢é˜Ÿæ²Ÿé€šæ›´æ–°ã€‚"
                },
                {
                    "user": "å¦‚ä½•è¯„ä¼°äº§å“åŠŸèƒ½çš„ROIï¼ˆæŠ•èµ„å›æŠ¥ç‡ï¼‰ï¼Ÿ",
                    "assistant": "è¯„ä¼°ROIéœ€è¦æ˜ç¡®æŠ•å…¥æˆæœ¬ï¼ˆå¼€å‘ã€ç»´æŠ¤ã€æ¨å¹¿ï¼‰å’Œé¢„æœŸæ”¶ç›Šï¼ˆç”¨æˆ·å¢é•¿ã€æ”¶å…¥æå‡ã€æˆæœ¬èŠ‚çº¦ï¼‰ã€‚å¯ä»¥ä½¿ç”¨A/Bæµ‹è¯•éªŒè¯æ•ˆæœï¼Œå»ºç«‹æ•°æ®æŒ‡æ ‡ä½“ç³»è¿›è¡Œé‡åŒ–åˆ†æã€‚"
                },
                {
                    "user": "åœ¨æ•æ·å¼€å‘ä¸­ï¼Œäº§å“ç»ç†åº”è¯¥å¦‚ä½•ä¸æŠ€æœ¯å›¢é˜Ÿåä½œï¼Ÿ",
                    "assistant": "äº§å“ç»ç†åº”è¯¥å‚ä¸sprintè§„åˆ’ï¼Œæ˜ç¡®éœ€æ±‚ä¼˜å…ˆçº§ï¼ŒåŠæ—¶è§£ç­”å›¢é˜Ÿç–‘é—®ã€‚å»ºè®®å®šæœŸä¸¾è¡Œéœ€æ±‚æ¾„æ¸…ä¼šè®®ï¼Œä½¿ç”¨ç”¨æˆ·æ•…äº‹æè¿°éœ€æ±‚ï¼Œå»ºç«‹è‰¯å¥½çš„æ²Ÿé€šæœºåˆ¶ã€‚"
                },
                {
                    "user": "å¦‚ä½•å¤„ç†æ¥è‡ªä¸åŒåˆ©ç›Šç›¸å…³è€…çš„å†²çªéœ€æ±‚ï¼Ÿ",
                    "assistant": "å¤„ç†å†²çªéœ€æ±‚è¦å›åˆ°äº§å“æ„¿æ™¯å’Œç”¨æˆ·ä»·å€¼ã€‚å»ºè®®å»ºç«‹éœ€æ±‚ä¼˜å…ˆçº§çŸ©é˜µï¼ŒåŸºäºå½±å“èŒƒå›´å’Œç´§æ€¥ç¨‹åº¦è¯„ä¼°ï¼Œé€šè¿‡æ•°æ®å’Œç”¨æˆ·åé¦ˆæ”¯æ’‘å†³ç­–ï¼Œä¿æŒé€æ˜æ²Ÿé€šã€‚"
                },
                {
                    "user": "äº§å“ä¸Šçº¿åï¼Œå¦‚ä½•è¿›è¡Œæ•ˆæœè¯„ä¼°å’Œè¿­ä»£ï¼Ÿ",
                    "assistant": "å»ºç«‹å®Œæ•´çš„æ•°æ®ç›‘æ§ä½“ç³»ï¼ŒåŒ…æ‹¬ç”¨æˆ·è¡Œä¸ºã€ä¸šåŠ¡æŒ‡æ ‡ã€æŠ€æœ¯æŒ‡æ ‡ã€‚å®šæœŸåˆ†æç”¨æˆ·åé¦ˆï¼Œè¿›è¡Œç”¨æˆ·æ»¡æ„åº¦è°ƒæŸ¥ï¼ŒåŸºäºæ•°æ®æ´å¯Ÿåˆ¶å®šä¸‹ä¸€æ­¥è¿­ä»£è®¡åˆ’ã€‚"
                },
                {
                    "user": "B2Bäº§å“å’ŒC2Cäº§å“åœ¨è®¾è®¡ä¸Šæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ",
                    "assistant": "B2Bæ›´æ³¨é‡æ•ˆç‡å’ŒåŠŸèƒ½å®Œæ•´æ€§ï¼Œå†³ç­–å‘¨æœŸé•¿ï¼Œéœ€è¦è€ƒè™‘å¤šè§’è‰²ä½¿ç”¨ã€‚C2Cæ›´æ³¨é‡ç”¨æˆ·ä½“éªŒå’Œæƒ…æ„Ÿè¿æ¥ï¼Œéœ€è¦ç®€å•æ˜“ç”¨ã€‚é”€å”®æ¨¡å¼ã€å®šä»·ç­–ç•¥ä¹Ÿæœ‰å¾ˆå¤§å·®å¼‚ã€‚"
                },
                {
                    "user": "å¦‚ä½•å»ºç«‹å’Œç®¡ç†äº§å“ç¤¾åŒºï¼Ÿ",
                    "assistant": "äº§å“ç¤¾åŒºå»ºè®¾éœ€è¦æ˜ç¡®ç›®æ ‡ç”¨æˆ·ç¾¤ä½“ï¼Œæä¾›æœ‰ä»·å€¼çš„å†…å®¹ï¼Œå»ºç«‹æ¿€åŠ±æœºåˆ¶é¼“åŠ±ç”¨æˆ·å‚ä¸ã€‚è¦åŸ¹å…»ç§å­ç”¨æˆ·ï¼Œå®šæœŸä¸¾åŠæ´»åŠ¨ï¼Œå€¾å¬ç”¨æˆ·å£°éŸ³å¹¶å¿«é€Ÿå“åº”ã€‚"
                },
                {
                    "user": "äº§å“å®šä»·ç­–ç•¥æœ‰å“ªäº›è€ƒè™‘å› ç´ ï¼Ÿ",
                    "assistant": "å®šä»·éœ€è¦è€ƒè™‘æˆæœ¬ç»“æ„ã€ç«äº‰å¯¹æ‰‹ã€ç”¨æˆ·ä»·å€¼æ„ŸçŸ¥ã€å¸‚åœºå®šä½ç­‰ã€‚å¯ä»¥é‡‡ç”¨ä»·å€¼å®šä»·ã€ç«äº‰å®šä»·ã€æˆæœ¬åŠ æˆç­‰æ–¹æ³•ï¼Œé€šè¿‡A/Bæµ‹è¯•éªŒè¯ä¸åŒä»·æ ¼ç‚¹çš„è½¬åŒ–æ•ˆæœã€‚"
                }
            ],
            "user_003": [
                {
                    "user": "æˆ‘æ­£åœ¨å­¦ä¹ æœºå™¨å­¦ä¹ ï¼Œç›‘ç£å­¦ä¹ å’Œæ— ç›‘ç£å­¦ä¹ æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ",
                    "assistant": "ç›‘ç£å­¦ä¹ ä½¿ç”¨å¸¦æ ‡ç­¾çš„æ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œå¦‚åˆ†ç±»å’Œå›å½’é—®é¢˜ã€‚æ— ç›‘ç£å­¦ä¹ ä»æ— æ ‡ç­¾æ•°æ®ä¸­å‘ç°æ¨¡å¼ï¼Œå¦‚èšç±»å’Œé™ç»´ã€‚åŠç›‘ç£å­¦ä¹ åˆ™ç»“åˆäº†ä¸¤è€…ï¼Œä½¿ç”¨å°‘é‡æ ‡ç­¾æ•°æ®ã€‚"
                },
                {
                    "user": "åœ¨åšæ•°æ®åˆ†ææ—¶ï¼Œå¦‚ä½•å¤„ç†ç¼ºå¤±å€¼ï¼Ÿ",
                    "assistant": "å¤„ç†ç¼ºå¤±å€¼çš„æ–¹æ³•åŒ…æ‹¬ï¼šåˆ é™¤å«ç¼ºå¤±å€¼çš„è®°å½•ã€ç”¨å‡å€¼/ä¸­ä½æ•°/ä¼—æ•°å¡«å……ã€ä½¿ç”¨æ’å€¼æ–¹æ³•ã€åŸºäºæ¨¡å‹é¢„æµ‹å¡«å……ã€‚é€‰æ‹©æ–¹æ³•è¦è€ƒè™‘æ•°æ®ç±»å‹ã€ç¼ºå¤±æ¯”ä¾‹å’Œä¸šåŠ¡å«ä¹‰ã€‚"
                },
                {
                    "user": "èƒ½ä»‹ç»ä¸€ä¸‹å¤§æ•°æ®å¤„ç†çš„å¸¸ç”¨å·¥å…·å—ï¼Ÿ",
                    "assistant": "å¸¸ç”¨å·¥å…·åŒ…æ‹¬Hadoopç”Ÿæ€ï¼ˆHDFSã€MapReduceã€Hiveï¼‰ã€Sparkï¼ˆæ‰¹å¤„ç†å’Œæµå¤„ç†ï¼‰ã€Kafkaï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ã€HBase/Cassandraï¼ˆNoSQLæ•°æ®åº“ï¼‰ã€‚é€‰æ‹©å·¥å…·è¦æ ¹æ®æ•°æ®é‡ã€å®æ—¶æ€§è¦æ±‚å’Œå›¢é˜ŸæŠ€æœ¯æ ˆã€‚"
                },
                {
                    "user": "å¦‚ä½•è¯„ä¼°æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½ï¼Ÿ",
                    "assistant": "æ¨¡å‹è¯„ä¼°æŒ‡æ ‡å› ä»»åŠ¡è€Œå¼‚ï¼šåˆ†ç±»é—®é¢˜ç”¨å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°ï¼›å›å½’é—®é¢˜ç”¨MSEã€RMSEã€MAEï¼›è¿˜è¦è€ƒè™‘è¿‡æ‹Ÿåˆã€äº¤å‰éªŒè¯ã€ROCæ›²çº¿ç­‰ã€‚é‡è¦çš„æ˜¯é€‰æ‹©ç¬¦åˆä¸šåŠ¡ç›®æ ‡çš„æŒ‡æ ‡ã€‚"
                },
                {
                    "user": "æˆ‘æƒ³äº†è§£ä¸€ä¸‹æ·±åº¦å­¦ä¹ ä¸­çš„å·ç§¯ç¥ç»ç½‘ç»œ",
                    "assistant": "CNNç‰¹åˆ«é€‚åˆå¤„ç†å›¾åƒæ•°æ®ã€‚æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬å·ç§¯å±‚ï¼ˆç‰¹å¾æå–ï¼‰ã€æ± åŒ–å±‚ï¼ˆé™ç»´ï¼‰ã€å…¨è¿æ¥å±‚ï¼ˆåˆ†ç±»ï¼‰ã€‚é€šè¿‡å‚æ•°å…±äº«å’Œå±€éƒ¨è¿æ¥ï¼ŒCNNèƒ½æœ‰æ•ˆå­¦ä¹ ç©ºé—´ç‰¹å¾ï¼Œå¹¿æ³›åº”ç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚"
                },
                {
                    "user": "æ•°æ®å¯è§†åŒ–æœ‰ä»€ä¹ˆæœ€ä½³å®è·µï¼Ÿ",
                    "assistant": "å¥½çš„æ•°æ®å¯è§†åŒ–åº”è¯¥ï¼šé€‰æ‹©åˆé€‚çš„å›¾è¡¨ç±»å‹ã€ä¿æŒç®€æ´æ¸…æ™°ã€ä½¿ç”¨åˆç†çš„é¢œè‰²æ­é…ã€æ·»åŠ å¿…è¦çš„æ ‡ç­¾å’Œè¯´æ˜ã€‚å·¥å…·æ¨èPythonçš„matplotlib/seabornã€Rçš„ggplot2ã€å•†ä¸šå·¥å…·å¦‚Tableauã€‚"
                },
                {
                    "user": "å¦‚ä½•æ„å»ºä¸€ä¸ªå®æ—¶æ•°æ®åˆ†æç³»ç»Ÿï¼Ÿ",
                    "assistant": "å®æ—¶ç³»ç»Ÿé€šå¸¸åŒ…æ‹¬æ•°æ®é‡‡é›†ï¼ˆKafkaï¼‰ã€æµå¤„ç†ï¼ˆSpark Streaming/Flinkï¼‰ã€å­˜å‚¨ï¼ˆRedis/HBaseï¼‰ã€å¯è§†åŒ–ï¼ˆGrafanaï¼‰ã€‚éœ€è¦è€ƒè™‘æ•°æ®ä¸€è‡´æ€§ã€å®¹é”™æ€§ã€å¯æ‰©å±•æ€§ç­‰é—®é¢˜ã€‚"
                },
                {
                    "user": "åœ¨åšç‰¹å¾å·¥ç¨‹æ—¶æœ‰ä»€ä¹ˆæŠ€å·§ï¼Ÿ",
                    "assistant": "ç‰¹å¾å·¥ç¨‹æŠ€å·§åŒ…æ‹¬ï¼šæ•°å€¼ç‰¹å¾æ ‡å‡†åŒ–/å½’ä¸€åŒ–ã€ç±»åˆ«ç‰¹å¾ç¼–ç ï¼ˆç‹¬çƒ­ã€æ ‡ç­¾ç¼–ç ï¼‰ã€æ—¶é—´ç‰¹å¾æå–ã€å¤šé¡¹å¼ç‰¹å¾ã€ç‰¹å¾é€‰æ‹©ï¼ˆç›¸å…³æ€§åˆ†æã€é‡è¦æ€§è¯„åˆ†ï¼‰ã€‚å¥½çš„ç‰¹å¾å¾€å¾€æ¯”å¤æ‚æ¨¡å‹æ›´é‡è¦ã€‚"
                },
                {
                    "user": "æ¨èç³»ç»Ÿæœ‰å“ªäº›å¸¸è§ç®—æ³•ï¼Ÿ",
                    "assistant": "ä¸»è¦æœ‰ååŒè¿‡æ»¤ï¼ˆåŸºäºç”¨æˆ·/ç‰©å“ï¼‰ã€å†…å®¹è¿‡æ»¤ã€æ··åˆæ¨èã€æ·±åº¦å­¦ä¹ æ–¹æ³•ï¼ˆæ·±åº¦ååŒè¿‡æ»¤ã€Wide&Deepï¼‰ã€‚è¿˜è¦è€ƒè™‘å†·å¯åŠ¨é—®é¢˜ã€å¤šæ ·æ€§ã€å®æ—¶æ€§ç­‰å·¥ç¨‹æŒ‘æˆ˜ã€‚"
                },
                {
                    "user": "å¦‚ä½•è¿›è¡ŒA/Bæµ‹è¯•çš„ç»Ÿè®¡åˆ†æï¼Ÿ",
                    "assistant": "A/Bæµ‹è¯•éœ€è¦ç¡®å®šæ ·æœ¬é‡ã€æ˜¾è‘—æ€§æ°´å¹³ã€æ£€éªŒåŠŸæ•ˆã€‚ä½¿ç”¨tæ£€éªŒæˆ–å¡æ–¹æ£€éªŒæ¯”è¾ƒç»„é—´å·®å¼‚ï¼Œè®¡ç®—ç½®ä¿¡åŒºé—´ã€‚è¦æ³¨æ„å¤šé‡æ£€éªŒé—®é¢˜ã€è¾›æ™®æ£®æ‚–è®ºç­‰ç»Ÿè®¡é™·é˜±ï¼Œç¡®ä¿å®éªŒè®¾è®¡çš„ç§‘å­¦æ€§ã€‚"
                }
            ]
        }
    
    async def initialize(self):
        """åˆå§‹åŒ–LindormMemobaseè¿æ¥"""
        print(f"æ­£åœ¨åˆå§‹åŒ–LindormMemobaseï¼Œé…ç½®æ–‡ä»¶ï¼š{self.config_path}")
        self.memobase = LindormMemobase.from_yaml_file(self.config_path)
        print("LindormMemobaseåˆå§‹åŒ–å®Œæˆ")
    
    def create_chat_blob(self, user_message: str, assistant_message: str) -> ChatBlob:
        """åˆ›å»ºèŠå¤©Blobå¯¹è±¡"""
        messages = [
            OpenAICompatibleMessage(
                role="user", 
                content=user_message,
                created_at=datetime.now().isoformat()
            ),
            OpenAICompatibleMessage(
                role="assistant", 
                content=assistant_message,
                created_at=datetime.now().isoformat()
            )
        ]
        
        return ChatBlob(
            messages=messages,
            type=BlobType.chat,
            created_at=datetime.now()
        )
    
    async def generate_user_data(self, user_id: str, user_info: dict) -> List[str]:
        """ä¸ºæŒ‡å®šç”¨æˆ·ç”Ÿæˆ10æ¡å¯¹è¯æ•°æ®å¹¶å†™å…¥buffer"""
        print(f"\næ­£åœ¨ä¸ºç”¨æˆ· {user_id}ï¼ˆ{user_info['name']}ï¼‰ç”Ÿæˆæ•°æ®...")
        
        conversations = self.conversation_templates[user_id]
        blob_ids = []
        
        for i, conv in enumerate(conversations, 1):
            # åˆ›å»ºèŠå¤©blob
            chat_blob = self.create_chat_blob(
                user_message=conv["user"],
                assistant_message=conv["assistant"]
            )
            
            # æ·»åŠ åˆ°buffer
            try:
                blob_id = await self.memobase.add_blob_to_buffer(
                    user_id=user_id,
                    blob=chat_blob
                )
                blob_ids.append(blob_id)
                print(f"  âœ“ å¯¹è¯ {i}/10 å·²æ·»åŠ åˆ°bufferï¼Œblob_id: {blob_id[:8]}...")
                
                # æ·»åŠ å°å»¶è¿Ÿï¼Œæ¨¡æ‹ŸçœŸå®å¯¹è¯é—´éš”
                await asyncio.sleep(0.1)
                
            except Exception as e:
                print(f"  âœ— å¯¹è¯ {i}/10 æ·»åŠ å¤±è´¥: {e}")
        
        print(f"ç”¨æˆ· {user_id} æ•°æ®ç”Ÿæˆå®Œæˆï¼Œå…±ç”Ÿæˆ {len(blob_ids)} æ¡è®°å½•")
        return blob_ids
    
    async def generate_all_data(self):
        """ç”Ÿæˆæ‰€æœ‰ç”¨æˆ·çš„æ•°æ®"""
        print("="*60)
        print("å¼€å§‹ç”Ÿæˆä¼ªé€ æ•°æ®...")
        print("="*60)
        
        all_results = {}
        
        for user_id, user_info in self.users.items():
            try:
                blob_ids = await self.generate_user_data(user_id, user_info)
                all_results[user_id] = {
                    "user_info": user_info,
                    "blob_ids": blob_ids,
                    "count": len(blob_ids)
                }
            except Exception as e:
                print(f"ç”¨æˆ· {user_id} æ•°æ®ç”Ÿæˆå¤±è´¥: {e}")
                all_results[user_id] = {
                    "user_info": user_info,
                    "blob_ids": [],
                    "count": 0,
                    "error": str(e)
                }
        
        return all_results
    
    def print_summary(self, results: dict):
        """æ‰“å°ç”Ÿæˆç»“æœæ‘˜è¦"""
        print("\n" + "="*60)
        print("æ•°æ®ç”Ÿæˆæ‘˜è¦")
        print("="*60)
        
        total_success = 0
        total_failed = 0
        
        for user_id, result in results.items():
            user_name = result["user_info"]["name"]
            count = result["count"]
            
            if "error" in result:
                print(f"âŒ {user_name} ({user_id}): ç”Ÿæˆå¤±è´¥ - {result['error']}")
                total_failed += 1
            else:
                print(f"âœ… {user_name} ({user_id}): æˆåŠŸç”Ÿæˆ {count} æ¡å¯¹è¯è®°å½•")
                total_success += count
        
        print(f"\næ€»è®¡ï¼š")
        print(f"  - æˆåŠŸç”¨æˆ·ï¼š{len([r for r in results.values() if 'error' not in r])} ä¸ª")
        print(f"  - å¤±è´¥ç”¨æˆ·ï¼š{len([r for r in results.values() if 'error' in r])} ä¸ª")  
        print(f"  - æ€»å¯¹è¯æ•°ï¼š{total_success} æ¡")
        
        if total_success > 0:
            print(f"\nğŸ‰ æ•°æ®ç”Ÿæˆå®Œæˆï¼å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç”¨æˆ·IDè¿›è¡Œæµ‹è¯•ï¼š")
            for user_id, result in results.items():
                if "error" not in result and result["count"] > 0:
                    print(f"  - {user_id}")


async def main():
    """ä¸»å‡½æ•°"""
    # æ£€æŸ¥é…ç½®æ–‡ä»¶
    config_path = "./config.yaml"
    if not os.path.exists(config_path):
        print(f"é”™è¯¯ï¼šé…ç½®æ–‡ä»¶ {config_path} ä¸å­˜åœ¨")
        print("è¯·ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œæ­¤è„šæœ¬ï¼Œä¸”config.yamlæ–‡ä»¶å­˜åœ¨")
        return
    
    # åˆ›å»ºæ•°æ®ç”Ÿæˆå™¨
    generator = FakeDataGenerator(config_path)
    
    try:
        # åˆå§‹åŒ–
        await generator.initialize()
        
        # ç”Ÿæˆæ•°æ®
        results = await generator.generate_all_data()
        
        # æ‰“å°æ‘˜è¦
        generator.print_summary(results)
        
    except Exception as e:
        print(f"æ•°æ®ç”Ÿæˆè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {e}")
        import traceback
        traceback.print_exc()


if __name__ == "__main__":
    asyncio.run(main())