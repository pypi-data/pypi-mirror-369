import { $APP, shadow$provide, $jscomp } from "./common.js";
var pI=function(){var a=$APP.Nm(1);$APP.qm(function(){var b=function(){function d(e){var f=e[1];if(f===7){var g=e[7];f=$APP.u(kI);f=!$APP.Nd(f,g);e[8]=f;e[1]=f?10:11;return $APP.Z}if(f===1)return f=$APP.u(lI),f=$APP.Bh(f),g=$APP.D(f),e[9]=g,e[2]=null,e[1]=2,$APP.Z;if(f===4){g=e[9];g=$APP.E(g);f=$APP.Rz.g(g);g=$APP.iz.g(g);var h=$APP.u(mI);h=$APP.Ef(h,new $APP.U(null,2,5,$APP.V,[g,$APP.Rz],null));e[10]=f;e[7]=g;e[11]=h;e[1]=$APP.m(g)?7:8;return $APP.Z}if(f===15)return e[2]=e[2],e[1]=6,$APP.Z;if(f===
13){g=e[7];f=$APP.X.v(nI,$APP.W,g,$APP.Dg);g=$APP.an(oI,g,$APP.Ol(nI,new $APP.U(null,1,5,$APP.V,[g],null)));h=$APP.X.v(kI,$APP.W,g.group,g.cache);var n=g.fc;e[13]=f;e[12]=g;e[14]=h;return $APP.Km(e,16,n)}return f===6?(e[2]=e[2],e[1]=3,$APP.Z):f===3?$APP.Lm(e,e[2]):f===12?(e[2]=e[2],e[1]=9,$APP.Z):f===2?(g=e[9],f=$APP.D(g),e[1]=f?4:5,$APP.Z):f===11?(f=e[8],e[2]=f,e[1]=12,$APP.Z):f===9?(e[1]=$APP.m(e[2])?13:14,$APP.Z):f===5?(e[2]=null,e[1]=6,$APP.Z):f===14?(g=e[9],g=$APP.Mc(g),e[9]=g,e[2]=null,e[1]=
2,$APP.Z):f===16?(g=e[9],h=e[12],f=e[2],g=$APP.Mc(g),h=$APP.u(h),h=$APP.Bh(h),h=$APP.D(h),g=$APP.xf.h(g,h),e[15]=f,e[9]=g,e[2]=null,e[1]=2,$APP.Z):f===10?(h=e[11],f=$APP.I.h(h,"ckt"),e[2]=f,e[1]=12,$APP.Z):f===8?(g=e[7],e[2]=g,e[1]=9,$APP.Z):null}return function(){function e(h){for(;;){a:{try{for(;;){var n=d(h);if(!$APP.Q(n,$APP.Z)){var p=n;break a}}}catch(q){p=q;h[2]=p;if($APP.D(h[4]))h[1]=$APP.E(h[4]);else throw p;p=$APP.Z;break a}p=void 0}if(!$APP.Q(p,$APP.Z))return p}}function f(){var h=[null,
null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];h[0]=g;h[1]=1;return h}var g=null;g=function(h){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,h)}throw Error("Invalid arity: "+arguments.length);};g.m=f;g.g=e;return g}()}(),c=function(){var d=b();d[6]=a;return d}();return $APP.Jm(c)})},qI=new $APP.P("nyancad.mosaic.anywidget","anywidget-sync","nyancad.mosaic.anywidget/anywidget-sync",-1693447253);var rI=new URLSearchParams(window.location.search),sI,tI=rI.get("schem");sI=$APP.m(tI)?tI:"myschem";var uI=rI.get("db"),oI=new $APP.fA($APP.m(uI)?uI:"schematics"),nI=$APP.Ml($APP.We([sI,$APP.R,"models",$APP.R])),lI=$APP.an(oI,sI,$APP.Ol(nI,new $APP.U(null,1,5,$APP.V,[sI],null))),mI=$APP.an(oI,"models",$APP.Ol(nI,new $APP.U(null,1,5,$APP.V,["models"],null))),vI=$APP.an(oI,[$APP.r.g(sI),"$result"].join(""),$APP.Ml($APP.xh())),kI=$APP.Zm(oI,$APP.M([lI,mI,vI]));export const render=function(a){var b=a.model;a.el.innerHTML="Connected to editor.";b.set("schematic_data",$APP.sl($APP.u(nI)));b.set("name",sI);b.save_changes();$APP.Ai(nI,qI,function(c,d,e,f){$APP.vi($APP.M(["Schematic updated, syncing to anywidget model"]));pI();b.set("schematic_data",$APP.sl(f));return b.save_changes()});b.on("change:simulation_data",function(){var c=$APP.Ki(b.get("simulation_data"),$APP.M([$APP.Ii,!0])),d=(new Date).toISOString();d=[$APP.r.g(sI),"$result:",$APP.r.g(d)].join("");
$APP.vi($APP.M(["Received simulation data from Python, storing with key:",d]));return $APP.X.v(vI,$APP.W,d,c)});return null};