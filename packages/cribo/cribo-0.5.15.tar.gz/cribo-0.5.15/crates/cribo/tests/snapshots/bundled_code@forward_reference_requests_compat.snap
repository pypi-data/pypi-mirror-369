---
source: crates/cribo/tests/test_bundling_snapshots.rs
input_file: crates/cribo/tests/fixtures/forward_reference_requests_compat/main.py
---
#!/usr/bin/env python3
# Generated by Cribo - Python Source Bundler
# https://github.com/ophidiarium/cribo

import collections.abc
import functools
import http
import http.cookiejar
import types
import urllib.parse
myrequests = types.SimpleNamespace(__name__='myrequests')
myrequests_cookies = types.SimpleNamespace(__name__='myrequests.cookies')
myrequests.cookies = myrequests_cookies
myrequests_exceptions = types.SimpleNamespace(__name__='myrequests.exceptions')
myrequests.exceptions = myrequests_exceptions
myrequests_utils = types.SimpleNamespace(__name__='myrequests.utils')
myrequests.utils = myrequests_utils
InvalidJSONError = None
class RequestException(Exception):
    """Base exception for all request errors."""
    pass
class InvalidJSONError(RequestException):
    """A JSON error occurred."""
    pass
@functools.cache
def __cribo_init___cribo_5ad29b_myrequests_compat():
    module = types.SimpleNamespace()
    module.__name__ = 'myrequests.compat'
    urlparse = urllib.parse.urlparse
    module.urlparse = urlparse
    urlunparse = urllib.parse.urlunparse
    module.urlunparse = urlunparse
    urljoin = urllib.parse.urljoin
    module.urljoin = urljoin
    cookielib = http.cookiejar
    module.cookielib = cookielib
    MutableMapping = collections.abc.MutableMapping
    module.MutableMapping = MutableMapping
    Mapping = collections.abc.Mapping
    module.Mapping = Mapping
    """Compat module that provides base classes and utilities used by other modules."""
    try:
        import simplejson as json
        module.json = json
    except ImportError:
        import json
        module.json = json
    if hasattr(json, "JSONDecodeError"):
        JSONDecodeError = json.JSONDecodeError
        module.JSONDecodeError = JSONDecodeError
    else:
        JSONDecodeError = ValueError
        module.JSONDecodeError = JSONDecodeError
    builtin_str = str
    module.builtin_str = builtin_str
    basestring = str, bytes
    module.basestring = basestring
    return module
myrequests.compat = __cribo_init___cribo_5ad29b_myrequests_compat()
class JSONDecodeError(InvalidJSONError, myrequests.compat.JSONDecodeError):
    """Couldn't decode the text into json."""
    pass
class CookieJar(myrequests.compat.cookielib.CookieJar, myrequests.compat.MutableMapping):
    """A cookie jar that also implements the MutableMapping interface."""

    def __init__(self):
        super().__init__()
        self._cookies = {}

    def __getitem__(self, name):
        return self._cookies[name]

    def __setitem__(self, name, value):
        self._cookies[name] = value

    def __delitem__(self, name):
        del self._cookies[name]

    def __iter__(self):
        return iter(self._cookies)

    def __len__(self):
        return len(self._cookies)

    def get(self, name, default=None):
        return self._cookies.get(name, default)

    def set(self, name, value):
        self._cookies[name] = value
def decode_json(content):
    """Decode JSON content."""
    try:
        return myrequests.compat.json.loads(content)
    except (ValueError, TypeError) as e:
        OurJSONDecodeError = JSONDecodeError
        raise OurJSONDecodeError(str(e))
def to_native_string(string):
    """Convert to native string type."""
    if isinstance(string, myrequests.compat.builtin_str):
        return string
    return str(string)
"""Main package that imports from multiple submodules."""
"""Utils module that also uses compat."""
RequestException.__module__ = 'myrequests.exceptions'
InvalidJSONError.__module__ = 'myrequests.exceptions'
JSONDecodeError.__module__ = 'myrequests.exceptions'
"""Exceptions module that uses compat types in class inheritance."""
CookieJar.__module__ = 'myrequests.cookies'
"""Cookies module that uses compat's MutableMapping in class inheritance."""
myrequests.compat = __cribo_init___cribo_5ad29b_myrequests_compat()
CompatJSONDecodeError = myrequests.compat.JSONDecodeError
cookielib = myrequests.compat.cookielib
MutableMapping = myrequests.compat.MutableMapping
cookies = myrequests_cookies
exceptions = myrequests_exceptions
utils = myrequests_utils
myrequests_cookies.CookieJar = CookieJar
myrequests_exceptions.InvalidJSONError = InvalidJSONError
myrequests_exceptions.JSONDecodeError = JSONDecodeError
myrequests_exceptions.RequestException = RequestException
myrequests_utils.decode_json = decode_json
myrequests_utils.to_native_string = to_native_string
"""Test that mimics requests' pattern causing forward reference."""
myrequests.CookieJar = CookieJar
myrequests.JSONDecodeError = JSONDecodeError
jar = myrequests.CookieJar()
jar.set("test", "value")
print(f"Cookie: {jar.get('test')}")
print(f"JSONDecodeError MRO: {[c.__name__ for c in myrequests.JSONDecodeError.__mro__]}")
print("Test completed")
