$(document).ready(()=>{const n=$("select#id_announcement_target"),s=$("select#id_announcement_channel"),t=$('input[name="csrfmiddlewaretoken"]'),o=$('textarea[name="announcement_text"]'),a=$("#aa-discord-announcements-form"),e=()=>{fetchGet({url:discordAnnouncementsSettings.url.getAnnouncementTargets,responseIsJson:!1}).then(e=>{""!==e&&$(n).html(e)}).catch(e=>{console.error("Error fetching announcement targets:",e)})},r=()=>{fetchGet({url:discordAnnouncementsSettings.url.getAnnouncementWebhooks,responseIsJson:!1}).then(e=>{""!==e&&$(s).html(e)}).catch(e=>{console.error("Error fetching announcement webhooks:",e)})},c=(e,n=10)=>{$(e).fadeTo(1e3*n,500).slideUp(500,()=>{$(e).remove()})},i=(e,n)=>{const s="alert alert-success alert-dismissible alert-message-success d-flex align-items-center fade show";$(n).html(`<div class="${s}">${e}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>`),c(".alert-message-success")},m=(e,n)=>{const s="alert alert-danger alert-dismissible alert-message-error d-flex align-items-center fade show";$(n).html(`<div class="${s}">${e}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>`),c(".alert-message-error",9999)},d=()=>{const n=new ClipboardJS("button#copyDiscordAnnouncement");n.on("success",e=>{i(discordAnnouncementsSettings.translation.copyToClipboard.success,".aa-discord-announcements-announcement-copyresult"),e.clearSelection(),n.destroy()}),n.on("error",()=>{m(discordAnnouncementsSettings.translation.copyToClipboard.error,".aa-discord-announcements-announcement-copyresult"),n.destroy()})};a.submit(e=>{e.preventDefault(),$(".aa-discord-announcements-form-message div").remove();const n=[o.val()];if(n.includes(""))return m(discordAnnouncementsSettings.translation.error.missingFields,".aa-discord-announcements-form-message"),!1;const s=a.serializeArray().reduce((e,n)=>(e[n.name]=n.value,e),{});fetchPost({url:discordAnnouncementsSettings.url.createAnnouncement,csrfToken:t.val(),payload:s,responseIsJson:!0}).then(e=>{!0===e.success?($(".aa-discord-announcements-no-announcement").hide("fast"),$(".aa-discord-announcements-announcement").show("fast"),$(".aa-discord-announcements-announcement-text").html(e.announcement_context),e.message&&i(e.message,".aa-discord-announcements-form-message")):m(e.message||"Something went wrong, no details given.",".aa-discord-announcements-form-message")}).catch(e=>{console.error(`Error: ${e.message}`),m(e.message||"Something went wrong, no details given.",".aa-discord-announcements-form-message")})}),$("button#copyDiscordAnnouncement").on("click",()=>{d()}),e(),r()});
//# sourceMappingURL=aa-discord-announcements.min.js.map