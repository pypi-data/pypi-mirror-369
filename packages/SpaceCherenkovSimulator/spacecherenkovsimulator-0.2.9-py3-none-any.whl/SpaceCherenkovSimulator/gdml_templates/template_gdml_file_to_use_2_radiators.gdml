<?xml version="1.0" encoding="UTF-8" ?>
<gdml xmlns:gdml="http://cern.ch/2001/Schemas/GDML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="/home/flei/hierras/system/config/GDMLSchema/gdml.xsd">
    <extension>
        <color name="magenta" R="255.0" G="1.0" B="255.0" A="1.0" />
        <color name="green" R="0.0" G="1.0" B="0.0" A="1.0" />
        <color name="red" R="1.0" G="0.0" B="0.0" A="1.0" />
        <color name="blue" R="0.0" G="0.0" B="1.0" A="1.0" />
        <color name="yellow" R="1.0" G="1.0" B="0.0" A="1.0" />
    </extension>

    <define>
        <matrix coldim="2" name="AIRRINDEX" values="1.55*eV 1 2.034*eV 1 2.068*eV 1 2.103*eV 1 2.139*eV 1 2.177*eV 1 2.216*eV 1 2.256*eV 1 2.298*eV 1 2.341*eV 1 2.386*eV 1 2.433*eV 1 2.481*eV 1 2.532*eV 1 2.585*eV 1 2.64*eV 1 2.697*eV 1 2.757*eV 1 2.82*eV 1 2.885*eV 1 2.954*eV 1 3.026*eV 1 3.102*eV 1 3.181*eV 1 3.265*eV 1 3.353*eV 1 3.446*eV 1 3.545*eV 1 3.649*eV 1 3.76*eV 1 3.877*eV 1 4.002*eV 1 4.136*eV 1 6.2*eV 1"/>
        <matrix coldim="2" name="REFLECTIVITY" values="1.55*eV .99 6.2*eV .99"/>
        <matrix coldim="2" name="EFFICIENCY" values="1.55*eV 1. 6.2*eV 1."/>
        <matrix coldim="2" name="REFLECTIVITY0" values="1.55*eV 0. 6.2*eV 0."/>
        <matrix coldim="2" name="EFFICIENCY0" values="1.55*eV 0. 6.2*eV 0."/>
        <matrix coldim="2" name="Fused_SilicaRINDEX" values="1.5498024804150619*eV 1.4533172548587419 1.5895410055539099*eV 1.453671248235113 1.6313710320158545*eV 1.4540432590723713 1.6754621409892563*eV 1.4544356187853857 1.7220027560167357*eV 1.4548509976493673 1.771202834760071*eV 1.455292466262284 1.823297035782426*eV 1.4557635705009624 1.878548461109166*eV 1.4562684234902543 1.9372531005188278*eV 1.4568118191797217 1.999745136019435*eV 1.4573993735778328 2.066403307220083*eV 1.4580377016844404 2.1376585936759476*eV 1.4587346409148338 2.2140035434500884*eV 1.4594995356592282 2.296003674688981*eV 1.4603436030766004 2.384311508330865*eV 1.461280408056225 2.4796839686640997*eV 1.4623264867003778 2.5830041340251033*eV 1.4635021746006414 2.695308661591412*eV 1.4648327216951849 2.8178226916637494*eV 1.4663498147332605 2.9520047246001186*eV 1.4680936900401065 3.0996049608301237*eV 1.4701161185594052 3.262742064031709*eV 1.4724847093887885 3.4440055120334714*eV 1.4752892581654646 3.646594071564852*eV 1.478651361495263 3.8745062010376556*eV 1.4827394286217723 4.132806614440166*eV 1.487792975557779 4.428007086900177*eV 1.4941636611187716 4.76862301666173*eV 1.502388311831451 5.166008268050207*eV 1.5133276060153986 5.635645383327499*eV 1.5284524486226228 6.199209921660247*eV 1.5505055379224866"/>
        <!-- <matrix coldim="2" name="Fused_SilicaRINDEX" values="1.999745136019435*eV 1.4573993735778328 2.066403307220083*eV 1.4580377016844404 2.1376585936759476*eV 1.4587346409148338 2.2140035434500884*eV 1.4594995356592282 2.296003674688981*eV 1.4603436030766004 2.384311508330865*eV 1.461280408056225 2.4796839686640997*eV 1.4623264867003778 2.5830041340251033*eV 1.4635021746006414 2.695308661591412*eV 1.4648327216951849 2.8178226916637494*eV 1.4663498147332605 2.9520047246001186*eV 1.4680936900401065 3.0996049608301237*eV 1.4701161185594052 3.262742064031709*eV 1.4724847093887885 3.4440055120334714*eV 1.4752892581654646 3.646594071564852*eV 1.478651361495263 3.8745062010376556*eV 1.4827394286217723 4.132806614440166*eV 1.487792975557779 4.428007086900177*eV 1.4941636611187716 4.76862301666173*eV 1.502388311831451 5.166008268050207*eV 1.5133276060153986 5.635645383327499*eV 1.5284524486226228 6.199209921660247*eV 1.5505055379224866"/> -->
        <!-- <matrix coldim="2" name="Fused_SilicaRINDEX" values="0.19*eV 1.1876687237873895 0.19794871794871796*eV 1.2254898112138966 0.2058974358974359*eV 1.2547526917372005 0.21384615384615385*eV 1.2780368967891802 0.22179487179487178*eV 1.2969772481111699 0.22974358974358974*eV 1.3126620894047085 0.2376923076923077*eV 1.325844802400519 0.24564102564102563*eV 1.3370637680847426 0.2535897435897436*eV 1.3467140610144785 0.26153846153846155*eV 1.3550921784013141 0.2694871794871795*eV 1.362424968683125 0.27743589743589747*eV 1.368888923429448 0.2853846153846154*eV 1.374623387595959 0.29333333333333333*eV 1.3797398165794224 0.3012820512820513*eV 1.3843283963540545 0.30923076923076925*eV 1.3884628641231256 0.3171794871794872*eV 1.3922040757979852 0.32512820512820517*eV 1.3956026847509317 0.33307692307692305*eV 1.3987011798876834 0.34102564102564104*eV 1.4015354549443382 0.34897435897435897*eV 1.4041360301177814 0.3569230769230769*eV 1.4065290126395078 0.3648717948717949*eV 1.408736859086475 0.3728205128205128*eV 1.4107789855330781 0.38076923076923075*eV 1.4126722597907397 0.38871794871794874*eV 1.414431401449139 0.39666666666666667*eV 1.4160693092205248 0.4046153846153846*eV 1.4175973305152656 0.4125641025641026*eV 1.4190254847757156 0.4205128205128205*eV 1.4203626495419035 0.42846153846153845*eV 1.4216167162881328 0.43641025641025644*eV 1.422794721591819 0.44435897435897437*eV 1.4239029580581166 0.4523076923076923*eV 1.4249470685412922 0.4602564102564103*eV 1.4259321265144065 0.4682051282051282*eV 1.4268627048967453 0.47615384615384615*eV 1.4277429352195123 0.48410256410256414*eV 1.4285765586688426 0.49205128205128207*eV 1.4293669702719023 0.5*eV 1.4301172572718674 0.51*eV 1.4310084882413217 0.5644444444444444*eV 1.435020800806527 0.6188888888888889*eV 1.4379966175323409 0.6733333333333333*eV 1.4402845082329192 0.7277777777777779*eV 1.4420982035669416 0.7822222222222223*eV 1.4435750829822287 0.8366666666666667*eV 1.4448069128386227 0.8911111111111112*eV 1.4458569880173298 0.9455555555555556*eV 1.4467701686383312 1.0*eV 1.4475790016788501 1.0544444444444445*eV 1.448307586775928 1.108888888888889*eV 1.4489740918149077 1.1633333333333333*eV 1.449592433297856 1.2177777777777778*eV 1.450173424973476 1.2722222222222221*eV 1.45072557923256 1.3266666666666667*eV 1.451255676574139 1.3811111111111112*eV 1.4517691769927923 1.4355555555555557*eV 1.4522705216398213 1.4900000000000002*eV 1.45276335705202 1.5444444444444445*eV 1.453250703908757 1.598888888888889*eV 1.4537350854988633 1.6533333333333333*eV 1.4542186265515311 1.7077777777777778*eV 1.4547031300124704 1.7622222222222224*eV 1.455190137229282 1.8166666666666667*eV 1.4556809755308942 1.8711111111111112*eV 1.4561767961392995 1.9255555555555557*eV 1.456678604602389 1.9800000000000002*eV 1.4571872853940453 2.0344444444444445*eV 1.4577036219306778 2.088888888888889*eV 1.458228312960119 2.1433333333333335*eV 1.4587619860601846 2.1977777777777776*eV 1.4593052088198266 2.2522222222222226*eV 1.4598584981512115 2.3066666666666666*eV 1.4604223280859019 2.361111111111111*eV 1.4609971363351084 2.4155555555555557*eV 1.4615833298372891 2.47*eV 1.4621812894721593 2.5244444444444447*eV 1.4627913740855218 2.578888888888889*eV 1.463413923941961 2.6333333333333337*eV 1.4640492637007572 2.687777777777778*eV 1.4646977049930712 2.742222222222223*eV 1.4653595486645705 2.796666666666667*eV 1.466035086736512 2.851111111111111*eV 1.466724604129249 2.905555555555556*eV 1.4674283801847914 2.96*eV 1.4681466900190527 3.014444444444445*eV 1.4688798057295187 3.068888888888889*eV 1.4696279974800222 3.123333333333333*eV 1.4703915344809975 3.177777777777778*eV 1.471170685880817 3.232222222222222*eV 1.4719657215815318 3.286666666666667*eV 1.472776912990434 3.341111111111111*eV 1.4736045337172572 3.395555555555556*eV 1.474448860225515 3.45*eV 1.475310172445345 3.5044444444444443*eV 1.4761887543543057 3.558888888888889*eV 1.4770848945317645 3.6133333333333333*eV 1.477998886691865 3.6677777777777782*eV 1.4789310301995038 3.7222222222222223*eV 1.4798816305732645 3.7766666666666673*eV 1.4808509999788702 3.8311111111111114*eV 1.4818394577163845 3.8855555555555554*eV 1.4828473307041117 3.9400000000000004*eV 1.4838749539619123 3.9944444444444445*eV 1.4849226710964754 4.048888888888889*eV 1.4859908347909176 4.1033333333333335*eV 1.4870798073009712 4.1577777777777785*eV 1.4881899609599176 4.2122222222222225*eV 1.4893216786943648 4.266666666666667*eV 1.4904753545529006 4.321111111111112*eV 1.491651394249647 4.375555555555556*eV 1.49285021572471 4.430000000000001*eV 1.4940722497235446 4.484444444444445*eV 1.4953179403972647 4.538888888888889*eV 1.4965877459259764 4.593333333333334*eV 1.497882139167261 4.647777777777778*eV 1.499201608332009 4.702222222222222*eV 1.500546657689884 4.756666666666667*eV 1.501917808306803 4.811111111111111*eV 1.5033155988169242 4.865555555555556*eV 1.5047405862317755 4.92*eV 1.5061933467892894 4.974444444444445*eV 1.5076744768456871 5.028888888888889*eV 1.5091845938133324 5.083333333333333*eV 1.5107243371478696 5.137777777777778*eV 1.5122943693882016 5.192222222222222*eV 1.5138953772530859 5.246666666666667*eV 1.515528072798414 5.301111111111111*eV 1.51719319463953 5.355555555555556*eV 1.518891509243265 5.41*eV 1.5206238122947233 5.464444444444444*eV 1.522390930144246 5.518888888888889*eV 1.524193721340408 5.573333333333333*eV 1.5260330782553657 5.627777777777778*eV 1.5279099288093967 5.682222222222222*eV 1.5298252383020294 5.736666666666666*eV 1.5317800113577849 5.791111111111111*eV 1.5337752939952327 5.845555555555555*eV 1.535812175828809 5.9*eV 1.5378917924136752"/> -->
        <matrix coldim="2" name="Fused_SilicaABSLENGTH" values="1.55*eV 3448 2.034*eV 3448  2.068*eV 4082 2.103*eV 6329 2.139*eV 9174 2.177*eV 12346 2.216*eV 13889 2.256*eV 15152 2.298*eV 17241 2.341*eV 18868 2.386*eV 20000 2.433*eV 26316 2.481*eV 35714 2.532*eV 45455 2.585*eV 47619 2.64*eV 52632 2.697*eV 52632 2.757*eV 55556 2.82*eV 52632 2.885*eV 52632 2.954*eV 47619 3.026*eV 45455 3.102*eV 41667 3.181*eV 37037 3.265*eV 33333 3.353*eV 30000 3.446*eV 28500 3.545*eV 27000 3.649*eV 24500 3.76*eV 22000 3.877*eV 19500 4.002*eV 17500 4.136*eV 14500 6.20*eV 14500"/>
        <!-- <matrix coldim="2" name="Fused_SilicaABSLENGTH" values="1.55*eV 10000000000 4.136*eV 10000000000 6.20*eV 10000000000"/> -->

    </define>

    <materials>
        <isotope N="14" Z="7" name="N14">
            <atom unit="g/mole" value="14.0031"/>
        </isotope>
        <isotope N="15" Z="7" name="N15">
            <atom unit="g/mole" value="15.0001"/>
        </isotope>
        <element name="Nitrogen">
            <fraction n="0.99632" ref="N14"/>
            <fraction n="0.00368" ref="N15"/>
        </element>
        <isotope N="16" Z="8" name="O16">
            <atom unit="g/mole" value="15.9949"/>
        </isotope>
        <isotope N="17" Z="8" name="O17">
            <atom unit="g/mole" value="16.9991"/>
        </isotope>
        <isotope N="18" Z="8" name="O18">
            <atom unit="g/mole" value="17.9992"/>
        </isotope>
        <element name="Oxygen">
            <fraction n="0.99757" ref="O16"/>
            <fraction n="0.00038" ref="O17"/>
            <fraction n="0.00205" ref="O18"/>
        </element>
        <material name="Air_l" state="gas">
            <property name="RINDEX" ref="AIRRINDEX"/>
            <T unit="K" value="293.15"/>
            <MEE unit="eV" value="85.7030667332998"/>
            <D unit="g/cm3" value="0.00129"/>
            <fraction n="0.7" ref="Nitrogen"/>
            <fraction n="0.3" ref="Oxygen"/>
        </material>
        <material name="vacuum" state="gas">
            <property name="RINDEX" ref="AIRRINDEX"/>
            <D unit="g/cm3" value="1.0e-25"/>
            <fraction n="0.7" ref="Nitrogen"/>
            <fraction n="0.3" ref="Oxygen"/>
        </material>
        <isotope N="28" Z="14" name="Si28">
            <atom unit="g/mole" value="27.9769265350"/>
        </isotope>
        <isotope N="29" Z="14" name="Si29">
            <atom unit="g/mole" value="28.9764946653"/>
        </isotope>
        <isotope N="30" Z="14" name="Si30">
            <atom unit="g/mole" value="29.973770137"/>
        </isotope>
        <element name="Silicon">
            <fraction n="0.92223" ref="Si28"/>
            <fraction n="0.04685" ref="Si29"/>
            <fraction n="0.03092" ref="Si30"/>
        </element>
        <material Z="73" formula=" " name="Tantalum" >
            <D value="16.69" />
            <atom value="180.94788" />
        </material>
        <material Z="13" formula=" " name="Aluminium" >
            <D value="2.70" />
            <atom value="26.982" />
        </material>
        <material name="Fused_Silica" state="solid">
            <property name="RINDEX" ref="Fused_SilicaRINDEX"/>
            <!--property name="MIEHG" ref="Fused_SilicaMIEHG"/-->
            <property name="ABSLENGTH" ref="Fused_SilicaABSLENGTH"/>
            <!--property name="SCINTILLATIONCOMPONENT1" ref="Fused_SilicaSCINTILLATIONCOMPONENT1"/>
            <property name="SCINTILLATIONCOMPONENT2" ref="Fused_SilicaSCINTILLATIONCOMPONENT2"/>
            <property name="MIEHG_FORWARD" ref="Fused_SilicaMIEHG_FORWARD"/>
            <property name="MIEHG_BACKWARD" ref="Fused_SilicaMIEHG_BACKWARD"/>
            <property name="MIEHG_FORWARD_RATIO" ref="Fused_SilicaMIEHG_FORWARD_RATIO"/>
            <property name="SCINTILLATIONYIELD" ref="Fused_SilicaSCINTILLATIONYIELD"/>
            <property name="RESOLUTIONSCALE" ref="Fused_SilicaRESOLUTIONSCALE"/>
            <property name="SCINTILLATIONTIMECONSTANT1" ref="Fused_SilicaSCINTILLATIONTIMECONSTANT1"/>
            <property name="SCINTILLATIONTIMECONSTANT2" ref="Fused_SilicaSCINTILLATIONTIMECONSTANT2"/>
            <property name="SCINTILLATIONYIELD1" ref="SCINTILLATIONYIELD1"/>
            <property name="SCINTILLATIONYIELD2" ref="SCINTILLATIONYIELD2"/-->
            <T unit="K" value="293.15"/>
            <MEE unit="eV" value="68.9984174679527"/>
            <D unit="g/cm3" value="2.2"/>
            <fraction n="0.4674" ref="Silicon"/>
            <fraction n="0.5326" ref="Oxygen"/>
        </material>
    </materials>

    <solids>
        <!-- <box lunit="cm" name="cube_solid" x="1" y="1" z="1"/> -->
        REPLACE_WITH_RADIATOR_GEOMETRY
        <sphere lunit="mm" aunit="degree" name="tantalum_shell" rmin="REPLACE_WITH_Ta_RMIN" rmax="REPLACE_WITH_Ta_RMAX" startphi="0" deltaphi="360" starttheta="0" deltatheta="180"/>
        <sphere lunit="mm" aunit="degree" name="spacecraft_shell" rmin="REPLACE_WITH_Al_RMIN" rmax="REPLACE_WITH_Al_RMAX" startphi="0" deltaphi="360" starttheta="0" deltatheta="180"/>
        <box lunit="cm" name="sipm_solid" z="0.1" y="1" x="1"/>
<!-- 	      <opticalsurface finish="34" model="3" name="Fused_SilicaSurface" type="3" value="0"/>
          <opticalsurface finish="34" model="3" name="Fused_SilicaSurface" type="3" value="0"/> -->

          <opticalsurface name="surf1" model="glisur" finish="polished" type="dielectric_dielectric" value="1.0"/>
          <opticalsurface name="surf2" model="glisur" finish="polished" type="dielectric_metal" value="1.0">
            <property name="REFLECTIVITY" ref="REFLECTIVITY" />
            <property name="EFFICIENCY" ref="EFFICIENCY" />
          </opticalsurface>
          <opticalsurface name="surf3" model="glisur" finish="polished" type="dielectric_dielectric" value="1.0">
            <property name="REFLECTIVITY" ref="REFLECTIVITY0" />
            <property name="EFFICIENCY" ref="EFFICIENCY" />
          </opticalsurface>
          
        <!-- <box lunit="cm" name="house_solid" x="2" y="2" z="2"/> -->
        <box lunit="cm" name="World_solid" x="3" y="3" z="3"/>
    </solids>

    <structure>
        <volume name="tantalum_shell_log">
            <materialref ref="Tantalum"/>
            <solidref ref="tantalum_shell"/>
        </volume>
        <volume name="spacecraft_shell_log">
            <materialref ref="Aluminium"/>
            <solidref ref="spacecraft_shell"/>
        </volume>
        <volume name="cube_log">
            <materialref ref="Fused_Silica"/>
            <solidref ref="radiator_solid"/>
            <colorref ref="magenta" />
            <auxiliary auxtype="StepLimit" auxvalue="0.25" auxunit="mm" />
            <auxiliary auxtype="SensDet" auxvalue="Radiator" />
        </volume>
        <volume name="sipm_log">
            <materialref ref="G4_Si"/>
            <solidref ref="sipm_solid"/>
            <colorref ref="red" />
            <auxiliary auxtype="Solid" auxvalue="True" />
            <auxiliary auxtype="SensDet" auxvalue="PhotonDetector" />
        </volume>
<!--         <volume name="house_log">
            <materialref ref="Air_l"/>
            <solidref ref="house_solid"/>
            <physvol name="cube_phys">
                <volumeref ref="cube_log"/>
                <position name="cube_pos" unit="cm" x="0" y="0" z="0"/>
            </physvol>
        </volume> -->
        <volume name="World">
            <!-- <materialref ref="Air_l"/> -->
            <materialref ref="vacuum"/>
            <!-- <solidref ref="World_solid"/>
            <physvol name="cube_phys1">
                <volumeref ref="cube_log"/>
                <position name="cube_pos" unit="cm" x="0" z="1.0" y="0"/>
            </physvol>
            <physvol name="sipm_phys1">
                <volumeref ref="sipm_log"/>
                <position name="sipm_pos" unit="cm" z="0.45" y="0" x="0"/>
            </physvol>
            <physvol name="cube_phys2">
                <volumeref ref="cube_log"/>
                <position name="cube_pos" unit="cm" x="0" z="-1.0" y="0"/>
            </physvol>
            <physvol name="sipm_phys2">
                <volumeref ref="sipm_log"/>
                <position name="sipm_pos" unit="cm" z="-0.45" y="0" x="0"/>
            </physvol> -->
            <solidref ref="World_solid"/>
            <physvol name="cube_phys1">
                <volumeref ref="cube_log"/>
                <position name="cube_pos" unit="cm" x="0" z="0.51" y="0"/>
            </physvol>
            <physvol name="sipm_phys1">
                <volumeref ref="sipm_log"/>
                <position name="sipm_pos" unit="cm" z="1.06" y="0" x="0"/>
            </physvol>
            <physvol name="cube_phys2">
                <volumeref ref="cube_log"/>
                <position name="cube_pos" unit="cm" x="0" z="-0.5" y="0"/>
            </physvol>
            <physvol name="sipm_phys2">
                <volumeref ref="sipm_log"/>
                <position name="sipm_pos" unit="cm" z="-1.05" y="0" x="0"/>
            </physvol>
            REPLACE_WITH_Al_PLACEMENT_STRING
            REPLACE_WITH_Ta_PLACEMENT_STRING
        </volume>
        <!-- <skinsurface name="RadiaWrap" surfaceproperty="surf2" >
            <volumeref ref="cube_log"/>
        </skinsurface>
        <skinsurface name="SiPMWrap" surfaceproperty="surf3" >
            <volumeref ref="sipm_log"/>
        </skinsurface>
        <bordersurface name="Rad_SiPM1" surfaceproperty="surf1">
            <physvolref ref="cube_phys1"/>
            <physvolref ref="sipm_phys1"/>
        </bordersurface>
        <bordersurface name="Rad_SiPM2" surfaceproperty="surf1">
            <physvolref ref="cube_phys2"/>
            <physvolref ref="sipm_phys2"/>
        </bordersurface> -->
        <skinsurface name="RadiaWrap" surfaceproperty="surf2" >
            <volumeref ref="cube_log"/>
        </skinsurface>
        <skinsurface name="SiPMWrap" surfaceproperty="surf3" >
            <volumeref ref="sipm_log"/>
        </skinsurface>
        <bordersurface name="Rad_SiPM1" surfaceproperty="surf1">
            <physvolref ref="cube_phys1"/>
            <physvolref ref="sipm_phys1"/>
        </bordersurface>
        <bordersurface name="Rad_SiPM2" surfaceproperty="surf1">
            <physvolref ref="cube_phys2"/>
            <physvolref ref="sipm_phys2"/>
        </bordersurface>
    </structure>

    <setup name="Default" version="1.0">
        <world ref="World"/>
    </setup>
</gdml>
