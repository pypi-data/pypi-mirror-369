import"../chunks/DsnmJJEf.js";import{o as Ye}from"../chunks/BIHB8bOP.js";import{p as Le,s as d,b as Z,u as ee,g as e,l,d as Me,j as r,t as Oe,e as m,h as S,f as x,a as o,i as qe,n as O,m as Ge,r as He,c as te}from"../chunks/C2qtcxMB.js";import{i as h}from"../chunks/CUUZcSt3.js";import{F as Je,e as Ke,b as de,S as Qe,c as q,t as le,h as We,r as Xe,f as Ze}from"../chunks/DZujSHY9.js";import{A as _e,T as et}from"../chunks/CpAjmBpr.js";import{R as Ne}from"../chunks/DZhPVe1c.js";import{B as tt}from"../chunks/l0zfogOA.js";import{D as ge}from"../chunks/B-RRlO2g.js";import{u as rt,g as oe}from"../chunks/Bdn9nyjV.js";var at=m("<!> <!>",1),nt=m("<!> <!> <!>",1),lt=m("<!> <!> <!> <!>",1),ot=m("<!> <!>",1),st=m("<!> <!>",1),it=m('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),ct=m('<div class="text-center">No technologies with this selection.</div>'),ut=m('<div class="text-center">No carriers with this selection.</div>'),dt=m('<div class="text-center">No solution selected.</div>'),_t=m('<div class="text-center">No locations with this selection.</div>'),gt=m('<div class="text-center">No data with this selection.</div>'),vt=m('<h1 class="mt-2 mb-4">The Transition Pathway &ndash; Capacity</h1> <!> <div class="plot mt-4"><!></div>',1);function St(Se,Te){Le(Te,!0);let w=d(null);const $e=["capacity","capacity_addition"],Ie={capacity:"Capacity",capacity_addition:"Capacity Addition"},Pe=["conversion","storage","transport"],ve=["energy","power"],Ce=[{label:"Node",value:"node"},{label:"Technology",value:"technology"}];let G=d(Z([])),s=d(null),v=d("capacity"),i=d("conversion"),C=d("energy"),c=d(null),H=d("technology"),F=d(!1),R=d(Z([])),V=d(Z([])),Y=d(Z([])),re=null,T=d(!1),A=d(!1),pe=d(Z({})),fe=l(()=>{const t=e(i)=="storage"?e(C):"power";return e(pe)[e(z)[0]+"_"+t]||""}),Fe=l(()=>e(Y).map(t=>t.toString())),Ae=l(()=>({responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${Ie[e(v)]}`+(e(F)?"":` [${e(fe)}]`)},min:e(F)?0:void 0,max:e(F)?1:void 0}},interaction:{intersect:!1,mode:"nearest",axis:"x"},plugins:{tooltip:{callbacks:{label:t=>`${t.dataset.label}: ${t.formattedValue}`+(e(F)?"":` ${e(fe)}`)}}}})),Ue=l(()=>e(s)==null?"":[e(s).solution_name.split(".").pop(),e(s).scenario_name,e(v),e(i),e(c)].join("_")),U=l(()=>{if(e(w)===null||e(s)===null)return[];let t=[];return e(w).data.forEach(n=>{let j=n.technology,$=e(s).detail.reference_carrier[j];!t.includes($)&&e(he).includes(n.technology)&&t.push($)}),t}),he=l(()=>{if(!e(s)||!e(i))return[];const t={conversion:"set_conversion_technologies",storage:"set_storage_technologies",transport:"set_transport_technologies"}[e(i)];return e(s).detail.system[t]||[]}),z=l(()=>e(s)===null||e(i)===null?[]:e(he).filter(t=>e(s)?.detail.reference_carrier[t]==e(c))),J=l(()=>e(w)===null?[]:Ke(e(w).data.filter(t=>e(z).includes(t.technology)).map(t=>t.location)));ee(()=>{e(U),Me(()=>{(e(c)==null||!e(U).includes(e(c)))&&(re!=null&&e(U).includes(re)?r(c,re,!0):r(c,e(U).length>0?e(U)[0]:null,!0))})}),ee(()=>{e(c)!=null&&(re=e(c))}),ee(()=>{r(V,e(z),!0)}),ee(()=>{r(R,e(J),!0)}),Ye(()=>{r(v,oe("variable")||e(v),!0),r(i,oe("technology_type")||e(i),!0),r(C,oe("storage_type")||e(C),!0),r(c,oe("carrier")||e(c),!0)}),ee(()=>{e(v),e(i),e(C),e(c),Oe().then(()=>{rt({variable:e(v),technology_type:e(i),storage_type:e(C),carrier:e(c)})})});function ae(){r(H,"node"),r(F,!1),r(R,e(J),!0),r(V,e(z),!0),r(Y,e(G),!0)}async function je(){ae(),await ye()}async function Be(){ae(),await ye()}function me(){ae()}function De(){ae()}async function ye(){if(e(v)===null||e(s)===null){r(w,null);return}r(A,!0),r(w,null);const t=await We(e(s).solution_name,[e(v)],e(s).scenario_name);r(w,t[e(v)],!0),t.unit?.data&&r(pe,Object.fromEntries(t.unit.data.map(n=>[n.technology+"_"+n.capacity_type,n[0]||n.units])),!0),r(A,!1)}let be=l(()=>{if(e(v)==null||e(R).length==0||e(Y).length==0||e(V).length==0||e(w)===null)return[];let t={},n={};e(H)=="technology"?(t.location=e(R),n.technology=e(V)):(t.technology=e(V),n.location=e(R)),e(i)=="storage"?n.capacity_type=[e(C)]:n.capacity_type=ve;let j=e(G).filter($=>!e(Y).includes($));return Xe(),Ze(e(w).data,t,n,j,e(F))});var xe=vt(),we=S(x(xe),2);Je(we,{children:(t,n)=>{var j=st(),$=x(j);de($,{title:"Solution Selection",children:(k,K)=>{{let L=l(()=>e(A)||e(T));Qe(k,{solution_selected:je,get disabled(){return e(L)},get selected_solution(){return e(s)},set selected_solution(I){r(s,I,!0)},get loading(){return e(T)},set loading(I){r(T,I,!0)},get years(){return e(G)},set years(I){r(G,I,!0)}})}}});var se=S($,2);{var B=k=>{var K=ot(),L=x(K);de(L,{title:"Variable Selection",children:(N,ne)=>{var Q=nt(),E=x(Q);q(E,{label:"Variable",content:(_,a=O)=>{{let u=l(()=>le($e)),y=l(()=>e(A)||e(T));ge(_,{get formId(){return a()},get options(){return e(u)},get disabled(){return e(y)},onUpdate:Be,get value(){return e(v)},set value(g){r(v,g,!0)}})}}});var p=S(E,2);{var P=f=>{var _=at(),a=x(_);q(a,{label:"Technology Type",content:(b,X=O)=>{{let ie=l(()=>le(Pe)),ce=l(()=>e(A)||e(T));ge(b,{get formId(){return X()},get options(){return e(ie)},get disabled(){return e(ce)},onUpdate:me,get value(){return e(i)},set value(ue){r(i,ue,!0)}})}}});var u=S(a,2);{var y=g=>{q(g,{label:"",content:(X,ie=O)=>{{let ce=l(()=>le(ve)),ue=l(()=>e(A)||e(T));Ne(X,{get formId(){return ie()},get options(){return e(ce)},onUpdate:me,get disabled(){return e(ue)},get value(){return e(C)},set value(Ee){r(C,Ee,!0)}})}}})};h(u,g=>{e(i)=="storage"&&g(y)})}o(f,_)};h(p,f=>{e(v)!=null&&f(P)})}var M=S(p,2);{var W=f=>{q(f,{label:"Carrier",content:(a,u=O)=>{{let y=l(()=>le(e(U))),g=l(()=>e(A)||e(T));ge(a,{get formId(){return u()},get options(){return e(y)},get disabled(){return e(g)},onUpdate:De,get value(){return e(c)},set value(b){r(c,b,!0)}})}}})};h(M,f=>{e(i)!=null&&e(U).length>0&&f(W)})}o(N,Q)}});var I=S(L,2);{var D=N=>{de(N,{title:"Data Selection",children:(ne,Q)=>{var E=lt(),p=x(E);q(p,{label:"Aggregation",content:(u,y=O)=>{Ne(u,{get formId(){return y()},get options(){return Ce},get value(){return e(H)},set value(g){r(H,g,!0)}})}});var P=S(p,2);q(P,{label:"Normalization",content:(u,y=O)=>{et(u,{get formId(){return y()},get value(){return e(F)},set value(g){r(F,g,!0)}})}});var M=S(P,2);{var W=a=>{_e(a,{label:"Technologies",get elements(){return e(z)},get value(){return e(V)},set value(u){r(V,u,!0)}})},f=a=>{_e(a,{label:"Nodes",get elements(){return e(J)},get value(){return e(R)},set value(u){r(R,u,!0)}})};h(M,a=>{e(H)=="technology"?a(W):a(f,!1)})}var _=S(M,2);_e(_,{label:"Years",get elements(){return e(G)},get value(){return e(Y)},set value(a){r(Y,a,!0)}}),o(ne,E)}})};h(I,N=>{e(w)&&e(i)&&e(c)&&e(z).length>0&&e(J).length>0&&N(D)})}o(k,K)};h(se,k=>{!e(T)&&e(s)&&k(B)})}o(t,j)}});var ke=S(we,2),Re=Ge(ke);{var Ve=t=>{var n=it();o(t,n)},ze=t=>{var n=te(),j=x(n);{var $=B=>{var k=ct();o(B,k)},se=B=>{var k=te(),K=x(k);{var L=D=>{var N=ut();o(D,N)},I=D=>{var N=te(),ne=x(N);{var Q=p=>{var P=dt();o(p,P)},E=p=>{var P=te(),M=x(P);{var W=_=>{var a=_t();o(_,a)},f=_=>{var a=te(),u=x(a);{var y=b=>{var X=gt();o(b,X)},g=b=>{tt(b,{type:"bar",get datasets(){return e(be)},get labels(){return e(Fe)},get options(){return e(Ae)},get plot_name(){return e(Ue)}})};h(u,b=>{e(be).length==0?b(y):b(g,!1)},!0)}o(_,a)};h(M,_=>{e(J).length==0?_(W):_(f,!1)},!0)}o(p,P)};h(ne,p=>{e(s)==null?p(Q):p(E,!1)},!0)}o(D,N)};h(K,D=>{e(U).length==0?D(L):D(I,!1)},!0)}o(B,k)};h(j,B=>{e(z).length==0?B($):B(se,!1)},!0)}o(t,n)};h(Re,t=>{e(T)||e(A)?t(Ve):t(ze,!1)})}He(ke),o(Se,xe),qe()}export{St as component};
