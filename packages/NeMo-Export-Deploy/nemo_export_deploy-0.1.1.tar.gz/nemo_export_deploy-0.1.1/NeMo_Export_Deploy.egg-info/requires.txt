megatron-core<0.14.0,>=0.13.0a0
accelerate
fastapi
pydantic-settings
ray
ray[serve]
uvicorn
tensorstore
zarr<3.0.0,>=2.18.2
cloudpickle
fiddle
hydra-core<=1.3.2,>1.3
lightning
omegaconf>=2.3.0
peft
torch
torchvision
torchmetrics>=0.11.0
wandb
webdataset>=0.2.86
flashinfer-python==0.2.5
pyparsing>2.0.2
sentencepiece
tiktoken
einops
ijson
pyarrow<21.0.0

[:platform_system != "Darwin"]
nvidia-pytriton

[:platform_system != "Darwin" and platform_machine != "aarch64"]
Pillow
decord

[:sys_platform != "darwin"]
nvidia-modelopt[torch]<0.32.0,>=0.29.0a0
nvidia-resiliency-ext<0.4.0,>=0.3.0a0

[inframework]

[te]
transformer-engine[pytorch]==2.5.0

[trtllm]
transformers~=4.51.0
tensorrt-llm~=0.20.0
cuda-python~=12.8.0

[trtllm:sys_platform != "darwin"]
nvidia-modelopt[torch]<0.30.0,>=0.29.0a0

[vllm]
vllm==0.9.1
pandas
timm
transformers~=4.53.0

[vllm:sys_platform != "darwin"]
nvidia-modelopt[torch]<0.32.0,>=0.31.0a0
