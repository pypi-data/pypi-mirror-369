{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "IsaacPatchV1",
  "type": "object",
  "required": ["plan", "diffs", "tests", "risks", "commands"],
  "properties": {
    "plan": {"type": "string", "minLength": 1},
    "diffs": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["file", "unified_diff"],
        "properties": {
          "file": {"type": "string"},
          "unified_diff": {"type": "string"}
        }
      }
    },
    "tests": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["command"],
        "properties": {
          "command": {"type": "string"},
          "cwd": {"type": "string", "default": "."}
        }
      }
    },
    "risks": {"type": "array", "items": {"type": "string"}},
    "commands": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["cmd"],
        "properties": {
          "cmd": {"type": "string"},
          "args": {"type": "array", "items": {"type": "string"}, "default": []},
          "paths": {"type": "array", "items": {"type": "string"}, "default": []}
        }
      }
    },
    "citations": {"type": ["array", "null"], "items": {"type": "string"}}
  }
}

